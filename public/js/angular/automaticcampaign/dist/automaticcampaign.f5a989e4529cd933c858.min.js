/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

eval("__webpack_require__(1);\r\n__webpack_require__(2);\r\n__webpack_require__(3);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9hbmd1bGFyL2F1dG9tYXRpY2NhbXBhaWduL21haW4uanM/MGY1YSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxtQkFBTyxDQUFDLENBQVU7QUFDbEIsbUJBQU8sQ0FBQyxDQUFrQjtBQUMxQixtQkFBTyxDQUFDLENBQWUiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4vYXBwLmpzJyk7XHJcbnJlcXVpcmUoJy4vY29udHJvbGxlcnMuanMnKTtcclxucmVxdWlyZSgnLi9zZXJ2aWNlcy5qcycpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vanMvYW5ndWxhci9hdXRvbWF0aWNjYW1wYWlnbi9tYWluLmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/***/ (function(module, exports) {

eval("(function () {\r\n  angular.module('automaticcampaign', ['ui.router', 'automaticcampaign.controllers', 'automaticcampaign.services', 'ngMaterial', 'flowChart', 'ui.bootstrap', 'mgcrea.ngStrap', 'ui.select', 'ngSanitize', 'angularMoment', 'moment-picker'])\r\n    .config(['$stateProvider', '$urlRouterProvider', function ($stateProvider, $urlRouterProvider) {\r\n        $stateProvider\r\n          .state('index', {\r\n            url: \"/\",\r\n            templateUrl: fullUrlBase + templateBase + '/list',\r\n            controller: 'listController'\r\n          })\r\n          .state('create', {\r\n            url: \"/create\",\r\n            templateUrl: fullUrlBase + templateBase + '/create',\r\n            controller: 'createController'\r\n          })\r\n          .state('edit', {\r\n            url: \"/edit/:idautomaticcampaign\",\r\n            templateUrl: fullUrlBase + templateBase + '/edit',\r\n            controller: 'editController'\r\n          })\r\n          .state('viewscheme', {\r\n            url: \"/viewscheme/:idautomaticcampaign\",\r\n            templateUrl: fullUrlBase + templateBase + \"/viewscheme\",\r\n            controller: \"viewschemeController\"\r\n          });\r\n\r\n        $urlRouterProvider.otherwise(function ($injector, $location) {\r\n          var $state = $injector.get('$state');\r\n          $state.go('index');\r\n        });\r\n      }]);\r\n})();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9hbmd1bGFyL2F1dG9tYXRpY2NhbXBhaWduL2FwcC5qcz9mZDA4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsQ0FBQyIsImZpbGUiOiIxLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcclxuICBhbmd1bGFyLm1vZHVsZSgnYXV0b21hdGljY2FtcGFpZ24nLCBbJ3VpLnJvdXRlcicsICdhdXRvbWF0aWNjYW1wYWlnbi5jb250cm9sbGVycycsICdhdXRvbWF0aWNjYW1wYWlnbi5zZXJ2aWNlcycsICduZ01hdGVyaWFsJywgJ2Zsb3dDaGFydCcsICd1aS5ib290c3RyYXAnLCAnbWdjcmVhLm5nU3RyYXAnLCAndWkuc2VsZWN0JywgJ25nU2FuaXRpemUnLCAnYW5ndWxhck1vbWVudCcsICdtb21lbnQtcGlja2VyJ10pXHJcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgICAgLnN0YXRlKCdpbmRleCcsIHtcclxuICAgICAgICAgICAgdXJsOiBcIi9cIixcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGZ1bGxVcmxCYXNlICsgdGVtcGxhdGVCYXNlICsgJy9saXN0JyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2xpc3RDb250cm9sbGVyJ1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5zdGF0ZSgnY3JlYXRlJywge1xyXG4gICAgICAgICAgICB1cmw6IFwiL2NyZWF0ZVwiLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogZnVsbFVybEJhc2UgKyB0ZW1wbGF0ZUJhc2UgKyAnL2NyZWF0ZScsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVDb250cm9sbGVyJ1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5zdGF0ZSgnZWRpdCcsIHtcclxuICAgICAgICAgICAgdXJsOiBcIi9lZGl0LzppZGF1dG9tYXRpY2NhbXBhaWduXCIsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBmdWxsVXJsQmFzZSArIHRlbXBsYXRlQmFzZSArICcvZWRpdCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdlZGl0Q29udHJvbGxlcidcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuc3RhdGUoJ3ZpZXdzY2hlbWUnLCB7XHJcbiAgICAgICAgICAgIHVybDogXCIvdmlld3NjaGVtZS86aWRhdXRvbWF0aWNjYW1wYWlnblwiLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogZnVsbFVybEJhc2UgKyB0ZW1wbGF0ZUJhc2UgKyBcIi92aWV3c2NoZW1lXCIsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwidmlld3NjaGVtZUNvbnRyb2xsZXJcIlxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoZnVuY3Rpb24gKCRpbmplY3RvciwgJGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICB2YXIgJHN0YXRlID0gJGluamVjdG9yLmdldCgnJHN0YXRlJyk7XHJcbiAgICAgICAgICAkc3RhdGUuZ28oJ2luZGV4Jyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1dKTtcclxufSkoKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9qcy9hbmd1bGFyL2F1dG9tYXRpY2NhbXBhaWduL2FwcC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///1\n");

/***/ }),
/* 2 */
/***/ (function(module, exports) {

eval("(function () {\r\n  angular.module('automaticcampaign.controllers', [])\r\n          .filter('getGmtById', function () {\r\n            return function (input, id) {\r\n              var i = 0,\r\n                      len = input.length;\r\n              for (; i < len; i++) {\r\n                if (input[i].gmt == id) {\r\n                  return input[i];\r\n                }\r\n              }\r\n              return null;\r\n            }\r\n          })\r\n          .controller('createController', ['$scope', '$rootScope', '$q', 'notificationService', 'restServices', 'moment', '$filter', '$window', '$location', '$state', function ($scope, $rootScope, $q, notificationService, restServices, moment, $filter, $window, $location, $state) {\r\n              $('#datetimepickerStart').datetimepicker({\r\n                format: 'yyyy-MM-dd hh:mm',\r\n                language: 'es',\r\n                startDate: new Date()\r\n              })\r\n                      .on('changeDate', function (ev) {\r\n                        $scope.applyTextGmt();\r\n                        $scope.$apply();\r\n                      });\r\n              $('#datetimepickerEnd').datetimepicker({\r\n                format: 'yyyy-MM-dd hh:mm',\r\n                language: 'es',\r\n                startDate: new Date()\r\n              })\r\n                      .on('changeDate', function (ev) {\r\n                        $scope.applyTextGmt();\r\n                        $scope.$apply();\r\n                      });\r\n              $scope.showTextGmtStart = false;\r\n              $scope.showTextGmtEnd = false;\r\n              var idMax = 10;\r\n              $scope.formCampaign = {};\r\n              $scope.getServices = function () {\r\n                restServices.getservices().then(function (data) {\r\n                  $scope.services = data;\r\n                  $scope.items = [{\r\n                      class: 'item-success-inverted-no-hover small-text text-center',\r\n                      name: 'Servicio',\r\n                      icon: false,\r\n                      iconClass: \"fa fa-envelope-o\"\r\n                    }];\r\n                  for (var i = 0; i < data.length; i++) {\r\n                    if (data[i].service == \"sms\") {\r\n                      $scope.items.push({\r\n                        class: 'small-text text-center cursor-pointer',\r\n                        name: 'Sms',\r\n                        theme: 'service',\r\n                        method: 'sms',\r\n                        templatepopover: fullUrlBase + \"flowchart/popoversms\",\r\n                        titlepopover: 'Configurar sms',\r\n                        disabled: false,\r\n                        icon: true,\r\n                        iconClass: \"fa fa-mobile fa-2x\",\r\n                        image: fullUrlBase + \"images/automatic/SMSA-01.jpg\"\r\n                      });\r\n                    }\r\n                    if (data[i].service == \"email marketing\") {\r\n                      $scope.items.push({\r\n                        class: 'small-text text-center cursor-pointer',\r\n                        name: 'Mail',\r\n                        theme: 'service',\r\n                        method: 'email',\r\n                        templatepopover: fullUrlBase + \"flowchart/popovermail\",\r\n                        titlepopover: 'Configurar correo',\r\n                        disabled: false,\r\n                        icon: true,\r\n                        iconClass: \"fa fa-envelope-o fa-2x\",\r\n                        image: fullUrlBase + \"images/automatic/correoa-01.jpg\"\r\n                      });\r\n                    }\r\n                    /*if (data[i].service == \"survey\") {\r\n                     $scope.items.push({\r\n                     class: 'small-text text-center cursor-pointer',\r\n                     name: 'Encuestas',\r\n                     theme: 'service',\r\n                     method: 'survey',\r\n                     templatepopover: fullUrlBase + \"flowchart/popoversurvey\",\r\n                     titlepopover: 'Configurar survey',\r\n                     disabled: false,\r\n                     icon: true,\r\n                     iconClass: \"fa fa-address-book-o fa-2x\",\r\n                     image: fullUrlBase + \"images/general/forms.png\"\r\n                     });\r\n                     }*/\r\n                  }\r\n                  $scope.items.push({\r\n                    class: 'item-primary-inverted-no-hover small-text text-center',\r\n                    name: 'Operadores',\r\n                    icon: false,\r\n                    iconClass: \"fa fa-envelope-o\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Tiempo',\r\n                    theme: 'operator',\r\n                    method: 'time',\r\n                    templatepopover: fullUrlBase + \"flowchart/popovertime\",\r\n                    titlepopover: 'Operador por tiempo',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-clock-o fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/tiempoa-01.jpg\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Accion',\r\n                    theme: 'operator',\r\n                    method: 'actions',\r\n                    templatepopover: fullUrlBase + \"flowchart/popoveraction\",\r\n                    titlepopover: 'Operador por accion',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-cogs fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/accion-01.jpg\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Clicks',\r\n                    theme: 'operator',\r\n                    method: 'clicks',\r\n                    templatepopover: fullUrlBase + \"flowchart/popoverclick\",\r\n                    titlepopover: 'Operador por click',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-link fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/click-01.jpg\"\r\n                  });\r\n                  restServices.validateService($scope.chartViewModel.data, data);\r\n                }).catch(function (data) {\r\n                  $scope.services = data;\r\n                  $scope.items = [{\r\n                      class: 'item-success-inverted-no-hover small-text text-center  text-center',\r\n                      name: 'Servicio',\r\n                      icon: false,\r\n                      iconClass: \"fa fa-envelope-o\"\r\n                    }];\r\n                  $scope.items.push({\r\n                    class: 'item-primary-inverted-no-hover small-text text-center  text-center',\r\n                    name: 'Operadores',\r\n                    icon: false,\r\n                    iconClass: \"fa fa-envelope-o\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Tiempo',\r\n                    theme: 'operator',\r\n                    method: 'time',\r\n                    templatepopover: fullUrlBase + \"flowchart/popovertime\",\r\n                    titlepopover: 'Operador por tiempo',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-clock-o fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/tiempoa-01.jpg\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Accion',\r\n                    theme: 'operator',\r\n                    method: 'actions',\r\n                    templatepopover: fullUrlBase + \"flowchart/popoveraction\",\r\n                    titlepopover: 'Operador por accion',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-cogs fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/accion-01.jpg\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Clicks',\r\n                    theme: 'operator',\r\n                    method: 'clicks',\r\n                    templatepopover: fullUrlBase + \"flowchart/popoverclick\",\r\n                    titlepopover: 'Operador por click',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-link fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/click-01.jpg\"\r\n                  });\r\n                });\r\n              }\r\n\r\n\r\n              var chartDataModel = {\r\n                nodes: [{\r\n                    name: \"Destinatario(s)\",\r\n                    id: 0,\r\n                    x: 170,\r\n                    y: 25,\r\n                    width: 100,\r\n                    image: fullUrlBase + \"images/automatic/destinatariosa-01.jpg\",\r\n                    theme: \"primary\",\r\n                    method: \"primary\",\r\n                    templatepopover: fullUrlBase + \"flowchart/popoversegment\",\r\n                    titlepopover: \"Selecciona a quien quiere enviar esta campaña automática.\",\r\n                    outputConnectors: [{\r\n                        name: \"\"\r\n                      }],\r\n                    sendData: {}\r\n                  }],\r\n                connections: []\r\n              };\r\n\r\n              $scope.getIdMax = function () {\r\n                var idMax = 0;\r\n                for (var i = 0; i < $scope.chartViewModel.nodes.length; i++) {\r\n                  var idNode = $scope.chartViewModel.nodes[i].getId();\r\n                  if (idNode > idMax) {\r\n                    idMax = idNode;\r\n                  }\r\n                }\r\n                return idMax;\r\n              }\r\n\r\n              $scope.addNewNode = function (item) {\r\n                if (typeof item.method == \"undefined\") {\r\n                  return;\r\n                }\r\n\r\n                //          if (item.disabled) {\r\n                //            return;\r\n                //          }\r\n                //          var themePre = $scope.chartViewModel.nodes[$scope.chartViewModel.nodes.length - 1].getTheme();\r\n                //          if (item.theme == \"service\") {\r\n                //            for (var i = 0; i < $rootScope.items.length; i++) {\r\n                //              if ($rootScope.items[i].theme == \"service\") {\r\n                //                $rootScope.items[i].disabled = true;\r\n                //                $rootScope.items[i].class += \" disabled text-center cursor-pointer\";\r\n                //              } else if ($rootScope.items[i].theme == \"operator\") {\r\n                //                $rootScope.items[i].disabled = false;\r\n                //                $rootScope.items[i].class = \"small-text text-center cursor-pointer\";\r\n                //              }\r\n                //            }\r\n                //          } else {\r\n                //            for (var i = 0; i < $rootScope.items.length; i++) {\r\n                //              if ($rootScope.items[i].theme == \"operator\") {\r\n                //                $rootScope.items[i].disabled = true;\r\n                //                $rootScope.items[i].class += \" disabled text-center cursor-pointer\";\r\n                //              } else if ($rootScope.items[i].theme == \"service\") {\r\n                //                $rootScope.items[i].disabled = false;\r\n                //                $rootScope.items[i].class = \"small-text text-center cursor-pointer\";\r\n                //              }\r\n                //            }\r\n                //          }\r\n                var newNodeDataModel = {\r\n                  name: item.name,\r\n                  id: $scope.getIdMax() + 1,\r\n                  x: 10,\r\n                  y: 50,\r\n                  width: 100,\r\n                  theme: item.theme,\r\n                  method: item.method,\r\n                  image: item.image,\r\n                  templatepopover: item.templatepopover,\r\n                  titlepopover: item.titletemplate,\r\n                  inputConnectors: [{\r\n                      name: \"\"\r\n                    }],\r\n                  outputConnectors: [{\r\n                      name: \"\"\r\n                    }],\r\n                  sendData: {}\r\n                };\r\n                if (item.method == \"actions\" || item.method == \"clicks\" || item.method == \"links\") {\r\n                  newNodeDataModel.outputConnectors.push({\r\n                    name: \"\"\r\n                  });\r\n                }\r\n                $scope.chartViewModel.addNode(newNodeDataModel);\r\n              };\r\n              $scope.createAutomaticCampaign = function (option) {\r\n                restServices.validateJsonAutomaticCampaign($scope.chartViewModel.data, $scope.services).then(function (objData) {\r\n                  $scope.optionCreate = option;\r\n                  if (option == 1) {\r\n                    if (typeof $scope.idCampaign != \"undefined\") {\r\n                      restServices.updateAutomaticCampaignConfiguration($scope.chartViewModel.data, $scope.idCampaign).then(function (data) {\r\n                        notificationService.primary(data.message);\r\n                      });\r\n                    } else {\r\n                      restServices.createAutomaticCampaignDraft($scope.chartViewModel.data).then(function (data) {\r\n                        notificationService.success(data.message);\r\n                        $scope.idCampaign = data.idCampaign;\r\n                      });\r\n                    }\r\n                  } else {\r\n                    $('#createAutomaticCampaign').addClass('dialog--open');\r\n                  }\r\n\r\n                });\r\n              }\r\n\r\n              $scope.toReturn = function () {\r\n                $state.go('index');\r\n              }\r\n\r\n              $scope.insCampaign = function () {\r\n                $scope.formCampaign.startDate = angular.copy($scope.dateGmtStart);\r\n                $scope.formCampaign.endDate = angular.copy($scope.dateGmtEnd);\r\n                restServices.validateFormCampaign($scope.formCampaign).then(function (data) {\r\n                  var objSend = {\r\n                    formCampaign: data,\r\n                    objCampaign: $scope.chartViewModel.data\r\n                  };\r\n                  if (typeof $scope.idCampaign == \"undefined\") {\r\n                    restServices.createAutomaticCampaign(objSend).then(function (data) {\r\n                      notificationService.success(data.message);\r\n                      $('#createAutomaticCampaign').removeClass('dialog--open');\r\n                      $state.go('index');\r\n                    });\r\n                  } else {\r\n                    restServices.updateAutomaticCampaignAll(objSend, $scope.idCampaign).then(function (data) {\r\n                      notificationService.primary(data.message);\r\n                      $('#createAutomaticCampaign').removeClass('dialog--open');\r\n                      $state.go('index');\r\n                    });\r\n                  }\r\n                  //\r\n                });\r\n              }\r\n\r\n              $scope.getallcategory = function () {\r\n                restServices.getallcategory().then(function (data) {\r\n                  $scope.listCategory = data;\r\n                });\r\n                restServices.getGmt().then(function (data) {\r\n                  $scope.listZonaHoraria = data;\r\n                  var filter = $filter('getGmtById')($scope.listZonaHoraria, \"-0500\");\r\n                  $scope.formCampaign.gmt = filter.gmt;\r\n                });\r\n              }\r\n              $scope.getallcategory();\r\n              $scope.applyTextGmt = function () {\r\n                if ($(\"#datestartCampaign\").val() != '') {\r\n                  $scope.showTextGmtStart = true;\r\n                } else {\r\n                  $scope.showTextGmtStart = false;\r\n                  $scope.textGmtStart = '';\r\n                }\r\n                if ($(\"#dateendCampaign\").val() != '') {\r\n                  $scope.showTextGmtEnd = true;\r\n                } else {\r\n                  $scope.showTextGmtEnd = false;\r\n                  $scope.textGmtEnd = '';\r\n                }\r\n                if ($scope.showTextGmtStart) {\r\n                  var StartUnix = moment($(\"#datestartCampaign\").val()).utc().valueOf();\r\n                  $scope.dateGmtStart = moment(StartUnix).utcOffset($scope.formCampaign.gmt).format('YYYY-MM-DD HH:mm');\r\n                  //            console.log(StartUnix,$scope.formCampaign.gmt);\r\n                }\r\n                if ($scope.showTextGmtEnd) {\r\n                  var EndUnix = moment($(\"#dateendCampaign\").val()).utc().valueOf();\r\n                  $scope.dateGmtEnd = moment(EndUnix).utcOffset($scope.formCampaign.gmt).format('YYYY-MM-DD HH:mm');\r\n                  //            console.log(EndUnix,$scope.formCampaign.gmt);\r\n                }\r\n              }\r\n\r\n              $scope.chartViewModel = new flowchart.ChartViewModel(chartDataModel);\r\n              $scope.getServices();\r\n            }])\r\n          .controller('editController', ['$scope', '$rootScope', '$q', '$stateParams', 'restServices', 'notificationService', '$window', '$location', '$state', function ($scope, $rootScope, $q, $stateParams, restServices, notificationService, $window, $location, $state) {\r\n              $('#datetimepickerStart').datetimepicker({\r\n                format: 'yyyy-MM-dd hh:mm',\r\n                language: 'es',\r\n                startDate: new Date()\r\n              })\r\n                      .on('changeDate', function (ev) {\r\n                        $scope.applyTextGmt();\r\n                        $scope.$apply();\r\n                      });\r\n              $('#datetimepickerEnd').datetimepicker({\r\n                format: 'yyyy-MM-dd hh:mm',\r\n                language: 'es',\r\n                startDate: new Date()\r\n              })\r\n                      .on('changeDate', function (ev) {\r\n                        $scope.applyTextGmt();\r\n                        $scope.$apply();\r\n                      });\r\n              $scope.campaign = {};\r\n              $scope.formCampaign = {};\r\n              $scope.complet = false;\r\n              if (typeof $stateParams.idautomaticcampaign == \"undefined\") {\r\n                $state.go('index');\r\n              }\r\n\r\n              $scope.idautomaticcampaign = $stateParams.idautomaticcampaign;\r\n              $scope.getautomaticcampaign = function () {\r\n                restServices.editAutomaticCampaign($scope.idautomaticcampaign).then(function (data) {\r\n                  //            console.log(data);\r\n                  $scope.campaign = data.data.campaign;\r\n                  $scope.setFormCampaing(data.data.configuration);\r\n                  $scope.validStatus($scope.campaign);\r\n                  $scope.initTextGmt();\r\n                }).catch(function (data) {\r\n                  //            console.log(data.data.configuration);\r\n                  if (data.data.configuration == null) {\r\n                    $state.go('index');\r\n                  }\r\n                  $scope.campaign = data.data.campaign;\r\n                  $scope.errorCampaign = true;\r\n                  $scope.msgErrorCampaign = data.message;\r\n                  $scope.setFormCampaing(data.data.configuration);\r\n                  $scope.validStatus($scope.campaign);\r\n                  $scope.initTextGmt();\r\n                });\r\n              }\r\n\r\n\r\n              $scope.getautomaticcampaign();\r\n              $scope.validStatus = function (campaign) {\r\n                if (campaign.status == 'confirmed') {\r\n                  $('#updateStatusCampaign').addClass('dialog--open');\r\n                }\r\n              }\r\n\r\n              $scope.closeModalStatus = function () {\r\n                $state.go('index');\r\n              }\r\n\r\n              $scope.toReturn = function () {\r\n                $state.go('index');\r\n              }\r\n\r\n              $scope.updateStatusCampaign = function () {\r\n                restServices.updateStatusCampaign($scope.idautomaticcampaign).then(function (data) {\r\n                  notificationService.primary(data.message);\r\n                  $('#updateStatusCampaign').removeClass('dialog--open');\r\n                });\r\n              }\r\n\r\n              $scope.setFormCampaing = function (configuration) {\r\n                $scope.formCampaign = angular.copy($scope.campaign);\r\n                //          $scope.formCampaign.status = ($scope.campaign.status == 1);\r\n                $(\"#datestartCampaign\").val($scope.campaign.startDate);\r\n                $(\"#dateendCampaign\").val($scope.campaign.endDate);\r\n                $scope.chartViewModel = new flowchart.ChartViewModel(configuration);\r\n                //          var themePre = $scope.chartViewModel.nodes[$scope.chartViewModel.nodes.length - 1].getTheme();\r\n                //          if (themePre == \"service\") {\r\n                //            for (var i = 0; i < $scope.items.length; i++) {\r\n                //              if ($scope.items[i].theme == \"service\") {\r\n                //                $scope.items[i].disabled = true;\r\n                //                $scope.items[i].class += \" disabled\";\r\n                //              } else if ($scope.items[i].theme == \"operator\") {\r\n                //                $scope.items[i].disabled = false;\r\n                //                $scope.items[i].class = \"small-text\";\r\n                //              }\r\n                //            }\r\n                //          } else {\r\n                //            for (var i = 0; i < $scope.items.length; i++) {\r\n                //              if ($scope.items[i].theme == \"operator\") {\r\n                //                $scope.items[i].disabled = true;\r\n                //                $scope.items[i].class += \" disabled\";\r\n                //              } else if ($scope.items[i].theme == \"service\") {\r\n                //                $scope.items[i].disabled = false;\r\n                //                $scope.items[i].class = \"small-text\";\r\n                //              }\r\n                //            }\r\n                //          }\r\n                $scope.complet = true;\r\n                $scope.getServices();\r\n              }\r\n\r\n              $scope.getServices = function () {\r\n                restServices.getservices().then(function (data) {\r\n                  $scope.services = data;\r\n                  $scope.items = [{\r\n                      class: 'item-success-inverted-no-hover small-text text-center',\r\n                      name: 'Servicio',\r\n                      icon: false,\r\n                      iconClass: \"fa fa-envelope-o\"\r\n                    }];\r\n                  for (var i = 0; i < data.length; i++) {\r\n                    if (data[i].service == \"sms\") {\r\n                      $scope.items.push({\r\n                        class: 'small-text text-center cursor-pointer',\r\n                        name: 'Sms',\r\n                        theme: 'service',\r\n                        method: 'sms',\r\n                        templatepopover: fullUrlBase + \"flowchart/popoversms\",\r\n                        titlepopover: 'Configurar sms',\r\n                        disabled: false,\r\n                        icon: true,\r\n                        iconClass: \"fa fa-mobile fa-2x\",\r\n                        image: fullUrlBase + \"images/automatic/SMSA-01.jpg\"\r\n                      });\r\n                    }\r\n                    if (data[i].service == \"email marketing\") {\r\n                      $scope.items.push({\r\n                        class: 'small-text text-center cursor-pointer',\r\n                        name: 'Mail',\r\n                        theme: 'service',\r\n                        method: 'email',\r\n                        templatepopover: fullUrlBase + \"flowchart/popovermail\",\r\n                        titlepopover: 'Configurar correo',\r\n                        disabled: false,\r\n                        icon: true,\r\n                        iconClass: \"fa fa-envelope-o fa-2x\",\r\n                        image: fullUrlBase + \"images/automatic/correoa-01.jpg\"\r\n                      });\r\n                    }\r\n                  }\r\n                  $scope.items.push({\r\n                    class: 'item-primary-inverted-no-hover small-text text-center',\r\n                    name: 'Operadores',\r\n                    icon: false,\r\n                    iconClass: \"fa fa-envelope-o\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Tiempo',\r\n                    theme: 'operator',\r\n                    method: 'time',\r\n                    templatepopover: fullUrlBase + \"flowchart/popovertime\",\r\n                    titlepopover: 'Operador por tiempo',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-clock-o fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/tiempoa-01.jpg\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Accion',\r\n                    theme: 'operator',\r\n                    method: 'actions',\r\n                    templatepopover: fullUrlBase + \"flowchart/popoveraction\",\r\n                    titlepopover: 'Operador por accion',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-cogs fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/accion-01.jpg\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Clicks',\r\n                    theme: 'operator',\r\n                    method: 'clicks',\r\n                    templatepopover: fullUrlBase + \"flowchart/popoverclick\",\r\n                    titlepopover: 'Operador por click',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-link fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/click-01.jpg\"\r\n                  });\r\n                  restServices.validateService($scope.chartViewModel.data, data);\r\n                }).catch(function (data) {\r\n                  $scope.services = data;\r\n                  $scope.items = [{\r\n                      class: 'item-success-inverted-no-hover small-text text-center  text-center',\r\n                      name: 'Servicio',\r\n                      icon: false,\r\n                      iconClass: \"fa fa-envelope-o\"\r\n                    }];\r\n                  $scope.items.push({\r\n                    class: 'item-primary-inverted-no-hover small-text text-center  text-center',\r\n                    name: 'Operadores',\r\n                    icon: false,\r\n                    iconClass: \"fa fa-envelope-o\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Tiempo',\r\n                    theme: 'operator',\r\n                    method: 'time',\r\n                    templatepopover: fullUrlBase + \"flowchart/popovertime\",\r\n                    titlepopover: 'Operador por tiempo',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-clock-o fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/tiempoa-01.jpg\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Accion',\r\n                    theme: 'operator',\r\n                    method: 'actions',\r\n                    templatepopover: fullUrlBase + \"flowchart/popoveraction\",\r\n                    titlepopover: 'Operador por accion',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-cogs fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/accion-01.jpg\"\r\n                  });\r\n                  $scope.items.push({\r\n                    class: 'small-text  text-center cursor-pointer',\r\n                    name: 'Clicks',\r\n                    theme: 'operator',\r\n                    method: 'clicks',\r\n                    templatepopover: fullUrlBase + \"flowchart/popoverclick\",\r\n                    titlepopover: 'Operador por click',\r\n                    disabled: true,\r\n                    icon: true,\r\n                    iconClass: \"fa fa-link fa-2x\",\r\n                    image: fullUrlBase + \"images/automatic/click-01.jpg\"\r\n                  });\r\n                });\r\n              }\r\n\r\n              $scope.getIdMax = function () {\r\n                var idMax = 0;\r\n                for (var i = 0; i < $scope.chartViewModel.nodes.length; i++) {\r\n                  var idNode = $scope.chartViewModel.nodes[i].getId();\r\n                  if (idNode > idMax) {\r\n                    idMax = idNode;\r\n                  }\r\n                }\r\n                return idMax;\r\n              }\r\n\r\n              /*        $scope.disabledItem = function () {\r\n               //          var themePre = $scope.chartViewModel.nodes[$scope.chartViewModel.nodes.length - 1].getTheme();\r\n               //          if (themePre == \"service\") {\r\n               //            for (var i = 0; i < $rootScope.items.length; i++) {\r\n               //              if ($rootScope.items[i].theme == \"service\") {\r\n               //                $rootScope.items[i].disabled = true;\r\n               //                $rootScope.items[i].class += \" disabled text-center cursor-pointer\";\r\n               //              } else if ($rootScope.items[i].theme == \"operator\") {\r\n               //                $rootScope.items[i].disabled = false;\r\n               //                $rootScope.items[i].class = \"small-text text-center cursor-pointer\";\r\n               //              }\r\n               //            }\r\n               //          } else {\r\n               //            for (var i = 0; i < $rootScope.items.length; i++) {\r\n               //              if ($rootScope.items[i].theme == \"operator\") {\r\n               //                $rootScope.items[i].disabled = true;\r\n               //                $rootScope.items[i].class += \" disabled text-center cursor-pointer\";\r\n               //              } else if ($rootScope.items[i].theme == \"service\") {\r\n               //                $rootScope.items[i].disabled = false;\r\n               //                $rootScope.items[i].class = \"small-text text-center cursor-pointer\";\r\n               //              }\r\n               //            }\r\n               //          }\r\n               //        }\r\n               \r\n               //        $scope.items = [{class: 'item-success-inverted-no-hover small-text', name: 'Servicio'},\r\n               //          {class: 'small-text', name: 'Sms', theme: 'service', method: 'sms', templatepopover: fullUrlBase + \"flowchart/popoversms\", titlepopover: 'Configurar sms', disable: false},\r\n               //          {class: 'small-text', name: 'Mail', theme: 'service', method: 'email', templatepopover: fullUrlBase + \"flowchart/popovermail\", titlepopover: 'Configurar correo', disable: false},\r\n               //          {class: 'item-primary-inverted-no-hover small-text', name: 'Operadores'},\r\n               //          {class: 'small-text disabled', name: 'Tiempo', theme: 'operator', method: 'time', templatepopover: fullUrlBase + \"flowchart/popovertime\", titlepopover: 'Operador por tiempo', disable: true},\r\n               //          {class: 'small-text disabled', name: 'Accion', theme: 'operator', method: 'actions', templatepopover: fullUrlBase + \"flowchart/popoveraction\", titlepopover: 'Operador por accion', disable: true}];*/\r\n\r\n              $scope.getallcategory = function () {\r\n                restServices.getallcategory().then(function (data) {\r\n                  $scope.listCategory = data;\r\n                });\r\n                restServices.getGmt().then(function (data) {\r\n                  $scope.listZonaHoraria = data;\r\n                });\r\n              }\r\n              $scope.getallcategory();\r\n\r\n              $scope.addNewNode = function (item) {\r\n                if (typeof item.method == \"undefined\") {\r\n                  return;\r\n                }\r\n                var newNodeDataModel = {\r\n                  name: item.name,\r\n                  id: $scope.getIdMax() + 1,\r\n                  x: 10,\r\n                  y: 50,\r\n                  width: 100,\r\n                  theme: item.theme,\r\n                  method: item.method,\r\n                  image: item.image,\r\n                  templatepopover: item.templatepopover,\r\n                  titlepopover: item.titletemplate,\r\n                  inputConnectors: [{\r\n                      name: \"\"\r\n                    }],\r\n                  outputConnectors: [{\r\n                      name: \"\"\r\n                    }],\r\n                  sendData: {}\r\n                };\r\n                if (item.method == \"actions\" || item.method == \"clicks\" || item.method == \"links\") {\r\n                  newNodeDataModel.outputConnectors.push({\r\n                    name: \"\"\r\n                  });\r\n                }\r\n                $scope.chartViewModel.addNode(newNodeDataModel);\r\n              };\r\n              $scope.updateAutomaticCampaign = function (option) {\r\n                restServices.validateJsonAutomaticCampaign($scope.chartViewModel.data, $scope.services).then(function (objData) {\r\n                  $scope.optionCreate = option;\r\n                  if (option == 1) {\r\n                    restServices.updateAutomaticCampaignConfiguration($scope.chartViewModel.data, $scope.idautomaticcampaign).then(function (data) {\r\n                      notificationService.primary(data.message);\r\n                      $('#updateAutomaticCampaign').removeClass('dialog--open');\r\n                    });\r\n                  } else {\r\n                    restServices.validateFormCampaign($scope.formCampaign).then(function (data) {\r\n                      var objSend = {\r\n                        formCampaign: data,\r\n                        objCampaign: $scope.chartViewModel.data\r\n                      };\r\n                      restServices.updateAutomaticCampaignAll(objSend, $scope.idautomaticcampaign).then(function (data) {\r\n                        notificationService.primary(data.message);\r\n                        $state.go('index');\r\n                      });\r\n                    }).catch(function () {\r\n                      $scope.opeModalUpdateCampaign();\r\n                    });\r\n                  }\r\n                });\r\n              }\r\n\r\n              $scope.uptCampaign = function () {\r\n                $scope.formCampaign.startDate = angular.copy($scope.dateGmtStart);\r\n                $scope.formCampaign.endDate = angular.copy($scope.dateGmtEnd);\r\n                restServices.validateFormCampaign($scope.formCampaign).then(function (data) {\r\n                  restServices.updateAutomaticCampaign(data, $scope.idautomaticcampaign).then(function (data) {\r\n                    //notificationService.primary(data.message);\r\n                    $scope.updateAutomaticCampaign(1);\r\n                    //$('#updateAutomaticCampaign').removeClass('dialog--open');\r\n                    $state.go('index');\r\n                  });\r\n                });\r\n              }\r\n\r\n              $scope.initTextGmt = function () {\r\n                $scope.showTextGmtStart = true;\r\n                $scope.showTextGmtEnd = true;\r\n                var StartUnix = moment($(\"#datestartCampaign\").val()).utc().valueOf();\r\n                $scope.dateGmtStart = moment(StartUnix).format('YYYY-MM-DD HH:mm');\r\n                var EndUnix = moment($(\"#dateendCampaign\").val()).utc().valueOf();\r\n                $scope.dateGmtEnd = moment(EndUnix).format('YYYY-MM-DD HH:mm');\r\n              }\r\n\r\n              $scope.applyTextGmt = function () {\r\n                if ($(\"#datestartCampaign\").val() != '') {\r\n                  $scope.showTextGmtStart = true;\r\n                } else {\r\n                  $scope.showTextGmtStart = false;\r\n                  $scope.textGmtStart = '';\r\n                }\r\n                if ($(\"#dateendCampaign\").val() != '') {\r\n                  $scope.showTextGmtEnd = true;\r\n                } else {\r\n                  $scope.showTextGmtEnd = false;\r\n                  $scope.textGmtEnd = '';\r\n                }\r\n                if ($scope.showTextGmtStart) {\r\n                  var StartUnix = moment($(\"#datestartCampaign\").val()).valueOf();\r\n                  $scope.dateGmtStart = moment(StartUnix).utcOffset($scope.formCampaign.gmt).format('YYYY-MM-DD HH:mm');\r\n                }\r\n                if ($scope.showTextGmtEnd) {\r\n                  var EndUnix = moment($(\"#dateendCampaign\").val()).valueOf();\r\n                  $scope.dateGmtEnd = moment(EndUnix).utcOffset($scope.formCampaign.gmt).format('YYYY-MM-DD HH:mm');\r\n                }\r\n\r\n              }\r\n\r\n              $scope.opeModalUpdateCampaign = function () {\r\n                $('#updateAutomaticCampaign').addClass('dialog--open');\r\n              }\r\n\r\n            }])\r\n          .controller('listController', ['$scope', 'restServices', '$q', '$interval', function ($scope, restServices, $q, $interval) {\r\n              $scope.initial = 0;\r\n              $scope.page = 1;\r\n              $scope.filter = {};\r\n              $scope.listAutomaticCampaign = {};\r\n              $scope.forward = function () {\r\n                $scope.initial += 1;\r\n                $scope.page += 1;\r\n                $scope.listautocamp();\r\n              };\r\n              $scope.fastforward = function () {\r\n                $scope.initial = ($scope.listAutomaticCampaign.total_pages - 1);\r\n                $scope.page = $scope.listAutomaticCampaign.total_pages;\r\n                $scope.listautocamp();\r\n              };\r\n              $scope.backward = function () {\r\n                $scope.initial -= 1;\r\n                $scope.page -= 1;\r\n                $scope.listautocamp();\r\n              };\r\n              $scope.fastbackward = function () {\r\n                $scope.initial = 0;\r\n                $scope.page = 1;\r\n                $scope.listautocamp();\r\n              };\r\n              $scope.listautocamp = function () {\r\n                var data = {};\r\n                $scope.listAutomaticCampaign.items = [];\r\n                restServices.listcampaign($scope.initial, $scope.filter).then(function (data) {\r\n                  $scope.listAutomaticCampaign = data;\r\n                  for (var i = 0; i < $scope.listAutomaticCampaign.items.length; i++) {\r\n                    var configuration = $scope.listAutomaticCampaign.items[i].configuration.configuration;\r\n                    if (angular.isUndefined(configuration) || configuration == 'null') {\r\n                      continue;\r\n                    }\r\n                    $scope.objConfiguration(configuration, $scope.listAutomaticCampaign.items[i].idAutomaticCampaign).then(function (data) {\r\n                      $scope.listConfiguration = data;\r\n                    });\r\n                  }\r\n                });\r\n              };\r\n              var statusVerify = function () {\r\n                var data = {};\r\n                restServices.listcampaign($scope.initial, data).then(function (data) {\r\n\r\n                  data.items.forEach(function (item, index) {\r\n                    if ($scope.listAutomaticCampaign.items[index].status != item.status) {\r\n                      $scope.listAutomaticCampaign.items[index].status = item.status;\r\n                    }\r\n                  });\r\n                  //$scope.mail = data;\r\n                });\r\n              };\r\n\r\n              $scope.openModal = function (idAutomaticCampaign) {\r\n                $scope.idAutCampaign = idAutomaticCampaign;\r\n                $('#cancelDialog').addClass('dialog--open');\r\n              };\r\n\r\n              $scope.closeModal = function () {\r\n                $('#cancelDialog').removeClass('dialog--open');\r\n              };\r\n\r\n              $scope.cancelCampaign = function () {\r\n                restServices.cancelAutomaticCampaign($scope.idAutCampaign).then(function (res) {\r\n                  slideOnTop(res.message, 3000, 'glyphicon glyphicon-remove-circle', 'info');\r\n                  $scope.listautocamp();\r\n                });\r\n                $scope.closeModal();\r\n              }\r\n\r\n              $interval(statusVerify, 60000);\r\n              $scope.countContacts = function (type, idAutomaticCampaign, lista) {\r\n                var data = {\r\n                  type: type,\r\n                  segment: lista,\r\n                  contactlist: lista\r\n                };\r\n                restServices.countContact(data).then(function (data) {\r\n                  for (var j = 0; j < $scope.listAutomaticCampaign.items.length; j++) {\r\n                    if (parseInt($scope.listAutomaticCampaign.items[j].idAutomaticCampaign) == parseInt(idAutomaticCampaign)) {\r\n                      $scope.listAutomaticCampaign.items[j].quantitytarget = data;\r\n                    }\r\n                  }\r\n                });\r\n              };\r\n              $scope.objConfiguration = function (Configuration, idAutomaticCampaign) {\r\n                var defer = $q.defer();\r\n                var objConfiguration = JSON.parse(Configuration);\r\n                var arrReturn = [];\r\n                for (var i = 0; i < objConfiguration.nodes.length; i++) {\r\n                  var node = objConfiguration.nodes[i];\r\n                  var str = \"\";\r\n                  if (node.method == \"primary\") {\r\n                    str = node.sendData.list.name + \" : \";\r\n                    var type = \"\";\r\n                    for (var j = 0; j < node.sendData.selecteds.length; j++) {\r\n                      if (node.sendData.list.id == 1) {\r\n                        type = \"contactlist\";\r\n                        $scope.countContacts(type, idAutomaticCampaign, node.sendData.selecteds);\r\n                        str += node.sendData.selecteds[j].name + \"(\" + node.sendData.selecteds[j].idContactlist + \"),\";\r\n                      } else {\r\n                        type = \"segment\";\r\n                        $scope.countContacts(type, idAutomaticCampaign, node.sendData.selecteds);\r\n                        str += node.sendData.selecteds[j].name + \"(\" + node.sendData.selecteds[j].idSegment + \"),\";\r\n                      }\r\n                    }\r\n\r\n                    str = str.substring(0, str.length - 1);\r\n                    arrReturn.push({\r\n                      step: i,\r\n                      detail: str,\r\n                      method: node.method,\r\n                      methodAlias: \"Destinatarios\"\r\n                    });\r\n                  }\r\n                  if (node.method == \"sms\") {\r\n                    str = \"La plantilla de sms : \" + node.sendData.smstemplate.name + \" con la categoria: \" + node.sendData.smscategory.name;\r\n                    arrReturn.push({\r\n                      step: i,\r\n                      detail: str,\r\n                      method: node.method,\r\n                      methodAlias: \"Sms\"\r\n                    });\r\n                  }\r\n                  if (node.method == \"email\") {\r\n                    str = \"Plantilla de correo : \" + node.sendData.mailtemplate.name + \" con la categoria: \" + node.sendData.mailcategory.name;\r\n                    arrReturn.push({\r\n                      step: i,\r\n                      detail: str,\r\n                      method: node.method,\r\n                      methodAlias: \"Correo\"\r\n                    });\r\n                  }\r\n                  if (node.method == \"time\") {\r\n                    str = node.sendData.text;\r\n                    arrReturn.push({\r\n                      step: i,\r\n                      detail: str,\r\n                      method: node.method,\r\n                      methodAlias: \"Tiempo\"\r\n                    });\r\n                  }\r\n                  if (node.method == \"actions\") {\r\n                    str = node.sendData.text;\r\n                    arrReturn.push({\r\n                      step: i,\r\n                      detail: str,\r\n                      method: node.method,\r\n                      methodAlias: \"Acción\"\r\n                    });\r\n                  }\r\n                }\r\n                for (var j = 0; j < $scope.listAutomaticCampaign.items.length; j++) {\r\n                  if (parseInt($scope.listAutomaticCampaign.items[j].idAutomaticCampaign) == parseInt(idAutomaticCampaign)) {\r\n                    $scope.listAutomaticCampaign.items[j].listConfiguration = arrReturn;\r\n                  }\r\n                }\r\n                defer.resolve(arrReturn);\r\n                return defer.promise;\r\n              }\r\n\r\n              $scope.search = function () {\r\n                $scope.listautocamp();\r\n              }\r\n\r\n              $scope.searchcategory = function () {\r\n                $scope.listautocamp();\r\n              };\r\n\r\n              $scope.getCategory = function () {\r\n                restServices.getallcategory().then(function (data) {\r\n                  $scope.automaCategory = data;\r\n                });\r\n              }\r\n\r\n              $scope.$watch('[filter.dateinitial,filter.dateend]', function () {\r\n//              if((angular.isDefined($scope.filter.dateinitial) && $scope.filter.dateinitial != \"\") && (angular.isDefined($scope.filter.dateend) && $scope.filter.dateend != \"\")){\r\n                $scope.listautocamp();\r\n//              }\r\n              });\r\n\r\n              $scope.listautocamp();\r\n              $scope.getCategory();\r\n            }])\r\n          .controller('viewschemeController', ['$scope', '$stateParams', 'restServices', '$q', '$interval', function ($scope, $stateParams, restServices, $q, $interval) {\r\n              $scope.idautomaticcampaign = $stateParams.idautomaticcampaign;\r\n              $scope.getautomaticcampaign = function () {\r\n                restServices.getScheme($scope.idautomaticcampaign).then(function (data) {\r\n                  $scope.campaign = data.data.campaign;\r\n                  $scope.setFormCampaing(data.data.configuration);\r\n                }).catch(function (data) {\r\n                  if (data.data.configuration == null) {\r\n                    $state.go('index');\r\n                  }\r\n                  $scope.campaign = data.data.campaign;\r\n                  $scope.errorCampaign = true;\r\n                  $scope.msgErrorCampaign = data.message;\r\n                  $scope.setFormCampaing(data.data.configuration);\r\n                });\r\n              }\r\n\r\n              $scope.getautomaticcampaign();\r\n\r\n              $scope.setFormCampaing = function (configuration) {\r\n                $scope.formCampaign = angular.copy($scope.campaign);\r\n                $(\"#datestartCampaign\").val($scope.campaign.startDate);\r\n                $(\"#dateendCampaign\").val($scope.campaign.endDate);\r\n                $scope.chartViewModel = new flowchart.ChartViewModel(configuration);\r\n                $scope.complet = true;\r\n              }\r\n            }]);\r\n})();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9hbmd1bGFyL2F1dG9tYXRpY2NhbXBhaWduL2NvbnRyb2xsZXJzLmpzP2ExNWIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFNBQVM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUNBQWlDLGlCQUFpQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEIsc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQixpQkFBaUI7QUFDakI7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0JBQStCLHdDQUF3QztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLDZCQUE2QjtBQUMxRTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0IsNkNBQTZDLDZCQUE2QjtBQUMxRTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QixxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7O0FBRUEsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMseUJBQXlCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qiw2Q0FBNkMseUJBQXlCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUNBQWlDLGlCQUFpQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQSwrQkFBK0Isd0NBQXdDO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0Qyw2QkFBNkI7QUFDekU7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCLDRDQUE0Qyw2QkFBNkI7QUFDekU7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwwQ0FBMEMscUVBQXFFO0FBQy9HLDRCQUE0Qix5S0FBeUs7QUFDck0sNEJBQTRCLGdMQUFnTDtBQUM1TSw0QkFBNEIsdUVBQXVFO0FBQ25HLDRCQUE0Qiw0TEFBNEw7QUFDeE4sNEJBQTRCLGlNQUFpTSxFQUFFOztBQUUvTjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCLHFCQUFxQjtBQUNyQjtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQywrQ0FBK0M7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsK0NBQStDO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsbUNBQW1DO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsb0NBQW9DO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLCtCQUErQiwrQ0FBK0M7QUFDOUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLENBQUMiLCJmaWxlIjoiMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XHJcbiAgYW5ndWxhci5tb2R1bGUoJ2F1dG9tYXRpY2NhbXBhaWduLmNvbnRyb2xsZXJzJywgW10pXHJcbiAgICAgICAgICAuZmlsdGVyKCdnZXRHbXRCeUlkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGlucHV0LCBpZCkge1xyXG4gICAgICAgICAgICAgIHZhciBpID0gMCxcclxuICAgICAgICAgICAgICAgICAgICAgIGxlbiA9IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRbaV0uZ210ID09IGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiBpbnB1dFtpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY29udHJvbGxlcignY3JlYXRlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJHEnLCAnbm90aWZpY2F0aW9uU2VydmljZScsICdyZXN0U2VydmljZXMnLCAnbW9tZW50JywgJyRmaWx0ZXInLCAnJHdpbmRvdycsICckbG9jYXRpb24nLCAnJHN0YXRlJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgJHEsIG5vdGlmaWNhdGlvblNlcnZpY2UsIHJlc3RTZXJ2aWNlcywgbW9tZW50LCAkZmlsdGVyLCAkd2luZG93LCAkbG9jYXRpb24sICRzdGF0ZSkge1xyXG4gICAgICAgICAgICAgICQoJyNkYXRldGltZXBpY2tlclN0YXJ0JykuZGF0ZXRpbWVwaWNrZXIoe1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiAneXl5eS1NTS1kZCBoaDptbScsXHJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZTogJ2VzJyxcclxuICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogbmV3IERhdGUoKVxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAub24oJ2NoYW5nZURhdGUnLCBmdW5jdGlvbiAoZXYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcGx5VGV4dEdtdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAkKCcjZGF0ZXRpbWVwaWNrZXJFbmQnKS5kYXRldGltZXBpY2tlcih7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXQ6ICd5eXl5LU1NLWRkIGhoOm1tJyxcclxuICAgICAgICAgICAgICAgIGxhbmd1YWdlOiAnZXMnLFxyXG4gICAgICAgICAgICAgICAgc3RhcnREYXRlOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5vbignY2hhbmdlRGF0ZScsIGZ1bmN0aW9uIChldikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbHlUZXh0R210KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICRzY29wZS5zaG93VGV4dEdtdFN0YXJ0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnNob3dUZXh0R210RW5kID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgdmFyIGlkTWF4ID0gMTA7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmZvcm1DYW1wYWlnbiA9IHt9O1xyXG4gICAgICAgICAgICAgICRzY29wZS5nZXRTZXJ2aWNlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy5nZXRzZXJ2aWNlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VzID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW3tcclxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnaXRlbS1zdWNjZXNzLWludmVydGVkLW5vLWhvdmVyIHNtYWxsLXRleHQgdGV4dC1jZW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1NlcnZpY2lvJyxcclxuICAgICAgICAgICAgICAgICAgICAgIGljb246IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzOiBcImZhIGZhLWVudmVsb3BlLW9cIlxyXG4gICAgICAgICAgICAgICAgICAgIH1dO1xyXG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtpXS5zZXJ2aWNlID09IFwic21zXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdzbWFsbC10ZXh0IHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1NtcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiAnc2VydmljZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ3NtcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlcG9wb3ZlcjogZnVsbFVybEJhc2UgKyBcImZsb3djaGFydC9wb3BvdmVyc21zXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlcG9wb3ZlcjogJ0NvbmZpZ3VyYXIgc21zJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtbW9iaWxlIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBmdWxsVXJsQmFzZSArIFwiaW1hZ2VzL2F1dG9tYXRpYy9TTVNBLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbaV0uc2VydmljZSA9PSBcImVtYWlsIG1hcmtldGluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnc21hbGwtdGV4dCB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdNYWlsJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdzZXJ2aWNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZW1haWwnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3Zlcm1haWxcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiAnQ29uZmlndXJhciBjb3JyZW8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1lbnZlbG9wZS1vIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBmdWxsVXJsQmFzZSArIFwiaW1hZ2VzL2F1dG9tYXRpYy9jb3JyZW9hLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLyppZiAoZGF0YVtpXS5zZXJ2aWNlID09IFwic3VydmV5XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICBjbGFzczogJ3NtYWxsLXRleHQgdGV4dC1jZW50ZXIgY3Vyc29yLXBvaW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICBuYW1lOiAnRW5jdWVzdGFzJyxcclxuICAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdzZXJ2aWNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnc3VydmV5JyxcclxuICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJzdXJ2ZXlcIixcclxuICAgICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiAnQ29uZmlndXJhciBzdXJ2ZXknLFxyXG4gICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgIGljb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1hZGRyZXNzLWJvb2stbyBmYS0yeFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICBpbWFnZTogZnVsbFVybEJhc2UgKyBcImltYWdlcy9nZW5lcmFsL2Zvcm1zLnBuZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICB9Ki9cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdpdGVtLXByaW1hcnktaW52ZXJ0ZWQtbm8taG92ZXIgc21hbGwtdGV4dCB0ZXh0LWNlbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ09wZXJhZG9yZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1lbnZlbG9wZS1vXCJcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzczogJ3NtYWxsLXRleHQgIHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnVGllbXBvJyxcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogJ29wZXJhdG9yJyxcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICd0aW1lJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3ZlcnRpbWVcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZXBvcG92ZXI6ICdPcGVyYWRvciBwb3IgdGllbXBvJyxcclxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1jbG9jay1vIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGZ1bGxVcmxCYXNlICsgXCJpbWFnZXMvYXV0b21hdGljL3RpZW1wb2EtMDEuanBnXCJcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzczogJ3NtYWxsLXRleHQgIHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnQWNjaW9uJyxcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogJ29wZXJhdG9yJyxcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdhY3Rpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3ZlcmFjdGlvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlcG9wb3ZlcjogJ09wZXJhZG9yIHBvciBhY2Npb24nLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzOiBcImZhIGZhLWNvZ3MgZmEtMnhcIixcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZTogZnVsbFVybEJhc2UgKyBcImltYWdlcy9hdXRvbWF0aWMvYWNjaW9uLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdzbWFsbC10ZXh0ICB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0NsaWNrcycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdvcGVyYXRvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnY2xpY2tzJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3ZlcmNsaWNrXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiAnT3BlcmFkb3IgcG9yIGNsaWNrJyxcclxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1saW5rIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGZ1bGxVcmxCYXNlICsgXCJpbWFnZXMvYXV0b21hdGljL2NsaWNrLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICByZXN0U2VydmljZXMudmFsaWRhdGVTZXJ2aWNlKCRzY29wZS5jaGFydFZpZXdNb2RlbC5kYXRhLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5zZXJ2aWNlcyA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzczogJ2l0ZW0tc3VjY2Vzcy1pbnZlcnRlZC1uby1ob3ZlciBzbWFsbC10ZXh0IHRleHQtY2VudGVyICB0ZXh0LWNlbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnU2VydmljaW8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgaWNvbjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtZW52ZWxvcGUtb1wiXHJcbiAgICAgICAgICAgICAgICAgICAgfV07XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzczogJ2l0ZW0tcHJpbWFyeS1pbnZlcnRlZC1uby1ob3ZlciBzbWFsbC10ZXh0IHRleHQtY2VudGVyICB0ZXh0LWNlbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ09wZXJhZG9yZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1lbnZlbG9wZS1vXCJcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzczogJ3NtYWxsLXRleHQgIHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnVGllbXBvJyxcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogJ29wZXJhdG9yJyxcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICd0aW1lJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3ZlcnRpbWVcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZXBvcG92ZXI6ICdPcGVyYWRvciBwb3IgdGllbXBvJyxcclxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1jbG9jay1vIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGZ1bGxVcmxCYXNlICsgXCJpbWFnZXMvYXV0b21hdGljL3RpZW1wb2EtMDEuanBnXCJcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzczogJ3NtYWxsLXRleHQgIHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnQWNjaW9uJyxcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogJ29wZXJhdG9yJyxcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdhY3Rpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3ZlcmFjdGlvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlcG9wb3ZlcjogJ09wZXJhZG9yIHBvciBhY2Npb24nLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzOiBcImZhIGZhLWNvZ3MgZmEtMnhcIixcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZTogZnVsbFVybEJhc2UgKyBcImltYWdlcy9hdXRvbWF0aWMvYWNjaW9uLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdzbWFsbC10ZXh0ICB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0NsaWNrcycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdvcGVyYXRvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnY2xpY2tzJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3ZlcmNsaWNrXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiAnT3BlcmFkb3IgcG9yIGNsaWNrJyxcclxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1saW5rIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGZ1bGxVcmxCYXNlICsgXCJpbWFnZXMvYXV0b21hdGljL2NsaWNrLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgdmFyIGNoYXJ0RGF0YU1vZGVsID0ge1xyXG4gICAgICAgICAgICAgICAgbm9kZXM6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJEZXN0aW5hdGFyaW8ocylcIixcclxuICAgICAgICAgICAgICAgICAgICBpZDogMCxcclxuICAgICAgICAgICAgICAgICAgICB4OiAxNzAsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogMjUsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCxcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZTogZnVsbFVybEJhc2UgKyBcImltYWdlcy9hdXRvbWF0aWMvZGVzdGluYXRhcmlvc2EtMDEuanBnXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6IFwicHJpbWFyeVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJwcmltYXJ5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJzZWdtZW50XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiBcIlNlbGVjY2lvbmEgYSBxdWllbiBxdWllcmUgZW52aWFyIGVzdGEgY2FtcGHDsWEgYXV0b23DoXRpY2EuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0Q29ubmVjdG9yczogW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VuZERhdGE6IHt9XHJcbiAgICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbnM6IFtdXHJcbiAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmdldElkTWF4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkTWF4ID0gMDtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLmNoYXJ0Vmlld01vZGVsLm5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBpZE5vZGUgPSAkc2NvcGUuY2hhcnRWaWV3TW9kZWwubm9kZXNbaV0uZ2V0SWQoKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKGlkTm9kZSA+IGlkTWF4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWRNYXggPSBpZE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpZE1heDtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS5hZGROZXdOb2RlID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbS5tZXRob2QgPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgaWYgKGl0ZW0uZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgdmFyIHRoZW1lUHJlID0gJHNjb3BlLmNoYXJ0Vmlld01vZGVsLm5vZGVzWyRzY29wZS5jaGFydFZpZXdNb2RlbC5ub2Rlcy5sZW5ndGggLSAxXS5nZXRUaGVtZSgpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgaWYgKGl0ZW0udGhlbWUgPT0gXCJzZXJ2aWNlXCIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkcm9vdFNjb3BlLml0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaXRlbXNbaV0udGhlbWUgPT0gXCJzZXJ2aWNlXCIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXRlbXNbaV0uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pdGVtc1tpXS5jbGFzcyArPSBcIiBkaXNhYmxlZCB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlclwiO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgIH0gZWxzZSBpZiAoJHJvb3RTY29wZS5pdGVtc1tpXS50aGVtZSA9PSBcIm9wZXJhdG9yXCIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXRlbXNbaV0uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXRlbXNbaV0uY2xhc3MgPSBcInNtYWxsLXRleHQgdGV4dC1jZW50ZXIgY3Vyc29yLXBvaW50ZXJcIjtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHJvb3RTY29wZS5pdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLml0ZW1zW2ldLnRoZW1lID09IFwib3BlcmF0b3JcIikge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pdGVtc1tpXS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLml0ZW1zW2ldLmNsYXNzICs9IFwiIGRpc2FibGVkIHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyXCI7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgfSBlbHNlIGlmICgkcm9vdFNjb3BlLml0ZW1zW2ldLnRoZW1lID09IFwic2VydmljZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLml0ZW1zW2ldLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLml0ZW1zW2ldLmNsYXNzID0gXCJzbWFsbC10ZXh0IHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyXCI7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZURhdGFNb2RlbCA9IHtcclxuICAgICAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICBpZDogJHNjb3BlLmdldElkTWF4KCkgKyAxLFxyXG4gICAgICAgICAgICAgICAgICB4OiAxMCxcclxuICAgICAgICAgICAgICAgICAgeTogNTAsXHJcbiAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAsXHJcbiAgICAgICAgICAgICAgICAgIHRoZW1lOiBpdGVtLnRoZW1lLFxyXG4gICAgICAgICAgICAgICAgICBtZXRob2Q6IGl0ZW0ubWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICBpbWFnZTogaXRlbS5pbWFnZSxcclxuICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBpdGVtLnRlbXBsYXRlcG9wb3ZlcixcclxuICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiBpdGVtLnRpdGxldGVtcGxhdGUsXHJcbiAgICAgICAgICAgICAgICAgIGlucHV0Q29ubmVjdG9yczogW3tcclxuICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiXCJcclxuICAgICAgICAgICAgICAgICAgICB9XSxcclxuICAgICAgICAgICAgICAgICAgb3V0cHV0Q29ubmVjdG9yczogW3tcclxuICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiXCJcclxuICAgICAgICAgICAgICAgICAgICB9XSxcclxuICAgICAgICAgICAgICAgICAgc2VuZERhdGE6IHt9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubWV0aG9kID09IFwiYWN0aW9uc1wiIHx8IGl0ZW0ubWV0aG9kID09IFwiY2xpY2tzXCIgfHwgaXRlbS5tZXRob2QgPT0gXCJsaW5rc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgIG5ld05vZGVEYXRhTW9kZWwub3V0cHV0Q29ubmVjdG9ycy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlwiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYXJ0Vmlld01vZGVsLmFkZE5vZGUobmV3Tm9kZURhdGFNb2RlbCk7XHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlQXV0b21hdGljQ2FtcGFpZ24gPSBmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICByZXN0U2VydmljZXMudmFsaWRhdGVKc29uQXV0b21hdGljQ2FtcGFpZ24oJHNjb3BlLmNoYXJ0Vmlld01vZGVsLmRhdGEsICRzY29wZS5zZXJ2aWNlcykudGhlbihmdW5jdGlvbiAob2JqRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUub3B0aW9uQ3JlYXRlID0gb3B0aW9uO1xyXG4gICAgICAgICAgICAgICAgICBpZiAob3B0aW9uID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mICRzY29wZS5pZENhbXBhaWduICE9IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy51cGRhdGVBdXRvbWF0aWNDYW1wYWlnbkNvbmZpZ3VyYXRpb24oJHNjb3BlLmNoYXJ0Vmlld01vZGVsLmRhdGEsICRzY29wZS5pZENhbXBhaWduKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UucHJpbWFyeShkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy5jcmVhdGVBdXRvbWF0aWNDYW1wYWlnbkRyYWZ0KCRzY29wZS5jaGFydFZpZXdNb2RlbC5kYXRhKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2Uuc3VjY2VzcyhkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaWRDYW1wYWlnbiA9IGRhdGEuaWRDYW1wYWlnbjtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQXV0b21hdGljQ2FtcGFpZ24nKS5hZGRDbGFzcygnZGlhbG9nLS1vcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS50b1JldHVybiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaW5kZXgnKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS5pbnNDYW1wYWlnbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5mb3JtQ2FtcGFpZ24uc3RhcnREYXRlID0gYW5ndWxhci5jb3B5KCRzY29wZS5kYXRlR210U3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZvcm1DYW1wYWlnbi5lbmREYXRlID0gYW5ndWxhci5jb3B5KCRzY29wZS5kYXRlR210RW5kKTtcclxuICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy52YWxpZGF0ZUZvcm1DYW1wYWlnbigkc2NvcGUuZm9ybUNhbXBhaWduKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBvYmpTZW5kID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1DYW1wYWlnbjogZGF0YSxcclxuICAgICAgICAgICAgICAgICAgICBvYmpDYW1wYWlnbjogJHNjb3BlLmNoYXJ0Vmlld01vZGVsLmRhdGFcclxuICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAkc2NvcGUuaWRDYW1wYWlnbiA9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdFNlcnZpY2VzLmNyZWF0ZUF1dG9tYXRpY0NhbXBhaWduKG9ialNlbmQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2Uuc3VjY2VzcyhkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgJCgnI2NyZWF0ZUF1dG9tYXRpY0NhbXBhaWduJykucmVtb3ZlQ2xhc3MoJ2RpYWxvZy0tb3BlbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdpbmRleCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy51cGRhdGVBdXRvbWF0aWNDYW1wYWlnbkFsbChvYmpTZW5kLCAkc2NvcGUuaWRDYW1wYWlnbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5wcmltYXJ5KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQXV0b21hdGljQ2FtcGFpZ24nKS5yZW1vdmVDbGFzcygnZGlhbG9nLS1vcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2luZGV4Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmdldGFsbGNhdGVnb3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdFNlcnZpY2VzLmdldGFsbGNhdGVnb3J5KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubGlzdENhdGVnb3J5ID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmVzdFNlcnZpY2VzLmdldEdtdCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmxpc3Rab25hSG9yYXJpYSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBmaWx0ZXIgPSAkZmlsdGVyKCdnZXRHbXRCeUlkJykoJHNjb3BlLmxpc3Rab25hSG9yYXJpYSwgXCItMDUwMFwiKTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmZvcm1DYW1wYWlnbi5nbXQgPSBmaWx0ZXIuZ210O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICRzY29wZS5nZXRhbGxjYXRlZ29yeSgpO1xyXG4gICAgICAgICAgICAgICRzY29wZS5hcHBseVRleHRHbXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJChcIiNkYXRlc3RhcnRDYW1wYWlnblwiKS52YWwoKSAhPSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1RleHRHbXRTdGFydCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1RleHRHbXRTdGFydCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUudGV4dEdtdFN0YXJ0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoJChcIiNkYXRlZW5kQ2FtcGFpZ25cIikudmFsKCkgIT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dUZXh0R210RW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93VGV4dEdtdEVuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUudGV4dEdtdEVuZCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zaG93VGV4dEdtdFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBTdGFydFVuaXggPSBtb21lbnQoJChcIiNkYXRlc3RhcnRDYW1wYWlnblwiKS52YWwoKSkudXRjKCkudmFsdWVPZigpO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0ZUdtdFN0YXJ0ID0gbW9tZW50KFN0YXJ0VW5peCkudXRjT2Zmc2V0KCRzY29wZS5mb3JtQ2FtcGFpZ24uZ210KS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKTtcclxuICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICBjb25zb2xlLmxvZyhTdGFydFVuaXgsJHNjb3BlLmZvcm1DYW1wYWlnbi5nbXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zaG93VGV4dEdtdEVuZCkge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgRW5kVW5peCA9IG1vbWVudCgkKFwiI2RhdGVlbmRDYW1wYWlnblwiKS52YWwoKSkudXRjKCkudmFsdWVPZigpO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0ZUdtdEVuZCA9IG1vbWVudChFbmRVbml4KS51dGNPZmZzZXQoJHNjb3BlLmZvcm1DYW1wYWlnbi5nbXQpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbScpO1xyXG4gICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGNvbnNvbGUubG9nKEVuZFVuaXgsJHNjb3BlLmZvcm1DYW1wYWlnbi5nbXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmNoYXJ0Vmlld01vZGVsID0gbmV3IGZsb3djaGFydC5DaGFydFZpZXdNb2RlbChjaGFydERhdGFNb2RlbCk7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmdldFNlcnZpY2VzKCk7XHJcbiAgICAgICAgICAgIH1dKVxyXG4gICAgICAgICAgLmNvbnRyb2xsZXIoJ2VkaXRDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckcScsICckc3RhdGVQYXJhbXMnLCAncmVzdFNlcnZpY2VzJywgJ25vdGlmaWNhdGlvblNlcnZpY2UnLCAnJHdpbmRvdycsICckbG9jYXRpb24nLCAnJHN0YXRlJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgJHEsICRzdGF0ZVBhcmFtcywgcmVzdFNlcnZpY2VzLCBub3RpZmljYXRpb25TZXJ2aWNlLCAkd2luZG93LCAkbG9jYXRpb24sICRzdGF0ZSkge1xyXG4gICAgICAgICAgICAgICQoJyNkYXRldGltZXBpY2tlclN0YXJ0JykuZGF0ZXRpbWVwaWNrZXIoe1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiAneXl5eS1NTS1kZCBoaDptbScsXHJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZTogJ2VzJyxcclxuICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogbmV3IERhdGUoKVxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAub24oJ2NoYW5nZURhdGUnLCBmdW5jdGlvbiAoZXYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcGx5VGV4dEdtdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAkKCcjZGF0ZXRpbWVwaWNrZXJFbmQnKS5kYXRldGltZXBpY2tlcih7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXQ6ICd5eXl5LU1NLWRkIGhoOm1tJyxcclxuICAgICAgICAgICAgICAgIGxhbmd1YWdlOiAnZXMnLFxyXG4gICAgICAgICAgICAgICAgc3RhcnREYXRlOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5vbignY2hhbmdlRGF0ZScsIGZ1bmN0aW9uIChldikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbHlUZXh0R210KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICRzY29wZS5jYW1wYWlnbiA9IHt9O1xyXG4gICAgICAgICAgICAgICRzY29wZS5mb3JtQ2FtcGFpZ24gPSB7fTtcclxuICAgICAgICAgICAgICAkc2NvcGUuY29tcGxldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgJHN0YXRlUGFyYW1zLmlkYXV0b21hdGljY2FtcGFpZ24gPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdpbmRleCcpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmlkYXV0b21hdGljY2FtcGFpZ24gPSAkc3RhdGVQYXJhbXMuaWRhdXRvbWF0aWNjYW1wYWlnbjtcclxuICAgICAgICAgICAgICAkc2NvcGUuZ2V0YXV0b21hdGljY2FtcGFpZ24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXN0U2VydmljZXMuZWRpdEF1dG9tYXRpY0NhbXBhaWduKCRzY29wZS5pZGF1dG9tYXRpY2NhbXBhaWduKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5jYW1wYWlnbiA9IGRhdGEuZGF0YS5jYW1wYWlnbjtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLnNldEZvcm1DYW1wYWluZyhkYXRhLmRhdGEuY29uZmlndXJhdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS52YWxpZFN0YXR1cygkc2NvcGUuY2FtcGFpZ24pO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaW5pdFRleHRHbXQoKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YS5kYXRhLmNvbmZpZ3VyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLmNvbmZpZ3VyYXRpb24gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaW5kZXgnKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuY2FtcGFpZ24gPSBkYXRhLmRhdGEuY2FtcGFpZ247XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvckNhbXBhaWduID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLm1zZ0Vycm9yQ2FtcGFpZ24gPSBkYXRhLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRGb3JtQ2FtcGFpbmcoZGF0YS5kYXRhLmNvbmZpZ3VyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUudmFsaWRTdGF0dXMoJHNjb3BlLmNhbXBhaWduKTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmluaXRUZXh0R210KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUuZ2V0YXV0b21hdGljY2FtcGFpZ24oKTtcclxuICAgICAgICAgICAgICAkc2NvcGUudmFsaWRTdGF0dXMgPSBmdW5jdGlvbiAoY2FtcGFpZ24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYW1wYWlnbi5zdGF0dXMgPT0gJ2NvbmZpcm1lZCcpIHtcclxuICAgICAgICAgICAgICAgICAgJCgnI3VwZGF0ZVN0YXR1c0NhbXBhaWduJykuYWRkQ2xhc3MoJ2RpYWxvZy0tb3BlbicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmNsb3NlTW9kYWxTdGF0dXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2luZGV4Jyk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUudG9SZXR1cm4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2luZGV4Jyk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlU3RhdHVzQ2FtcGFpZ24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXN0U2VydmljZXMudXBkYXRlU3RhdHVzQ2FtcGFpZ24oJHNjb3BlLmlkYXV0b21hdGljY2FtcGFpZ24pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5wcmltYXJ5KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICQoJyN1cGRhdGVTdGF0dXNDYW1wYWlnbicpLnJlbW92ZUNsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLnNldEZvcm1DYW1wYWluZyA9IGZ1bmN0aW9uIChjb25maWd1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybUNhbXBhaWduID0gYW5ndWxhci5jb3B5KCRzY29wZS5jYW1wYWlnbik7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAkc2NvcGUuZm9ybUNhbXBhaWduLnN0YXR1cyA9ICgkc2NvcGUuY2FtcGFpZ24uc3RhdHVzID09IDEpO1xyXG4gICAgICAgICAgICAgICAgJChcIiNkYXRlc3RhcnRDYW1wYWlnblwiKS52YWwoJHNjb3BlLmNhbXBhaWduLnN0YXJ0RGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI2RhdGVlbmRDYW1wYWlnblwiKS52YWwoJHNjb3BlLmNhbXBhaWduLmVuZERhdGUpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYXJ0Vmlld01vZGVsID0gbmV3IGZsb3djaGFydC5DaGFydFZpZXdNb2RlbChjb25maWd1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgIHZhciB0aGVtZVByZSA9ICRzY29wZS5jaGFydFZpZXdNb2RlbC5ub2Rlc1skc2NvcGUuY2hhcnRWaWV3TW9kZWwubm9kZXMubGVuZ3RoIC0gMV0uZ2V0VGhlbWUoKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgIGlmICh0aGVtZVByZSA9PSBcInNlcnZpY2VcIikge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5pdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgIGlmICgkc2NvcGUuaXRlbXNbaV0udGhlbWUgPT0gXCJzZXJ2aWNlXCIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpXS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXNbaV0uY2xhc3MgKz0gXCIgZGlzYWJsZWRcIjtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5pdGVtc1tpXS50aGVtZSA9PSBcIm9wZXJhdG9yXCIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpXS5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2ldLmNsYXNzID0gXCJzbWFsbC10ZXh0XCI7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5pdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgIGlmICgkc2NvcGUuaXRlbXNbaV0udGhlbWUgPT0gXCJvcGVyYXRvclwiKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXNbaV0uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2ldLmNsYXNzICs9IFwiIGRpc2FibGVkXCI7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUuaXRlbXNbaV0udGhlbWUgPT0gXCJzZXJ2aWNlXCIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpXS5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2ldLmNsYXNzID0gXCJzbWFsbC10ZXh0XCI7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGxldCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0U2VydmljZXMoKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS5nZXRTZXJ2aWNlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy5nZXRzZXJ2aWNlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VzID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW3tcclxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnaXRlbS1zdWNjZXNzLWludmVydGVkLW5vLWhvdmVyIHNtYWxsLXRleHQgdGV4dC1jZW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1NlcnZpY2lvJyxcclxuICAgICAgICAgICAgICAgICAgICAgIGljb246IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzOiBcImZhIGZhLWVudmVsb3BlLW9cIlxyXG4gICAgICAgICAgICAgICAgICAgIH1dO1xyXG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtpXS5zZXJ2aWNlID09IFwic21zXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdzbWFsbC10ZXh0IHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1NtcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiAnc2VydmljZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ3NtcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlcG9wb3ZlcjogZnVsbFVybEJhc2UgKyBcImZsb3djaGFydC9wb3BvdmVyc21zXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlcG9wb3ZlcjogJ0NvbmZpZ3VyYXIgc21zJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtbW9iaWxlIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBmdWxsVXJsQmFzZSArIFwiaW1hZ2VzL2F1dG9tYXRpYy9TTVNBLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbaV0uc2VydmljZSA9PSBcImVtYWlsIG1hcmtldGluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnc21hbGwtdGV4dCB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdNYWlsJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdzZXJ2aWNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZW1haWwnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3Zlcm1haWxcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiAnQ29uZmlndXJhciBjb3JyZW8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1lbnZlbG9wZS1vIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBmdWxsVXJsQmFzZSArIFwiaW1hZ2VzL2F1dG9tYXRpYy9jb3JyZW9hLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnaXRlbS1wcmltYXJ5LWludmVydGVkLW5vLWhvdmVyIHNtYWxsLXRleHQgdGV4dC1jZW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdPcGVyYWRvcmVzJyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtZW52ZWxvcGUtb1wiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdzbWFsbC10ZXh0ICB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1RpZW1wbycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdvcGVyYXRvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAndGltZScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJ0aW1lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiAnT3BlcmFkb3IgcG9yIHRpZW1wbycsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtY2xvY2stbyBmYS0yeFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlOiBmdWxsVXJsQmFzZSArIFwiaW1hZ2VzL2F1dG9tYXRpYy90aWVtcG9hLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdzbWFsbC10ZXh0ICB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0FjY2lvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdvcGVyYXRvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnYWN0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJhY3Rpb25cIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZXBvcG92ZXI6ICdPcGVyYWRvciBwb3IgYWNjaW9uJyxcclxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1jb2dzIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGZ1bGxVcmxCYXNlICsgXCJpbWFnZXMvYXV0b21hdGljL2FjY2lvbi0wMS5qcGdcIlxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnc21hbGwtdGV4dCAgdGV4dC1jZW50ZXIgY3Vyc29yLXBvaW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdDbGlja3MnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoZW1lOiAnb3BlcmF0b3InLFxyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2NsaWNrcycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJjbGlja1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlcG9wb3ZlcjogJ09wZXJhZG9yIHBvciBjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtbGluayBmYS0yeFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlOiBmdWxsVXJsQmFzZSArIFwiaW1hZ2VzL2F1dG9tYXRpYy9jbGljay0wMS5qcGdcIlxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgcmVzdFNlcnZpY2VzLnZhbGlkYXRlU2VydmljZSgkc2NvcGUuY2hhcnRWaWV3TW9kZWwuZGF0YSwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZXMgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdpdGVtLXN1Y2Nlc3MtaW52ZXJ0ZWQtbm8taG92ZXIgc21hbGwtdGV4dCB0ZXh0LWNlbnRlciAgdGV4dC1jZW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1NlcnZpY2lvJyxcclxuICAgICAgICAgICAgICAgICAgICAgIGljb246IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzOiBcImZhIGZhLWVudmVsb3BlLW9cIlxyXG4gICAgICAgICAgICAgICAgICAgIH1dO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdpdGVtLXByaW1hcnktaW52ZXJ0ZWQtbm8taG92ZXIgc21hbGwtdGV4dCB0ZXh0LWNlbnRlciAgdGV4dC1jZW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdPcGVyYWRvcmVzJyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtZW52ZWxvcGUtb1wiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdzbWFsbC10ZXh0ICB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1RpZW1wbycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdvcGVyYXRvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAndGltZScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJ0aW1lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVwb3BvdmVyOiAnT3BlcmFkb3IgcG9yIHRpZW1wbycsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtY2xvY2stbyBmYS0yeFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlOiBmdWxsVXJsQmFzZSArIFwiaW1hZ2VzL2F1dG9tYXRpYy90aWVtcG9hLTAxLmpwZ1wiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdzbWFsbC10ZXh0ICB0ZXh0LWNlbnRlciBjdXJzb3ItcG9pbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0FjY2lvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdvcGVyYXRvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnYWN0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJhY3Rpb25cIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZXBvcG92ZXI6ICdPcGVyYWRvciBwb3IgYWNjaW9uJyxcclxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzczogXCJmYSBmYS1jb2dzIGZhLTJ4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGZ1bGxVcmxCYXNlICsgXCJpbWFnZXMvYXV0b21hdGljL2FjY2lvbi0wMS5qcGdcIlxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnc21hbGwtdGV4dCAgdGV4dC1jZW50ZXIgY3Vyc29yLXBvaW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdDbGlja3MnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoZW1lOiAnb3BlcmF0b3InLFxyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2NsaWNrcycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJjbGlja1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlcG9wb3ZlcjogJ09wZXJhZG9yIHBvciBjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3M6IFwiZmEgZmEtbGluayBmYS0yeFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlOiBmdWxsVXJsQmFzZSArIFwiaW1hZ2VzL2F1dG9tYXRpYy9jbGljay0wMS5qcGdcIlxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmdldElkTWF4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkTWF4ID0gMDtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLmNoYXJ0Vmlld01vZGVsLm5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBpZE5vZGUgPSAkc2NvcGUuY2hhcnRWaWV3TW9kZWwubm9kZXNbaV0uZ2V0SWQoKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKGlkTm9kZSA+IGlkTWF4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWRNYXggPSBpZE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpZE1heDtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8qICAgICAgICAkc2NvcGUuZGlzYWJsZWRJdGVtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICB2YXIgdGhlbWVQcmUgPSAkc2NvcGUuY2hhcnRWaWV3TW9kZWwubm9kZXNbJHNjb3BlLmNoYXJ0Vmlld01vZGVsLm5vZGVzLmxlbmd0aCAtIDFdLmdldFRoZW1lKCk7XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgIGlmICh0aGVtZVByZSA9PSBcInNlcnZpY2VcIikge1xyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHJvb3RTY29wZS5pdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaXRlbXNbaV0udGhlbWUgPT0gXCJzZXJ2aWNlXCIpIHtcclxuICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pdGVtc1tpXS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXRlbXNbaV0uY2xhc3MgKz0gXCIgZGlzYWJsZWQgdGV4dC1jZW50ZXIgY3Vyc29yLXBvaW50ZXJcIjtcclxuICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgIH0gZWxzZSBpZiAoJHJvb3RTY29wZS5pdGVtc1tpXS50aGVtZSA9PSBcIm9wZXJhdG9yXCIpIHtcclxuICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pdGVtc1tpXS5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLml0ZW1zW2ldLmNsYXNzID0gXCJzbWFsbC10ZXh0IHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyXCI7XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHJvb3RTY29wZS5pdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaXRlbXNbaV0udGhlbWUgPT0gXCJvcGVyYXRvclwiKSB7XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXRlbXNbaV0uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLml0ZW1zW2ldLmNsYXNzICs9IFwiIGRpc2FibGVkIHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyXCI7XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRyb290U2NvcGUuaXRlbXNbaV0udGhlbWUgPT0gXCJzZXJ2aWNlXCIpIHtcclxuICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pdGVtc1tpXS5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLml0ZW1zW2ldLmNsYXNzID0gXCJzbWFsbC10ZXh0IHRleHQtY2VudGVyIGN1cnNvci1wb2ludGVyXCI7XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgJHNjb3BlLml0ZW1zID0gW3tjbGFzczogJ2l0ZW0tc3VjY2Vzcy1pbnZlcnRlZC1uby1ob3ZlciBzbWFsbC10ZXh0JywgbmFtZTogJ1NlcnZpY2lvJ30sXHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgIHtjbGFzczogJ3NtYWxsLXRleHQnLCBuYW1lOiAnU21zJywgdGhlbWU6ICdzZXJ2aWNlJywgbWV0aG9kOiAnc21zJywgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJzbXNcIiwgdGl0bGVwb3BvdmVyOiAnQ29uZmlndXJhciBzbXMnLCBkaXNhYmxlOiBmYWxzZX0sXHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgIHtjbGFzczogJ3NtYWxsLXRleHQnLCBuYW1lOiAnTWFpbCcsIHRoZW1lOiAnc2VydmljZScsIG1ldGhvZDogJ2VtYWlsJywgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJtYWlsXCIsIHRpdGxlcG9wb3ZlcjogJ0NvbmZpZ3VyYXIgY29ycmVvJywgZGlzYWJsZTogZmFsc2V9LFxyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICB7Y2xhc3M6ICdpdGVtLXByaW1hcnktaW52ZXJ0ZWQtbm8taG92ZXIgc21hbGwtdGV4dCcsIG5hbWU6ICdPcGVyYWRvcmVzJ30sXHJcbiAgICAgICAgICAgICAgIC8vICAgICAgICAgIHtjbGFzczogJ3NtYWxsLXRleHQgZGlzYWJsZWQnLCBuYW1lOiAnVGllbXBvJywgdGhlbWU6ICdvcGVyYXRvcicsIG1ldGhvZDogJ3RpbWUnLCB0ZW1wbGF0ZXBvcG92ZXI6IGZ1bGxVcmxCYXNlICsgXCJmbG93Y2hhcnQvcG9wb3ZlcnRpbWVcIiwgdGl0bGVwb3BvdmVyOiAnT3BlcmFkb3IgcG9yIHRpZW1wbycsIGRpc2FibGU6IHRydWV9LFxyXG4gICAgICAgICAgICAgICAvLyAgICAgICAgICB7Y2xhc3M6ICdzbWFsbC10ZXh0IGRpc2FibGVkJywgbmFtZTogJ0FjY2lvbicsIHRoZW1lOiAnb3BlcmF0b3InLCBtZXRob2Q6ICdhY3Rpb25zJywgdGVtcGxhdGVwb3BvdmVyOiBmdWxsVXJsQmFzZSArIFwiZmxvd2NoYXJ0L3BvcG92ZXJhY3Rpb25cIiwgdGl0bGVwb3BvdmVyOiAnT3BlcmFkb3IgcG9yIGFjY2lvbicsIGRpc2FibGU6IHRydWV9XTsqL1xyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUuZ2V0YWxsY2F0ZWdvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXN0U2VydmljZXMuZ2V0YWxsY2F0ZWdvcnkoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5saXN0Q2F0ZWdvcnkgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXN0U2VydmljZXMuZ2V0R210KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubGlzdFpvbmFIb3JhcmlhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAkc2NvcGUuZ2V0YWxsY2F0ZWdvcnkoKTtcclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmFkZE5ld05vZGUgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtLm1ldGhvZCA9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlRGF0YU1vZGVsID0ge1xyXG4gICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgIGlkOiAkc2NvcGUuZ2V0SWRNYXgoKSArIDEsXHJcbiAgICAgICAgICAgICAgICAgIHg6IDEwLFxyXG4gICAgICAgICAgICAgICAgICB5OiA1MCxcclxuICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCxcclxuICAgICAgICAgICAgICAgICAgdGhlbWU6IGl0ZW0udGhlbWUsXHJcbiAgICAgICAgICAgICAgICAgIG1ldGhvZDogaXRlbS5tZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgIGltYWdlOiBpdGVtLmltYWdlLFxyXG4gICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXBvcG92ZXI6IGl0ZW0udGVtcGxhdGVwb3BvdmVyLFxyXG4gICAgICAgICAgICAgICAgICB0aXRsZXBvcG92ZXI6IGl0ZW0udGl0bGV0ZW1wbGF0ZSxcclxuICAgICAgICAgICAgICAgICAgaW5wdXRDb25uZWN0b3JzOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgICBvdXRwdXRDb25uZWN0b3JzOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgICBzZW5kRGF0YToge31cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5tZXRob2QgPT0gXCJhY3Rpb25zXCIgfHwgaXRlbS5tZXRob2QgPT0gXCJjbGlja3NcIiB8fCBpdGVtLm1ldGhvZCA9PSBcImxpbmtzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgbmV3Tm9kZURhdGFNb2RlbC5vdXRwdXRDb25uZWN0b3JzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiXCJcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhcnRWaWV3TW9kZWwuYWRkTm9kZShuZXdOb2RlRGF0YU1vZGVsKTtcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICRzY29wZS51cGRhdGVBdXRvbWF0aWNDYW1wYWlnbiA9IGZ1bmN0aW9uIChvcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy52YWxpZGF0ZUpzb25BdXRvbWF0aWNDYW1wYWlnbigkc2NvcGUuY2hhcnRWaWV3TW9kZWwuZGF0YSwgJHNjb3BlLnNlcnZpY2VzKS50aGVuKGZ1bmN0aW9uIChvYmpEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5vcHRpb25DcmVhdGUgPSBvcHRpb247XHJcbiAgICAgICAgICAgICAgICAgIGlmIChvcHRpb24gPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy51cGRhdGVBdXRvbWF0aWNDYW1wYWlnbkNvbmZpZ3VyYXRpb24oJHNjb3BlLmNoYXJ0Vmlld01vZGVsLmRhdGEsICRzY29wZS5pZGF1dG9tYXRpY2NhbXBhaWduKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLnByaW1hcnkoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICQoJyN1cGRhdGVBdXRvbWF0aWNDYW1wYWlnbicpLnJlbW92ZUNsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN0U2VydmljZXMudmFsaWRhdGVGb3JtQ2FtcGFpZ24oJHNjb3BlLmZvcm1DYW1wYWlnbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdmFyIG9ialNlbmQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1DYW1wYWlnbjogZGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqQ2FtcGFpZ246ICRzY29wZS5jaGFydFZpZXdNb2RlbC5kYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgcmVzdFNlcnZpY2VzLnVwZGF0ZUF1dG9tYXRpY0NhbXBhaWduQWxsKG9ialNlbmQsICRzY29wZS5pZGF1dG9tYXRpY2NhbXBhaWduKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UucHJpbWFyeShkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2luZGV4Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlTW9kYWxVcGRhdGVDYW1wYWlnbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS51cHRDYW1wYWlnbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5mb3JtQ2FtcGFpZ24uc3RhcnREYXRlID0gYW5ndWxhci5jb3B5KCRzY29wZS5kYXRlR210U3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZvcm1DYW1wYWlnbi5lbmREYXRlID0gYW5ndWxhci5jb3B5KCRzY29wZS5kYXRlR210RW5kKTtcclxuICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy52YWxpZGF0ZUZvcm1DYW1wYWlnbigkc2NvcGUuZm9ybUNhbXBhaWduKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy51cGRhdGVBdXRvbWF0aWNDYW1wYWlnbihkYXRhLCAkc2NvcGUuaWRhdXRvbWF0aWNjYW1wYWlnbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vbm90aWZpY2F0aW9uU2VydmljZS5wcmltYXJ5KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZUF1dG9tYXRpY0NhbXBhaWduKDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vJCgnI3VwZGF0ZUF1dG9tYXRpY0NhbXBhaWduJykucmVtb3ZlQ2xhc3MoJ2RpYWxvZy0tb3BlbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaW5kZXgnKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS5pbml0VGV4dEdtdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93VGV4dEdtdFN0YXJ0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93VGV4dEdtdEVuZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB2YXIgU3RhcnRVbml4ID0gbW9tZW50KCQoXCIjZGF0ZXN0YXJ0Q2FtcGFpZ25cIikudmFsKCkpLnV0YygpLnZhbHVlT2YoKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRlR210U3RhcnQgPSBtb21lbnQoU3RhcnRVbml4KS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKTtcclxuICAgICAgICAgICAgICAgIHZhciBFbmRVbml4ID0gbW9tZW50KCQoXCIjZGF0ZWVuZENhbXBhaWduXCIpLnZhbCgpKS51dGMoKS52YWx1ZU9mKCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0ZUdtdEVuZCA9IG1vbWVudChFbmRVbml4KS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS5hcHBseVRleHRHbXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJChcIiNkYXRlc3RhcnRDYW1wYWlnblwiKS52YWwoKSAhPSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1RleHRHbXRTdGFydCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1RleHRHbXRTdGFydCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUudGV4dEdtdFN0YXJ0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoJChcIiNkYXRlZW5kQ2FtcGFpZ25cIikudmFsKCkgIT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dUZXh0R210RW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93VGV4dEdtdEVuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUudGV4dEdtdEVuZCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zaG93VGV4dEdtdFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBTdGFydFVuaXggPSBtb21lbnQoJChcIiNkYXRlc3RhcnRDYW1wYWlnblwiKS52YWwoKSkudmFsdWVPZigpO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0ZUdtdFN0YXJ0ID0gbW9tZW50KFN0YXJ0VW5peCkudXRjT2Zmc2V0KCRzY29wZS5mb3JtQ2FtcGFpZ24uZ210KS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc2hvd1RleHRHbXRFbmQpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIEVuZFVuaXggPSBtb21lbnQoJChcIiNkYXRlZW5kQ2FtcGFpZ25cIikudmFsKCkpLnZhbHVlT2YoKTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGVHbXRFbmQgPSBtb21lbnQoRW5kVW5peCkudXRjT2Zmc2V0KCRzY29wZS5mb3JtQ2FtcGFpZ24uZ210KS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUub3BlTW9kYWxVcGRhdGVDYW1wYWlnbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQoJyN1cGRhdGVBdXRvbWF0aWNDYW1wYWlnbicpLmFkZENsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XSlcclxuICAgICAgICAgIC5jb250cm9sbGVyKCdsaXN0Q29udHJvbGxlcicsIFsnJHNjb3BlJywgJ3Jlc3RTZXJ2aWNlcycsICckcScsICckaW50ZXJ2YWwnLCBmdW5jdGlvbiAoJHNjb3BlLCByZXN0U2VydmljZXMsICRxLCAkaW50ZXJ2YWwpIHtcclxuICAgICAgICAgICAgICAkc2NvcGUuaW5pdGlhbCA9IDA7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAxO1xyXG4gICAgICAgICAgICAgICRzY29wZS5maWx0ZXIgPSB7fTtcclxuICAgICAgICAgICAgICAkc2NvcGUubGlzdEF1dG9tYXRpY0NhbXBhaWduID0ge307XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmZvcndhcmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5pdGlhbCArPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgKz0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5saXN0YXV0b2NhbXAoKTtcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICRzY29wZS5mYXN0Zm9yd2FyZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5pbml0aWFsID0gKCRzY29wZS5saXN0QXV0b21hdGljQ2FtcGFpZ24udG90YWxfcGFnZXMgLSAxKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gJHNjb3BlLmxpc3RBdXRvbWF0aWNDYW1wYWlnbi50b3RhbF9wYWdlcztcclxuICAgICAgICAgICAgICAgICRzY29wZS5saXN0YXV0b2NhbXAoKTtcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICRzY29wZS5iYWNrd2FyZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5pbml0aWFsIC09IDE7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSAtPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RhdXRvY2FtcCgpO1xyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmZhc3RiYWNrd2FyZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5pbml0aWFsID0gMDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5saXN0YXV0b2NhbXAoKTtcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICRzY29wZS5saXN0YXV0b2NhbXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RBdXRvbWF0aWNDYW1wYWlnbi5pdGVtcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgcmVzdFNlcnZpY2VzLmxpc3RjYW1wYWlnbigkc2NvcGUuaW5pdGlhbCwgJHNjb3BlLmZpbHRlcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubGlzdEF1dG9tYXRpY0NhbXBhaWduID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUubGlzdEF1dG9tYXRpY0NhbXBhaWduLml0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpZ3VyYXRpb24gPSAkc2NvcGUubGlzdEF1dG9tYXRpY0NhbXBhaWduLml0ZW1zW2ldLmNvbmZpZ3VyYXRpb24uY29uZmlndXJhdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjb25maWd1cmF0aW9uKSB8fCBjb25maWd1cmF0aW9uID09ICdudWxsJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vYmpDb25maWd1cmF0aW9uKGNvbmZpZ3VyYXRpb24sICRzY29wZS5saXN0QXV0b21hdGljQ2FtcGFpZ24uaXRlbXNbaV0uaWRBdXRvbWF0aWNDYW1wYWlnbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RDb25maWd1cmF0aW9uID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICB2YXIgc3RhdHVzVmVyaWZ5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy5saXN0Y2FtcGFpZ24oJHNjb3BlLmluaXRpYWwsIGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgIGRhdGEuaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmxpc3RBdXRvbWF0aWNDYW1wYWlnbi5pdGVtc1tpbmRleF0uc3RhdHVzICE9IGl0ZW0uc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGlzdEF1dG9tYXRpY0NhbXBhaWduLml0ZW1zW2luZGV4XS5zdGF0dXMgPSBpdGVtLnN0YXR1cztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAvLyRzY29wZS5tYWlsID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS5vcGVuTW9kYWwgPSBmdW5jdGlvbiAoaWRBdXRvbWF0aWNDYW1wYWlnbikge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmlkQXV0Q2FtcGFpZ24gPSBpZEF1dG9tYXRpY0NhbXBhaWduO1xyXG4gICAgICAgICAgICAgICAgJCgnI2NhbmNlbERpYWxvZycpLmFkZENsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUuY2xvc2VNb2RhbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQoJyNjYW5jZWxEaWFsb2cnKS5yZW1vdmVDbGFzcygnZGlhbG9nLS1vcGVuJyk7XHJcbiAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmNhbmNlbENhbXBhaWduID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdFNlcnZpY2VzLmNhbmNlbEF1dG9tYXRpY0NhbXBhaWduKCRzY29wZS5pZEF1dENhbXBhaWduKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgc2xpZGVPblRvcChyZXMubWVzc2FnZSwgMzAwMCwgJ2dseXBoaWNvbiBnbHlwaGljb24tcmVtb3ZlLWNpcmNsZScsICdpbmZvJyk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5saXN0YXV0b2NhbXAoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsb3NlTW9kYWwoKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICRpbnRlcnZhbChzdGF0dXNWZXJpZnksIDYwMDAwKTtcclxuICAgICAgICAgICAgICAkc2NvcGUuY291bnRDb250YWN0cyA9IGZ1bmN0aW9uICh0eXBlLCBpZEF1dG9tYXRpY0NhbXBhaWduLCBsaXN0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgIHNlZ21lbnQ6IGxpc3RhLFxyXG4gICAgICAgICAgICAgICAgICBjb250YWN0bGlzdDogbGlzdGFcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICByZXN0U2VydmljZXMuY291bnRDb250YWN0KGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAkc2NvcGUubGlzdEF1dG9tYXRpY0NhbXBhaWduLml0ZW1zLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KCRzY29wZS5saXN0QXV0b21hdGljQ2FtcGFpZ24uaXRlbXNbal0uaWRBdXRvbWF0aWNDYW1wYWlnbikgPT0gcGFyc2VJbnQoaWRBdXRvbWF0aWNDYW1wYWlnbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5saXN0QXV0b21hdGljQ2FtcGFpZ24uaXRlbXNbal0ucXVhbnRpdHl0YXJnZXQgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAkc2NvcGUub2JqQ29uZmlndXJhdGlvbiA9IGZ1bmN0aW9uIChDb25maWd1cmF0aW9uLCBpZEF1dG9tYXRpY0NhbXBhaWduKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG9iakNvbmZpZ3VyYXRpb24gPSBKU09OLnBhcnNlKENvbmZpZ3VyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyclJldHVybiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmpDb25maWd1cmF0aW9uLm5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBub2RlID0gb2JqQ29uZmlndXJhdGlvbi5ub2Rlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChub2RlLm1ldGhvZCA9PSBcInByaW1hcnlcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IG5vZGUuc2VuZERhdGEubGlzdC5uYW1lICsgXCIgOiBcIjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBub2RlLnNlbmREYXRhLnNlbGVjdGVkcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuc2VuZERhdGEubGlzdC5pZCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSBcImNvbnRhY3RsaXN0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jb3VudENvbnRhY3RzKHR5cGUsIGlkQXV0b21hdGljQ2FtcGFpZ24sIG5vZGUuc2VuZERhdGEuc2VsZWN0ZWRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IG5vZGUuc2VuZERhdGEuc2VsZWN0ZWRzW2pdLm5hbWUgKyBcIihcIiArIG5vZGUuc2VuZERhdGEuc2VsZWN0ZWRzW2pdLmlkQ29udGFjdGxpc3QgKyBcIiksXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gXCJzZWdtZW50XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jb3VudENvbnRhY3RzKHR5cGUsIGlkQXV0b21hdGljQ2FtcGFpZ24sIG5vZGUuc2VuZERhdGEuc2VsZWN0ZWRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IG5vZGUuc2VuZERhdGEuc2VsZWN0ZWRzW2pdLm5hbWUgKyBcIihcIiArIG5vZGUuc2VuZERhdGEuc2VsZWN0ZWRzW2pdLmlkU2VnbWVudCArIFwiKSxcIjtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IHN0ci5zdWJzdHJpbmcoMCwgc3RyLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFyclJldHVybi5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHN0cixcclxuICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogbm9kZS5tZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICBtZXRob2RBbGlhczogXCJEZXN0aW5hdGFyaW9zXCJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICBpZiAobm9kZS5tZXRob2QgPT0gXCJzbXNcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IFwiTGEgcGxhbnRpbGxhIGRlIHNtcyA6IFwiICsgbm9kZS5zZW5kRGF0YS5zbXN0ZW1wbGF0ZS5uYW1lICsgXCIgY29uIGxhIGNhdGVnb3JpYTogXCIgKyBub2RlLnNlbmREYXRhLnNtc2NhdGVnb3J5Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyUmV0dXJuLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgc3RlcDogaSxcclxuICAgICAgICAgICAgICAgICAgICAgIGRldGFpbDogc3RyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBub2RlLm1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZEFsaWFzOiBcIlNtc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubWV0aG9kID09IFwiZW1haWxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IFwiUGxhbnRpbGxhIGRlIGNvcnJlbyA6IFwiICsgbm9kZS5zZW5kRGF0YS5tYWlsdGVtcGxhdGUubmFtZSArIFwiIGNvbiBsYSBjYXRlZ29yaWE6IFwiICsgbm9kZS5zZW5kRGF0YS5tYWlsY2F0ZWdvcnkubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICBhcnJSZXR1cm4ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICBzdGVwOiBpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBzdHIsXHJcbiAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IG5vZGUubWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgbWV0aG9kQWxpYXM6IFwiQ29ycmVvXCJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICBpZiAobm9kZS5tZXRob2QgPT0gXCJ0aW1lXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHIgPSBub2RlLnNlbmREYXRhLnRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyUmV0dXJuLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgc3RlcDogaSxcclxuICAgICAgICAgICAgICAgICAgICAgIGRldGFpbDogc3RyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBub2RlLm1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZEFsaWFzOiBcIlRpZW1wb1wiXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubWV0aG9kID09IFwiYWN0aW9uc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gbm9kZS5zZW5kRGF0YS50ZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIGFyclJldHVybi5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHN0cixcclxuICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogbm9kZS5tZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICBtZXRob2RBbGlhczogXCJBY2Npw7NuXCJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAkc2NvcGUubGlzdEF1dG9tYXRpY0NhbXBhaWduLml0ZW1zLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludCgkc2NvcGUubGlzdEF1dG9tYXRpY0NhbXBhaWduLml0ZW1zW2pdLmlkQXV0b21hdGljQ2FtcGFpZ24pID09IHBhcnNlSW50KGlkQXV0b21hdGljQ2FtcGFpZ24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RBdXRvbWF0aWNDYW1wYWlnbi5pdGVtc1tqXS5saXN0Q29uZmlndXJhdGlvbiA9IGFyclJldHVybjtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShhcnJSZXR1cm4pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RhdXRvY2FtcCgpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLnNlYXJjaGNhdGVnb3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RhdXRvY2FtcCgpO1xyXG4gICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS5nZXRDYXRlZ29yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJlc3RTZXJ2aWNlcy5nZXRhbGxjYXRlZ29yeSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmF1dG9tYUNhdGVnb3J5ID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgnW2ZpbHRlci5kYXRlaW5pdGlhbCxmaWx0ZXIuZGF0ZWVuZF0nLCBmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAgICAgICAgICBpZigoYW5ndWxhci5pc0RlZmluZWQoJHNjb3BlLmZpbHRlci5kYXRlaW5pdGlhbCkgJiYgJHNjb3BlLmZpbHRlci5kYXRlaW5pdGlhbCAhPSBcIlwiKSAmJiAoYW5ndWxhci5pc0RlZmluZWQoJHNjb3BlLmZpbHRlci5kYXRlZW5kKSAmJiAkc2NvcGUuZmlsdGVyLmRhdGVlbmQgIT0gXCJcIikpe1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RhdXRvY2FtcCgpO1xyXG4vLyAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUubGlzdGF1dG9jYW1wKCk7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmdldENhdGVnb3J5KCk7XHJcbiAgICAgICAgICAgIH1dKVxyXG4gICAgICAgICAgLmNvbnRyb2xsZXIoJ3ZpZXdzY2hlbWVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHN0YXRlUGFyYW1zJywgJ3Jlc3RTZXJ2aWNlcycsICckcScsICckaW50ZXJ2YWwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsIHJlc3RTZXJ2aWNlcywgJHEsICRpbnRlcnZhbCkge1xyXG4gICAgICAgICAgICAgICRzY29wZS5pZGF1dG9tYXRpY2NhbXBhaWduID0gJHN0YXRlUGFyYW1zLmlkYXV0b21hdGljY2FtcGFpZ247XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmdldGF1dG9tYXRpY2NhbXBhaWduID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdFNlcnZpY2VzLmdldFNjaGVtZSgkc2NvcGUuaWRhdXRvbWF0aWNjYW1wYWlnbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuY2FtcGFpZ24gPSBkYXRhLmRhdGEuY2FtcGFpZ247XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRGb3JtQ2FtcGFpbmcoZGF0YS5kYXRhLmNvbmZpZ3VyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZGF0YS5jb25maWd1cmF0aW9uID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2luZGV4Jyk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbXBhaWduID0gZGF0YS5kYXRhLmNhbXBhaWduO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JDYW1wYWlnbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5tc2dFcnJvckNhbXBhaWduID0gZGF0YS5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc2V0Rm9ybUNhbXBhaW5nKGRhdGEuZGF0YS5jb25maWd1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgJHNjb3BlLmdldGF1dG9tYXRpY2NhbXBhaWduKCk7XHJcblxyXG4gICAgICAgICAgICAgICRzY29wZS5zZXRGb3JtQ2FtcGFpbmcgPSBmdW5jdGlvbiAoY29uZmlndXJhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZvcm1DYW1wYWlnbiA9IGFuZ3VsYXIuY29weSgkc2NvcGUuY2FtcGFpZ24pO1xyXG4gICAgICAgICAgICAgICAgJChcIiNkYXRlc3RhcnRDYW1wYWlnblwiKS52YWwoJHNjb3BlLmNhbXBhaWduLnN0YXJ0RGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI2RhdGVlbmRDYW1wYWlnblwiKS52YWwoJHNjb3BlLmNhbXBhaWduLmVuZERhdGUpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYXJ0Vmlld01vZGVsID0gbmV3IGZsb3djaGFydC5DaGFydFZpZXdNb2RlbChjb25maWd1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wbGV0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1dKTtcclxufSkoKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9qcy9hbmd1bGFyL2F1dG9tYXRpY2NhbXBhaWduL2NvbnRyb2xsZXJzLmpzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/***/ (function(module, exports) {

eval("(function () {\r\n  angular.module('automaticcampaign.services', [])\r\n\r\n          .service('restServices', ['$http', '$q', 'notificationService', 'moment', function ($http, $q, notificationService, moment) {\r\n\r\n              this.createAutomaticCampaign = function (data) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/save\";\r\n                $http.post(url, data)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.cancelAutomaticCampaign = function (data) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/cancelautomaticcampaign\";\r\n                $http.post(url, data)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.getservices = function () {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/saxs/getall\";\r\n                $http.get(url)\r\n                        .success(function (data) {\r\n                          if (data.length == 0) {\r\n                            notificationService.error(\"No tienes servicios disponibles, para adquirir uno por favor contacta a soporte.\");\r\n                            defer.reject(data);\r\n                          }\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.getallcategory = function () {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacampcateg/allcategory\";\r\n                $http.get(url)\r\n                        .success(function (data) {\r\n                          if (data.length == 0) {\r\n                            //notificationService.error(\"No se encontraron categorias para la campaña.\");\r\n                            defer.reject(data);\r\n                          }\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.getGmt = function () {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"mail/timezone/\";\r\n                $http.get(url)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.editAutomaticCampaign = function (idAutomaticCampaign) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/getautomaticcampaign/\" + idAutomaticCampaign;\r\n                $http.get(url)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.updateAutomaticCampaignAll = function (data, idAutomaticCampaign) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/updatecampaignall/\" + idAutomaticCampaign;\r\n                $http.put(url, data)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.updateAutomaticCampaign = function (data, idAutomaticCampaign) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/updatecampaign/\" + idAutomaticCampaign;\r\n                $http.put(url, data)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.updateAutomaticCampaignConfiguration = function (data, idAutomaticCampaign) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/updatecampaignconfiguration/\" + idAutomaticCampaign;\r\n                $http.put(url, data)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.createAutomaticCampaignDraft = function (data) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/savedraft\";\r\n                $http.post(url, data)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.updateStatusCampaign = function (data) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/updatestatus/\" + data;\r\n                var objSend = {status: 'draft'};\r\n                $http.put(url, objSend)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n\r\n              this.listcampaign = function (page, data) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/list/\" + page;\r\n                $http.post(url, data)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                        });\r\n                return defer.promise;\r\n              }  \r\n\r\n              this.validateJsonAutomaticCampaign = function (chartViewModel, services) {\r\n                var defer = $q.defer();\r\n                if (chartViewModel.connections <= 0) {\r\n                  notificationService.error(\"No se encontro ninguna conexion en la campaña.\");\r\n                  defer.reject();\r\n                }\r\n                if (chartViewModel.nodes.length < 3) {\r\n                  notificationService.error(\"El numero de nodos debe ser mayor a 3.\");\r\n                  defer.reject();\r\n                }\r\n                if (chartViewModel.nodes.length > 61) {\r\n                  notificationService.error(\"El numero de nodos debe ser mayor a 60.\");\r\n                  defer.reject();\r\n                }\r\n//          if (chartViewModel.nodes[chartViewModel.nodes.length - 1].theme == \"operator\") {\r\n//            notificationService.error(\"La campaña no puede terminar en un nodo operador.\");\r\n//            defer.reject();\r\n//          }\r\n                if ((chartViewModel.nodes.length - 1) != chartViewModel.connections.length) {\r\n                  notificationService.error(\"las conexiones no coinciden con los nodos, por favor revisar.\");\r\n                  defer.reject();\r\n                }\r\n                for (var i = 0; i < chartViewModel.nodes.length; i++) {\r\n                  if (jQuery.isEmptyObject(chartViewModel.nodes[i].sendData) || chartViewModel.nodes[i].sendData.textTitle == \"\") {\r\n                    notificationService.error(\"Ningun nodo debe estar vacio, por favor revisar.\");\r\n                    defer.reject();\r\n                  }\r\n                }\r\n                for (var i = 0; i < chartViewModel.connections.length; i++) {\r\n                  if (chartViewModel.connections[i].class == \"negation\") {\r\n                    if (jQuery.isEmptyObject(chartViewModel.connections[i].sendData)) {\r\n                      notificationService.error(\"Hay relaciones que no pueden estar vacias, por favor revisar.\");\r\n                      defer.reject();\r\n                    }\r\n                  }\r\n                }\r\n                this.validateService(chartViewModel, services).catch(function () {\r\n                  notificationService.error(\"Ningun nodo debe estar vacio, por favor revisar.\");\r\n                  defer.reject();\r\n                });\r\n\r\n                defer.resolve(true);\r\n                return defer.promise;\r\n              }\r\n\r\n              this.validateFormCampaign = function (formCampaign) {\r\n                var defer = $q.defer();\r\n                var startDate = moment(formCampaign.startDate).utc('-0500').add(30, 'minutes').format('YYYY-MM-DD HH:mm');\r\n                var now = moment().utc('-0500').format('YYYY-MM-DD HH:mm');\r\n                if (formCampaign.startDate == \"\" || formCampaign.startDate == null) {\r\n                  notificationService.error(\"El campo de fecha inicial es obligatorio.\");\r\n                  defer.reject();\r\n                }\r\n\r\n                if (formCampaign.gmt == \"\" || formCampaign.gmt == null) {\r\n                  notificationService.error(\"El campo de gmt es obligatorio.\");\r\n                  defer.reject();\r\n                }\r\n                if (startDate < now) {\r\n                  notificationService.error(\"La fecha inicial no debe ser menor a la fecha actual\");\r\n                  defer.reject();\r\n                }\r\n                if (formCampaign.campaignCategory == \"\" || typeof formCampaign.campaignCategory == \"undefined\" || formCampaign.campaignCategory == null) {\r\n                  notificationService.error(\"El campo de categoria de campaña es obligatorio.\");\r\n                  defer.reject();\r\n                }\r\n                if (formCampaign.descriptionCampaign == \"\" || typeof formCampaign.descriptionCampaign == \"undefined\" || formCampaign.descriptionCampaign == null) {\r\n                  formCampaign.descriptionCampaign = '';\r\n                }\r\n                if (formCampaign.nameCampaign == \"\" || typeof formCampaign.nameCampaign == \"undefined\" || typeof formCampaign.nameCampaign == null) {\r\n                  notificationService.error(\"El campo de nombre de campaña es obligatorio.\");\r\n                  defer.reject();\r\n                }\r\n\r\n\r\n                defer.resolve(formCampaign);\r\n                return defer.promise;\r\n              }\r\n\r\n              this.validateService = function (chartViewModel, services) {\r\n                var defer = $q.defer();\r\n                if (services.length == 0) {\r\n                  notificationService.error(\"La campaña tiene servicios que no estan habilitados, por favor contactar a soporte.\");\r\n                  defer.reject();\r\n                }\r\n                if (services.length < 2) {\r\n                  for (var i = 0; i < chartViewModel.nodes.length; i++) {\r\n                    if (chartViewModel.nodes[i].theme == \"service\") {\r\n                      if (services[0].service != chartViewModel.nodes[i].method) {\r\n                        notificationService.error(\"La campaña tiene servicios que no estan habilitados, por favor contactar a soporte.\");\r\n                        defer.reject();\r\n                      }\r\n                    }\r\n                  }\r\n                  defer.resolve();\r\n                } else {\r\n                  defer.resolve();\r\n                }\r\n                return defer.promise;\r\n              }\r\n\r\n              this.countContact = function (data) {\r\n                var deferred = $q.defer();\r\n                var url = fullUrlBase + 'api/sendmail/countcontact';\r\n                $http.post(url, data)\r\n                        .success(function (data) {\r\n                          deferred.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          deferred.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n\r\n                return deferred.promise;\r\n              }\r\n\r\n              this.getScheme = function (idAutomaticCampaign) {\r\n                var defer = $q.defer();\r\n                var url = fullUrlBase + \"api/automacamp/getscheme/\" + idAutomaticCampaign;\r\n                $http.get(url)\r\n                        .success(function (data) {\r\n                          defer.resolve(data);\r\n                        })\r\n                        .error(function (data) {\r\n                          defer.reject(data);\r\n                          notificationService.error(data.message);\r\n                        });\r\n                return defer.promise;\r\n              }\r\n            }])\r\n          .factory('notificationService', function () {\r\n            function error(message) {\r\n              slideOnTop(message, 4000, 'glyphicon glyphicon-remove-circle', 'danger');\r\n            }\r\n\r\n            function success(message) {\r\n              slideOnTop(message, 4000, 'glyphicon glyphicon-ok-circle', 'success');\r\n            }\r\n\r\n            function warning(message) {\r\n              slideOnTop(message, 4000, 'glyphicon glyphicon-exclamation-sign', 'warning');\r\n            }\r\n\r\n            function notice(message) {\r\n              slideOnTop(message, 4000, 'glyphicon glyphicon-exclamation-sign', 'notice');\r\n            }\r\n\r\n            function primary(message) {\r\n              slideOnTop(message, 4000, 'glyphicon glyphicon-exclamation-sign', 'primary');\r\n            }\r\n\r\n            return {\r\n              error: error,\r\n              success: success,\r\n              warning: warning,\r\n              notice: notice,\r\n              primary: primary\r\n            };\r\n          })\r\n          .factory('setData', function () {\r\n            var obj = {};\r\n            var data = {};\r\n\r\n            obj.getData = function () {\r\n              return data;\r\n            }\r\n\r\n            obj.setData = function (objData) {\r\n              data = objData;\r\n            }\r\n\r\n            return obj;\r\n          })\r\n})();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9hbmd1bGFyL2F1dG9tYXRpY2NhbXBhaWduL3NlcnZpY2VzLmpzP2I1ZjAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQSxlOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGlDQUFpQztBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHVDQUF1QztBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjs7QUFFakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxpQ0FBaUM7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCOztBQUV6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXO0FBQ1gsQ0FBQyIsImZpbGUiOiIzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcclxuICBhbmd1bGFyLm1vZHVsZSgnYXV0b21hdGljY2FtcGFpZ24uc2VydmljZXMnLCBbXSlcclxuXHJcbiAgICAgICAgICAuc2VydmljZSgncmVzdFNlcnZpY2VzJywgWyckaHR0cCcsICckcScsICdub3RpZmljYXRpb25TZXJ2aWNlJywgJ21vbWVudCcsIGZ1bmN0aW9uICgkaHR0cCwgJHEsIG5vdGlmaWNhdGlvblNlcnZpY2UsIG1vbWVudCkge1xyXG5cclxuICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUF1dG9tYXRpY0NhbXBhaWduID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyBcImFwaS9hdXRvbWFjYW1wL3NhdmVcIjtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QodXJsLCBkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICB0aGlzLmNhbmNlbEF1dG9tYXRpY0NhbXBhaWduID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyBcImFwaS9hdXRvbWFjYW1wL2NhbmNlbGF1dG9tYXRpY2NhbXBhaWduXCI7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KHVybCwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgdGhpcy5nZXRzZXJ2aWNlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyBcImFwaS9zYXhzL2dldGFsbFwiO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHVybClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihcIk5vIHRpZW5lcyBzZXJ2aWNpb3MgZGlzcG9uaWJsZXMsIHBhcmEgYWRxdWlyaXIgdW5vIHBvciBmYXZvciBjb250YWN0YSBhIHNvcG9ydGUuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgdGhpcy5nZXRhbGxjYXRlZ29yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyBcImFwaS9hdXRvbWFjYW1wY2F0ZWcvYWxsY2F0ZWdvcnlcIjtcclxuICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihcIk5vIHNlIGVuY29udHJhcm9uIGNhdGVnb3JpYXMgcGFyYSBsYSBjYW1wYcOxYS5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICB0aGlzLmdldEdtdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyBcIm1haWwvdGltZXpvbmUvXCI7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICB0aGlzLmVkaXRBdXRvbWF0aWNDYW1wYWlnbiA9IGZ1bmN0aW9uIChpZEF1dG9tYXRpY0NhbXBhaWduKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGZ1bGxVcmxCYXNlICsgXCJhcGkvYXV0b21hY2FtcC9nZXRhdXRvbWF0aWNjYW1wYWlnbi9cIiArIGlkQXV0b21hdGljQ2FtcGFpZ247XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUF1dG9tYXRpY0NhbXBhaWduQWxsID0gZnVuY3Rpb24gKGRhdGEsIGlkQXV0b21hdGljQ2FtcGFpZ24pIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyBcImFwaS9hdXRvbWFjYW1wL3VwZGF0ZWNhbXBhaWduYWxsL1wiICsgaWRBdXRvbWF0aWNDYW1wYWlnbjtcclxuICAgICAgICAgICAgICAgICRodHRwLnB1dCh1cmwsIGRhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIHRoaXMudXBkYXRlQXV0b21hdGljQ2FtcGFpZ24gPSBmdW5jdGlvbiAoZGF0YSwgaWRBdXRvbWF0aWNDYW1wYWlnbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBmdWxsVXJsQmFzZSArIFwiYXBpL2F1dG9tYWNhbXAvdXBkYXRlY2FtcGFpZ24vXCIgKyBpZEF1dG9tYXRpY0NhbXBhaWduO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAucHV0KHVybCwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgdGhpcy51cGRhdGVBdXRvbWF0aWNDYW1wYWlnbkNvbmZpZ3VyYXRpb24gPSBmdW5jdGlvbiAoZGF0YSwgaWRBdXRvbWF0aWNDYW1wYWlnbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBmdWxsVXJsQmFzZSArIFwiYXBpL2F1dG9tYWNhbXAvdXBkYXRlY2FtcGFpZ25jb25maWd1cmF0aW9uL1wiICsgaWRBdXRvbWF0aWNDYW1wYWlnbjtcclxuICAgICAgICAgICAgICAgICRodHRwLnB1dCh1cmwsIGRhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIHRoaXMuY3JlYXRlQXV0b21hdGljQ2FtcGFpZ25EcmFmdCA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGZ1bGxVcmxCYXNlICsgXCJhcGkvYXV0b21hY2FtcC9zYXZlZHJhZnRcIjtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QodXJsLCBkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0NhbXBhaWduID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyBcImFwaS9hdXRvbWFjYW1wL3VwZGF0ZXN0YXR1cy9cIiArIGRhdGE7XHJcbiAgICAgICAgICAgICAgICB2YXIgb2JqU2VuZCA9IHtzdGF0dXM6ICdkcmFmdCd9O1xyXG4gICAgICAgICAgICAgICAgJGh0dHAucHV0KHVybCwgb2JqU2VuZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgdGhpcy5saXN0Y2FtcGFpZ24gPSBmdW5jdGlvbiAocGFnZSwgZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBmdWxsVXJsQmFzZSArIFwiYXBpL2F1dG9tYWNhbXAvbGlzdC9cIiArIHBhZ2U7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KHVybCwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfSAgXHJcblxyXG4gICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVKc29uQXV0b21hdGljQ2FtcGFpZ24gPSBmdW5jdGlvbiAoY2hhcnRWaWV3TW9kZWwsIHNlcnZpY2VzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoYXJ0Vmlld01vZGVsLmNvbm5lY3Rpb25zIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihcIk5vIHNlIGVuY29udHJvIG5pbmd1bmEgY29uZXhpb24gZW4gbGEgY2FtcGHDsWEuXCIpO1xyXG4gICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjaGFydFZpZXdNb2RlbC5ub2Rlcy5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoXCJFbCBudW1lcm8gZGUgbm9kb3MgZGViZSBzZXIgbWF5b3IgYSAzLlwiKTtcclxuICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hhcnRWaWV3TW9kZWwubm9kZXMubGVuZ3RoID4gNjEpIHtcclxuICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihcIkVsIG51bWVybyBkZSBub2RvcyBkZWJlIHNlciBtYXlvciBhIDYwLlwiKTtcclxuICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgIGlmIChjaGFydFZpZXdNb2RlbC5ub2Rlc1tjaGFydFZpZXdNb2RlbC5ub2Rlcy5sZW5ndGggLSAxXS50aGVtZSA9PSBcIm9wZXJhdG9yXCIpIHtcclxuLy8gICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKFwiTGEgY2FtcGHDsWEgbm8gcHVlZGUgdGVybWluYXIgZW4gdW4gbm9kbyBvcGVyYWRvci5cIik7XHJcbi8vICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XHJcbi8vICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgoY2hhcnRWaWV3TW9kZWwubm9kZXMubGVuZ3RoIC0gMSkgIT0gY2hhcnRWaWV3TW9kZWwuY29ubmVjdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoXCJsYXMgY29uZXhpb25lcyBubyBjb2luY2lkZW4gY29uIGxvcyBub2RvcywgcG9yIGZhdm9yIHJldmlzYXIuXCIpO1xyXG4gICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhcnRWaWV3TW9kZWwubm9kZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKGpRdWVyeS5pc0VtcHR5T2JqZWN0KGNoYXJ0Vmlld01vZGVsLm5vZGVzW2ldLnNlbmREYXRhKSB8fCBjaGFydFZpZXdNb2RlbC5ub2Rlc1tpXS5zZW5kRGF0YS50ZXh0VGl0bGUgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoXCJOaW5ndW4gbm9kbyBkZWJlIGVzdGFyIHZhY2lvLCBwb3IgZmF2b3IgcmV2aXNhci5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhcnRWaWV3TW9kZWwuY29ubmVjdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKGNoYXJ0Vmlld01vZGVsLmNvbm5lY3Rpb25zW2ldLmNsYXNzID09IFwibmVnYXRpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChqUXVlcnkuaXNFbXB0eU9iamVjdChjaGFydFZpZXdNb2RlbC5jb25uZWN0aW9uc1tpXS5zZW5kRGF0YSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoXCJIYXkgcmVsYWNpb25lcyBxdWUgbm8gcHVlZGVuIGVzdGFyIHZhY2lhcywgcG9yIGZhdm9yIHJldmlzYXIuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlU2VydmljZShjaGFydFZpZXdNb2RlbCwgc2VydmljZXMpLmNhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihcIk5pbmd1biBub2RvIGRlYmUgZXN0YXIgdmFjaW8sIHBvciBmYXZvciByZXZpc2FyLlwiKTtcclxuICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlRm9ybUNhbXBhaWduID0gZnVuY3Rpb24gKGZvcm1DYW1wYWlnbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgIHZhciBzdGFydERhdGUgPSBtb21lbnQoZm9ybUNhbXBhaWduLnN0YXJ0RGF0ZSkudXRjKCctMDUwMCcpLmFkZCgzMCwgJ21pbnV0ZXMnKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKTtcclxuICAgICAgICAgICAgICAgIHZhciBub3cgPSBtb21lbnQoKS51dGMoJy0wNTAwJykuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybUNhbXBhaWduLnN0YXJ0RGF0ZSA9PSBcIlwiIHx8IGZvcm1DYW1wYWlnbi5zdGFydERhdGUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKFwiRWwgY2FtcG8gZGUgZmVjaGEgaW5pY2lhbCBlcyBvYmxpZ2F0b3Jpby5cIik7XHJcbiAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmb3JtQ2FtcGFpZ24uZ210ID09IFwiXCIgfHwgZm9ybUNhbXBhaWduLmdtdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoXCJFbCBjYW1wbyBkZSBnbXQgZXMgb2JsaWdhdG9yaW8uXCIpO1xyXG4gICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChzdGFydERhdGUgPCBub3cpIHtcclxuICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihcIkxhIGZlY2hhIGluaWNpYWwgbm8gZGViZSBzZXIgbWVub3IgYSBsYSBmZWNoYSBhY3R1YWxcIik7XHJcbiAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGZvcm1DYW1wYWlnbi5jYW1wYWlnbkNhdGVnb3J5ID09IFwiXCIgfHwgdHlwZW9mIGZvcm1DYW1wYWlnbi5jYW1wYWlnbkNhdGVnb3J5ID09IFwidW5kZWZpbmVkXCIgfHwgZm9ybUNhbXBhaWduLmNhbXBhaWduQ2F0ZWdvcnkgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKFwiRWwgY2FtcG8gZGUgY2F0ZWdvcmlhIGRlIGNhbXBhw7FhIGVzIG9ibGlnYXRvcmlvLlwiKTtcclxuICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybUNhbXBhaWduLmRlc2NyaXB0aW9uQ2FtcGFpZ24gPT0gXCJcIiB8fCB0eXBlb2YgZm9ybUNhbXBhaWduLmRlc2NyaXB0aW9uQ2FtcGFpZ24gPT0gXCJ1bmRlZmluZWRcIiB8fCBmb3JtQ2FtcGFpZ24uZGVzY3JpcHRpb25DYW1wYWlnbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgIGZvcm1DYW1wYWlnbi5kZXNjcmlwdGlvbkNhbXBhaWduID0gJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybUNhbXBhaWduLm5hbWVDYW1wYWlnbiA9PSBcIlwiIHx8IHR5cGVvZiBmb3JtQ2FtcGFpZ24ubmFtZUNhbXBhaWduID09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIGZvcm1DYW1wYWlnbi5uYW1lQ2FtcGFpZ24gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKFwiRWwgY2FtcG8gZGUgbm9tYnJlIGRlIGNhbXBhw7FhIGVzIG9ibGlnYXRvcmlvLlwiKTtcclxuICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZm9ybUNhbXBhaWduKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZVNlcnZpY2UgPSBmdW5jdGlvbiAoY2hhcnRWaWV3TW9kZWwsIHNlcnZpY2VzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlcnZpY2VzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoXCJMYSBjYW1wYcOxYSB0aWVuZSBzZXJ2aWNpb3MgcXVlIG5vIGVzdGFuIGhhYmlsaXRhZG9zLCBwb3IgZmF2b3IgY29udGFjdGFyIGEgc29wb3J0ZS5cIik7XHJcbiAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNlcnZpY2VzLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFydFZpZXdNb2RlbC5ub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFydFZpZXdNb2RlbC5ub2Rlc1tpXS50aGVtZSA9PSBcInNlcnZpY2VcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHNlcnZpY2VzWzBdLnNlcnZpY2UgIT0gY2hhcnRWaWV3TW9kZWwubm9kZXNbaV0ubWV0aG9kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoXCJMYSBjYW1wYcOxYSB0aWVuZSBzZXJ2aWNpb3MgcXVlIG5vIGVzdGFuIGhhYmlsaXRhZG9zLCBwb3IgZmF2b3IgY29udGFjdGFyIGEgc29wb3J0ZS5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIHRoaXMuY291bnRDb250YWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyAnYXBpL3NlbmRtYWlsL2NvdW50Y29udGFjdCc7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KHVybCwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5lcnJvcihkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIHRoaXMuZ2V0U2NoZW1lID0gZnVuY3Rpb24gKGlkQXV0b21hdGljQ2FtcGFpZ24pIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZnVsbFVybEJhc2UgKyBcImFwaS9hdXRvbWFjYW1wL2dldHNjaGVtZS9cIiArIGlkQXV0b21hdGljQ2FtcGFpZ247XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XSlcclxuICAgICAgICAgIC5mYWN0b3J5KCdub3RpZmljYXRpb25TZXJ2aWNlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgc2xpZGVPblRvcChtZXNzYWdlLCA0MDAwLCAnZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUtY2lyY2xlJywgJ2RhbmdlcicpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICBzbGlkZU9uVG9wKG1lc3NhZ2UsIDQwMDAsICdnbHlwaGljb24gZ2x5cGhpY29uLW9rLWNpcmNsZScsICdzdWNjZXNzJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgIHNsaWRlT25Ub3AobWVzc2FnZSwgNDAwMCwgJ2dseXBoaWNvbiBnbHlwaGljb24tZXhjbGFtYXRpb24tc2lnbicsICd3YXJuaW5nJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIG5vdGljZShtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgc2xpZGVPblRvcChtZXNzYWdlLCA0MDAwLCAnZ2x5cGhpY29uIGdseXBoaWNvbi1leGNsYW1hdGlvbi1zaWduJywgJ25vdGljZScpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBwcmltYXJ5KG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICBzbGlkZU9uVG9wKG1lc3NhZ2UsIDQwMDAsICdnbHlwaGljb24gZ2x5cGhpY29uLWV4Y2xhbWF0aW9uLXNpZ24nLCAncHJpbWFyeScpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcclxuICAgICAgICAgICAgICBzdWNjZXNzOiBzdWNjZXNzLFxyXG4gICAgICAgICAgICAgIHdhcm5pbmc6IHdhcm5pbmcsXHJcbiAgICAgICAgICAgICAgbm90aWNlOiBub3RpY2UsXHJcbiAgICAgICAgICAgICAgcHJpbWFyeTogcHJpbWFyeVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5mYWN0b3J5KCdzZXREYXRhJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgb2JqID0ge307XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge307XHJcblxyXG4gICAgICAgICAgICBvYmouZ2V0RGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb2JqLnNldERhdGEgPSBmdW5jdGlvbiAob2JqRGF0YSkge1xyXG4gICAgICAgICAgICAgIGRhdGEgPSBvYmpEYXRhO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgICAgfSlcclxufSkoKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9qcy9hbmd1bGFyL2F1dG9tYXRpY2NhbXBhaWduL3NlcnZpY2VzLmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///3\n");

/***/ })
/******/ ]);