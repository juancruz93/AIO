/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

eval("__webpack_require__(1);\r\n__webpack_require__(2);\r\n__webpack_require__(3);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9hbmd1bGFyL3Ntc3R3b3dheS9tYWluLmpzPzY5NzEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsbUJBQU8sQ0FBQyxDQUFVO0FBQ2xCLG1CQUFPLENBQUMsQ0FBa0I7QUFDMUIsbUJBQU8sQ0FBQyxDQUFlIiwiZmlsZSI6IjAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuL2FwcC5qcycpO1xyXG5yZXF1aXJlKCcuL2NvbnRyb2xsZXJzLmpzJyk7XHJcbnJlcXVpcmUoJy4vc2VydmljZXMuanMnKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2pzL2FuZ3VsYXIvc21zdHdvd2F5L21haW4uanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/***/ (function(module, exports) {

eval("angular.module('smstwoway', ['ui.router', 'smstwoway.controllers', 'smstwoway.services', 'ui.select', \"ngSanitize\", 'moment-picker'])\r\n        .config(['$stateProvider', '$urlRouterProvider', function ($stateProvider, $urlRouterProvider) {\r\n            $stateProvider\r\n                    .state('toolstwoway', {\r\n                      url: \"/tools\",\r\n                      templateUrl: fullUrlBase + templateBase + '/toolstwoway',\r\n                      controller: 'tools'\r\n                    })\r\n                    .state('indextwoway', {\r\n                      url: \"/\",\r\n                      templateUrl: fullUrlBase + templateBase + '/list',\r\n                      controller: 'main'\r\n                    })\r\n                    .state('showlotetwoway', {\r\n                      url: \"/showlotetwoway\",\r\n                      templateUrl: fullUrlBase + templateBase + '/showlotetwoway',\r\n                      controller: 'showlotetwoway'\r\n                    })\r\n                    .state('create', {\r\n                      url: \"/speedsent\",\r\n                      templateUrl: fullUrlBase + templateBase + '/speedsent',\r\n                      controller: 'speedsent'\r\n                    })\r\n                    .state('csvsent', {\r\n                      url: \"/createcsv\",\r\n                      templateUrl: fullUrlBase + templateBase + '/createcsv',\r\n                      controller: 'csv'\r\n                    })\r\n                    .state('createdcontact', {\r\n                      url: \"/createdcontact\",\r\n                      templateUrl: fullUrlBase + templateBase + '/createdcontact',\r\n                      controller: 'createdcontact'\r\n                    })\r\n                    .state('editCsv', {\r\n                      url: \"/editcsv/:idSmsTwoway\",\r\n                      templateUrl: fullUrlBase + templateBase + '/createcsv',\r\n                      controller: 'csv'\r\n                    })\r\n                    .state('editsmstwowaycontact', {\r\n                      url: \"/editsmstwowaycontact/:idSmsTwoway\",\r\n                      templateUrl: fullUrlBase + templateBase + '/createdcontact',\r\n                      controller: 'createdcontact'\r\n                    })\r\n                    .state('editspeedsent', {\r\n                      url: \"/editspeedsent/:idSmsTwoway\",\r\n                      templateUrl: fullUrlBase + templateBase + '/speedsent',\r\n                      controller: 'speedsent'\r\n                    });\r\n\r\n            $urlRouterProvider.otherwise('/');\r\n          }])\r\n        .constant('contantSmstwoway', {\r\n          urlPeticion: {\r\n            getCategory: fullUrlBase + '/api/smscategory/getall',\r\n            getTimezone: fullUrlBase + 'mail/timezone/',\r\n            indexLoteTwoway: fullUrlBase + 'api/smstwoway/getallsmstwoway/',\r\n            createLoteTwoway: fullUrlBase + 'api/smstwoway/createsmslotetwoway',\r\n            editLoteTwoway: fullUrlBase + 'api/smstwoway/editsmslotetwowaysend',\r\n            getsegments: fullUrlBase + 'api/sendmail/getsegment',\r\n            getcontactlist: fullUrlBase + 'api/sendmail/getcontactlist',\r\n            createCsvTwoway: fullUrlBase + 'api/smstwoway/createcsv',\r\n            changeStatusTwoway: fullUrlBase + 'api/smstwoway/changestatus/',\r\n            countContact: fullUrlBase + 'api/sms/countcontact',\r\n            listSmsTemplate: fullUrlBase + 'api/smstemplate/listfull',\r\n            saveSmstowwayContact: fullUrlBase + 'api/smstwoway/savesmstowwaycontact',\r\n            indexSmsTwoway: fullUrlBase + 'smstwoway',\r\n            changeDataEditAll: fullUrlBase + 'api/smstwoway/getalledit/',\r\n            getInfoTwoway: fullUrlBase + 'api/smstwoway/getone',\r\n            getInforEdit: fullUrlBase + 'api/smstwoway/getalleditcontact',\r\n            calcelEdit: fullUrlBase + 'api/smstwoway/changestatusedit',\r\n            editcsv: fullUrlBase + 'api/smstwoway/editcsv',\r\n            getavalaiblecountry: fullUrlBase + 'api/smstwoway/getavalaiblecountry'\r\n\r\n          },\r\n          error: {\r\n            messages: {\r\n              msgNameSent: \"Debes ingresar un nombre de envio de SMS doble via\",\r\n              msgCategory: \"Por favor ingrese una categoria\",\r\n              msgTimezone: \"Por favor ingrese una zona horaria\",\r\n              msgDateTime: \"Debes ingresar una fecha y hora de envio\",\r\n              msgDestinataries: \"Debes ingresar al menos un destinatario\",\r\n              msgIndicative: \"Indicativo no valido\",\r\n              msgValidatePuntoYComa: \"Recuerde que los datos de cada destinatario deben estar separados por punto y coma ';' y los destinatarios por un salto de línea (enter)\",\r\n              msgValidatePhone: \"Numero de destinatario invalido.\",\r\n              msgValidateInvalidCharacters: \"El mensaje no permite estos caracteres: ñ Ñ á é í ó ú Á É Í Ó Ú ´\",\r\n              msgMaxCharacters: \"El mensaje para cada destinatario es de maximo 160 caracteres.\",\r\n              msgMaxDestinataries: \"Solo se puede ingresar 500 destinatarios\",\r\n              msgEmailEmpty: \"Por favor ingrese el email\",\r\n              msgEmailEmpty2: \"No se encontro ningun correo electronico\",\r\n              msgMaxEmail: \"Solo se puede ingresar un máximo de 8 correos electrónicos\",\r\n              msgIntervalos: \"Por favor ingrese la cantidad de envio por intervalos\",\r\n              msgSentTime: \"Por favor ingrese tiempo de envio\",\r\n              msgTimeFormat: \"Por favor ingrese el formato de envio\",\r\n              msgTypeResponseNotClicked: \"Debe agregar tipos de respuesta y homologaciones de las mismas para sus envios de SMS doble via.\",\r\n              msgTypeResponseEmpty: \"Los campos de respuesta y homologacion no pueden estar vacios.\",\r\n              msgTypeResponseMinLength: \"El minimo de respuestas con sus respectivas homologaciones es 2\",\r\n              msgTypeResponseHomologateMinLength: \"El maximo de homologaciones es 10\",\r\n              msgBlankSpaces: \"La respuesta y/o homologación no puede contener tildes, ni ñ ni espacios en blanco.\",\r\n              msgLoadCsv: \"Debe adjuntar un archivo con extension .csv\",\r\n              msgEnvioExitoso: \"El envío se realizó correctamente!\",\r\n              msgEnvioNoExitoso: \"No se pudo realizar el envio, intente de nuevo\",\r\n              msgCsv: \"Por favor seleccione un archivo CSV,intente de nuevo\",\r\n              msgInvalidMail1: \"El correo \",\r\n              msgInvalidMail2: \" no es valido.\",\r\n            }\r\n          },\r\n          values: {\r\n            messages: {\r\n              msgMaxDestinatariesValue:500,\r\n              msgMaxPhoneDigits: 10,\r\n              msgMaxCharacters: 160,\r\n              msgMinTypeResponseValue: 2,\r\n              msgMaxHomologateContentValue: 10,\r\n              msgMaxEmailValue: 8,\r\n              initValueZero: 0,\r\n              initValueOne: 1,\r\n            }\r\n          },\r\n          misc: {\r\n            idSubaccount: idSubaccount,\r\n            arrBoolean: [\"true\", \"false\", \"TRUE\", \"FALSE\", 0, 1, \"0\", \"1\"],\r\n            limitTypeResponse: 5,\r\n            minTypeResponse: 2,\r\n            typeResponseInit: [{response:\"si\",homologate:\"confirmado,acepto,ok\"},{response:\"no\",homologate:\"cancelado,negativo\"}],\r\n            timeZn: \"-0500\",\r\n            minValue: 'minute',\r\n            minName: \"Minuto(s)\", \r\n            hourValue: 'hour',\r\n            hourName: \"Hora(s)\",\r\n            dayValue: 'day',\r\n            dayName: \"Día(s)\",\r\n            weekValue: 'week',\r\n            weekName: \"Semana(s)\",\r\n            monthValue:'month',\r\n            monthName: \"Mes(es)\",\r\n          },\r\n          classToogle: {\r\n            danger: \"danger\",\r\n            error: \"error\",\r\n            warning: \"warning\",\r\n            success: \"success\",\r\n            notice: \"notice\",\r\n            info: \"info\",\r\n          },\r\n          milliSeconds: {\r\n            threeThousand: 3000,\r\n            fourThousand: 4000,\r\n\r\n          },\r\n          slideOnTop: {\r\n            classSlide: \"glyphicon glyphicon-info-sign\",\r\n            classSlideRemoveCircle: \"glyphicon glyphicon-remove-circle\",\r\n            classSlideOkCircle: \"glyphicon glyphicon-ok-circle\",\r\n            classSlideExclamationSign: \"glyphicon glyphicon-exclamation-sign\",\r\n          },\r\n          title:{\r\n            editsmscontac:\"Editar SMS doble vía por contacto o segmentos.\",\r\n            createdsmscontac:\"Crear SMS doble vía por contacto o segmentos.\",\r\n          },\r\n          patterns:{\r\n            accentsMsgDestinataries: /[ñÑáéíóúÁÉÍÓÚ´]/,\r\n            blankSpacesResponseAndHomologate:/\\s/,\r\n            accentsResponseAndHomologate:/[ñÑáéíóúÁÉÍÓÚ¿¡´]/,\r\n            verifyCorrectEmail: /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\r\n          },\r\n          cases: {\r\n            contact: 'contact',\r\n            csv: 'csv',\r\n            speedSent: 'lote',\r\n            \r\n            draft: 'draft',\r\n            scheduled: 'scheduled',\r\n            pending: 'pending',\r\n            sending: 'sending',\r\n            sent: 'sent',\r\n            paused: 'paused',\r\n            canceled: 'canceled',\r\n            undelivered: 'undelivered'\r\n          },\r\n          statusType:{\r\n            contact: \"Contacto\",\r\n            csv: \"Csv\",\r\n            sentSpeed: \"Envío rapido\"\r\n          },\r\n          restricts: {\r\n            letterRestrict: 'A'\r\n          },\r\n          atSym: {\r\n            symbolAt: '@'\r\n          },\r\n          classSt:{\r\n            colorDraft: 'color-draft',\r\n            colorScheduled: 'color-scheduled',\r\n            colorPending: 'color-pending',\r\n            colorSending: 'color-sending',\r\n            colorSent:'color-sent',\r\n            colorPaused:'color-paused',\r\n            colorCanceled1:'color-canceled', \r\n            colorCanceled2:'color-canceled', \r\n          },\r\n          smsTranslate:{\r\n            borrador: \"Borrador\",\r\n            programado: \"Programado\",\r\n            pendiente: \"Pendiente\",\r\n            enProcesoDeEnvio: \"En proceso de envío\",\r\n            enviado: \"Enviado\",\r\n            pausado: \"Pausado\",\r\n            cancelado: \"Cancelado\",\r\n            noEnviado: \"No enviado\",\r\n          },\r\n          sckts:{\r\n            stopSmsTwoway: 'stop-sms-twoway',\r\n            pausedSmsTwoway: 'paused-sms-twoway',\r\n            resumeSmsTwoway: 'resume-sms-twoway',\r\n            refreshViewSmsTwoWay:'refresh-view-sms-two-way',\r\n            processSmsTwoWay: 'process-sms-twoway'\r\n          },\r\n          funcNode:{\r\n            canc:\"canceled\",\r\n            paus: \"paused\",\r\n            sche: \"scheduled\"\r\n          },\r\n          casesNode:{\r\n            cancela: 'cancel',\r\n            pau: 'pause',\r\n            contin: 'continue',\r\n          },\r\n          caseResponseNode:{\r\n            caseOne: '1',\r\n            caseTwo: '2',\r\n            caseThree: '3'\r\n          },\r\n          toggleSmsTwoway:{\r\n            toggOn: 'Si', \r\n            toggOff: 'No',\r\n            toggOnStyle: 'success', \r\n            toggOffStyle: 'danger',\r\n            toggSize: 'small'\r\n          },\r\n          dTPicker:{\r\n            frmt: 'yyyy-MM-dd hh:mm:ss',\r\n            lng: 'es',\r\n          },\r\n          routing:{\r\n            smstwowayRoute: \"smstwoway/\",\r\n            goState: 'indextwoway'\r\n          },\r\n          statusLoadingCsv:{\r\n            preload: \"preload\",\r\n            validations: \"validations\",\r\n            load: \"load\",\r\n            finish: \"finish\"\r\n          },\r\n          clType:{\r\n            typeContactList: 'contactlist',\r\n            typeSegment: 'segment'\r\n          },\r\n          equalFR:{\r\n            equalFileRead: \"=\"\r\n          },\r\n          csvProcess:{\r\n            csvPorc: 20\r\n          },\r\n          valueSenitizeCsv:{\r\n            valuSC: \"1\"\r\n          }\r\n        });\r\n\r\nangular.element(document).ready(function () {\r\n  angular.bootstrap(document, ['smstwoway']);\r\n})\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9hbmd1bGFyL3Ntc3R3b3dheS9hcHAuanM/YTUxMCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjs7QUFFckI7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkhBQTJIO0FBQzNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxnREFBZ0QsRUFBRSw4Q0FBOEM7QUFDaEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7O0FBRUEsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELHlCQUF5Qiw2QkFBNkIsSUFBSSxRQUFRLElBQUksUUFBUSxJQUFJLFFBQVEsSUFBSSxnQ0FBZ0MsR0FBRztBQUNwTCxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLENBQUMiLCJmaWxlIjoiMS5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdzbXN0d293YXknLCBbJ3VpLnJvdXRlcicsICdzbXN0d293YXkuY29udHJvbGxlcnMnLCAnc21zdHdvd2F5LnNlcnZpY2VzJywgJ3VpLnNlbGVjdCcsIFwibmdTYW5pdGl6ZVwiLCAnbW9tZW50LXBpY2tlciddKVxyXG4gICAgICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xyXG4gICAgICAgICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgICAgICAgICAgICAgIC5zdGF0ZSgndG9vbHN0d293YXknLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL3Rvb2xzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogZnVsbFVybEJhc2UgKyB0ZW1wbGF0ZUJhc2UgKyAnL3Rvb2xzdHdvd2F5JyxcclxuICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0b29scydcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdGF0ZSgnaW5kZXh0d293YXknLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGZ1bGxVcmxCYXNlICsgdGVtcGxhdGVCYXNlICsgJy9saXN0JyxcclxuICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnN0YXRlKCdzaG93bG90ZXR3b3dheScsIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvc2hvd2xvdGV0d293YXlcIixcclxuICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBmdWxsVXJsQmFzZSArIHRlbXBsYXRlQmFzZSArICcvc2hvd2xvdGV0d293YXknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3Nob3dsb3RldHdvd2F5J1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnN0YXRlKCdjcmVhdGUnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL3NwZWVkc2VudFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGZ1bGxVcmxCYXNlICsgdGVtcGxhdGVCYXNlICsgJy9zcGVlZHNlbnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3NwZWVkc2VudCdcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdGF0ZSgnY3N2c2VudCcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvY3JlYXRlY3N2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogZnVsbFVybEJhc2UgKyB0ZW1wbGF0ZUJhc2UgKyAnL2NyZWF0ZWNzdicsXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnY3N2J1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnN0YXRlKCdjcmVhdGVkY29udGFjdCcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvY3JlYXRlZGNvbnRhY3RcIixcclxuICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBmdWxsVXJsQmFzZSArIHRlbXBsYXRlQmFzZSArICcvY3JlYXRlZGNvbnRhY3QnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2NyZWF0ZWRjb250YWN0J1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnN0YXRlKCdlZGl0Q3N2Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9lZGl0Y3N2LzppZFNtc1R3b3dheVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGZ1bGxVcmxCYXNlICsgdGVtcGxhdGVCYXNlICsgJy9jcmVhdGVjc3YnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2NzdidcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdGF0ZSgnZWRpdHNtc3R3b3dheWNvbnRhY3QnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2VkaXRzbXN0d293YXljb250YWN0LzppZFNtc1R3b3dheVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGZ1bGxVcmxCYXNlICsgdGVtcGxhdGVCYXNlICsgJy9jcmVhdGVkY29udGFjdCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnY3JlYXRlZGNvbnRhY3QnXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuc3RhdGUoJ2VkaXRzcGVlZHNlbnQnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2VkaXRzcGVlZHNlbnQvOmlkU21zVHdvd2F5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogZnVsbFVybEJhc2UgKyB0ZW1wbGF0ZUJhc2UgKyAnL3NwZWVkc2VudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc3BlZWRzZW50J1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xyXG4gICAgICAgICAgfV0pXHJcbiAgICAgICAgLmNvbnN0YW50KCdjb250YW50U21zdHdvd2F5Jywge1xyXG4gICAgICAgICAgdXJsUGV0aWNpb246IHtcclxuICAgICAgICAgICAgZ2V0Q2F0ZWdvcnk6IGZ1bGxVcmxCYXNlICsgJy9hcGkvc21zY2F0ZWdvcnkvZ2V0YWxsJyxcclxuICAgICAgICAgICAgZ2V0VGltZXpvbmU6IGZ1bGxVcmxCYXNlICsgJ21haWwvdGltZXpvbmUvJyxcclxuICAgICAgICAgICAgaW5kZXhMb3RlVHdvd2F5OiBmdWxsVXJsQmFzZSArICdhcGkvc21zdHdvd2F5L2dldGFsbHNtc3R3b3dheS8nLFxyXG4gICAgICAgICAgICBjcmVhdGVMb3RlVHdvd2F5OiBmdWxsVXJsQmFzZSArICdhcGkvc21zdHdvd2F5L2NyZWF0ZXNtc2xvdGV0d293YXknLFxyXG4gICAgICAgICAgICBlZGl0TG90ZVR3b3dheTogZnVsbFVybEJhc2UgKyAnYXBpL3Ntc3R3b3dheS9lZGl0c21zbG90ZXR3b3dheXNlbmQnLFxyXG4gICAgICAgICAgICBnZXRzZWdtZW50czogZnVsbFVybEJhc2UgKyAnYXBpL3NlbmRtYWlsL2dldHNlZ21lbnQnLFxyXG4gICAgICAgICAgICBnZXRjb250YWN0bGlzdDogZnVsbFVybEJhc2UgKyAnYXBpL3NlbmRtYWlsL2dldGNvbnRhY3RsaXN0JyxcclxuICAgICAgICAgICAgY3JlYXRlQ3N2VHdvd2F5OiBmdWxsVXJsQmFzZSArICdhcGkvc21zdHdvd2F5L2NyZWF0ZWNzdicsXHJcbiAgICAgICAgICAgIGNoYW5nZVN0YXR1c1R3b3dheTogZnVsbFVybEJhc2UgKyAnYXBpL3Ntc3R3b3dheS9jaGFuZ2VzdGF0dXMvJyxcclxuICAgICAgICAgICAgY291bnRDb250YWN0OiBmdWxsVXJsQmFzZSArICdhcGkvc21zL2NvdW50Y29udGFjdCcsXHJcbiAgICAgICAgICAgIGxpc3RTbXNUZW1wbGF0ZTogZnVsbFVybEJhc2UgKyAnYXBpL3Ntc3RlbXBsYXRlL2xpc3RmdWxsJyxcclxuICAgICAgICAgICAgc2F2ZVNtc3Rvd3dheUNvbnRhY3Q6IGZ1bGxVcmxCYXNlICsgJ2FwaS9zbXN0d293YXkvc2F2ZXNtc3Rvd3dheWNvbnRhY3QnLFxyXG4gICAgICAgICAgICBpbmRleFNtc1R3b3dheTogZnVsbFVybEJhc2UgKyAnc21zdHdvd2F5JyxcclxuICAgICAgICAgICAgY2hhbmdlRGF0YUVkaXRBbGw6IGZ1bGxVcmxCYXNlICsgJ2FwaS9zbXN0d293YXkvZ2V0YWxsZWRpdC8nLFxyXG4gICAgICAgICAgICBnZXRJbmZvVHdvd2F5OiBmdWxsVXJsQmFzZSArICdhcGkvc21zdHdvd2F5L2dldG9uZScsXHJcbiAgICAgICAgICAgIGdldEluZm9yRWRpdDogZnVsbFVybEJhc2UgKyAnYXBpL3Ntc3R3b3dheS9nZXRhbGxlZGl0Y29udGFjdCcsXHJcbiAgICAgICAgICAgIGNhbGNlbEVkaXQ6IGZ1bGxVcmxCYXNlICsgJ2FwaS9zbXN0d293YXkvY2hhbmdlc3RhdHVzZWRpdCcsXHJcbiAgICAgICAgICAgIGVkaXRjc3Y6IGZ1bGxVcmxCYXNlICsgJ2FwaS9zbXN0d293YXkvZWRpdGNzdicsXHJcbiAgICAgICAgICAgIGdldGF2YWxhaWJsZWNvdW50cnk6IGZ1bGxVcmxCYXNlICsgJ2FwaS9zbXN0d293YXkvZ2V0YXZhbGFpYmxlY291bnRyeSdcclxuXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgZXJyb3I6IHtcclxuICAgICAgICAgICAgbWVzc2FnZXM6IHtcclxuICAgICAgICAgICAgICBtc2dOYW1lU2VudDogXCJEZWJlcyBpbmdyZXNhciB1biBub21icmUgZGUgZW52aW8gZGUgU01TIGRvYmxlIHZpYVwiLFxyXG4gICAgICAgICAgICAgIG1zZ0NhdGVnb3J5OiBcIlBvciBmYXZvciBpbmdyZXNlIHVuYSBjYXRlZ29yaWFcIixcclxuICAgICAgICAgICAgICBtc2dUaW1lem9uZTogXCJQb3IgZmF2b3IgaW5ncmVzZSB1bmEgem9uYSBob3JhcmlhXCIsXHJcbiAgICAgICAgICAgICAgbXNnRGF0ZVRpbWU6IFwiRGViZXMgaW5ncmVzYXIgdW5hIGZlY2hhIHkgaG9yYSBkZSBlbnZpb1wiLFxyXG4gICAgICAgICAgICAgIG1zZ0Rlc3RpbmF0YXJpZXM6IFwiRGViZXMgaW5ncmVzYXIgYWwgbWVub3MgdW4gZGVzdGluYXRhcmlvXCIsXHJcbiAgICAgICAgICAgICAgbXNnSW5kaWNhdGl2ZTogXCJJbmRpY2F0aXZvIG5vIHZhbGlkb1wiLFxyXG4gICAgICAgICAgICAgIG1zZ1ZhbGlkYXRlUHVudG9ZQ29tYTogXCJSZWN1ZXJkZSBxdWUgbG9zIGRhdG9zIGRlIGNhZGEgZGVzdGluYXRhcmlvIGRlYmVuIGVzdGFyIHNlcGFyYWRvcyBwb3IgcHVudG8geSBjb21hICc7JyB5IGxvcyBkZXN0aW5hdGFyaW9zIHBvciB1biBzYWx0byBkZSBsw61uZWEgKGVudGVyKVwiLFxyXG4gICAgICAgICAgICAgIG1zZ1ZhbGlkYXRlUGhvbmU6IFwiTnVtZXJvIGRlIGRlc3RpbmF0YXJpbyBpbnZhbGlkby5cIixcclxuICAgICAgICAgICAgICBtc2dWYWxpZGF0ZUludmFsaWRDaGFyYWN0ZXJzOiBcIkVsIG1lbnNhamUgbm8gcGVybWl0ZSBlc3RvcyBjYXJhY3RlcmVzOiDDsSDDkSDDoSDDqSDDrSDDsyDDuiDDgSDDiSDDjSDDkyDDmiDCtFwiLFxyXG4gICAgICAgICAgICAgIG1zZ01heENoYXJhY3RlcnM6IFwiRWwgbWVuc2FqZSBwYXJhIGNhZGEgZGVzdGluYXRhcmlvIGVzIGRlIG1heGltbyAxNjAgY2FyYWN0ZXJlcy5cIixcclxuICAgICAgICAgICAgICBtc2dNYXhEZXN0aW5hdGFyaWVzOiBcIlNvbG8gc2UgcHVlZGUgaW5ncmVzYXIgNTAwIGRlc3RpbmF0YXJpb3NcIixcclxuICAgICAgICAgICAgICBtc2dFbWFpbEVtcHR5OiBcIlBvciBmYXZvciBpbmdyZXNlIGVsIGVtYWlsXCIsXHJcbiAgICAgICAgICAgICAgbXNnRW1haWxFbXB0eTI6IFwiTm8gc2UgZW5jb250cm8gbmluZ3VuIGNvcnJlbyBlbGVjdHJvbmljb1wiLFxyXG4gICAgICAgICAgICAgIG1zZ01heEVtYWlsOiBcIlNvbG8gc2UgcHVlZGUgaW5ncmVzYXIgdW4gbcOheGltbyBkZSA4IGNvcnJlb3MgZWxlY3Ryw7NuaWNvc1wiLFxyXG4gICAgICAgICAgICAgIG1zZ0ludGVydmFsb3M6IFwiUG9yIGZhdm9yIGluZ3Jlc2UgbGEgY2FudGlkYWQgZGUgZW52aW8gcG9yIGludGVydmFsb3NcIixcclxuICAgICAgICAgICAgICBtc2dTZW50VGltZTogXCJQb3IgZmF2b3IgaW5ncmVzZSB0aWVtcG8gZGUgZW52aW9cIixcclxuICAgICAgICAgICAgICBtc2dUaW1lRm9ybWF0OiBcIlBvciBmYXZvciBpbmdyZXNlIGVsIGZvcm1hdG8gZGUgZW52aW9cIixcclxuICAgICAgICAgICAgICBtc2dUeXBlUmVzcG9uc2VOb3RDbGlja2VkOiBcIkRlYmUgYWdyZWdhciB0aXBvcyBkZSByZXNwdWVzdGEgeSBob21vbG9nYWNpb25lcyBkZSBsYXMgbWlzbWFzIHBhcmEgc3VzIGVudmlvcyBkZSBTTVMgZG9ibGUgdmlhLlwiLFxyXG4gICAgICAgICAgICAgIG1zZ1R5cGVSZXNwb25zZUVtcHR5OiBcIkxvcyBjYW1wb3MgZGUgcmVzcHVlc3RhIHkgaG9tb2xvZ2FjaW9uIG5vIHB1ZWRlbiBlc3RhciB2YWNpb3MuXCIsXHJcbiAgICAgICAgICAgICAgbXNnVHlwZVJlc3BvbnNlTWluTGVuZ3RoOiBcIkVsIG1pbmltbyBkZSByZXNwdWVzdGFzIGNvbiBzdXMgcmVzcGVjdGl2YXMgaG9tb2xvZ2FjaW9uZXMgZXMgMlwiLFxyXG4gICAgICAgICAgICAgIG1zZ1R5cGVSZXNwb25zZUhvbW9sb2dhdGVNaW5MZW5ndGg6IFwiRWwgbWF4aW1vIGRlIGhvbW9sb2dhY2lvbmVzIGVzIDEwXCIsXHJcbiAgICAgICAgICAgICAgbXNnQmxhbmtTcGFjZXM6IFwiTGEgcmVzcHVlc3RhIHkvbyBob21vbG9nYWNpw7NuIG5vIHB1ZWRlIGNvbnRlbmVyIHRpbGRlcywgbmkgw7EgbmkgZXNwYWNpb3MgZW4gYmxhbmNvLlwiLFxyXG4gICAgICAgICAgICAgIG1zZ0xvYWRDc3Y6IFwiRGViZSBhZGp1bnRhciB1biBhcmNoaXZvIGNvbiBleHRlbnNpb24gLmNzdlwiLFxyXG4gICAgICAgICAgICAgIG1zZ0VudmlvRXhpdG9zbzogXCJFbCBlbnbDrW8gc2UgcmVhbGl6w7MgY29ycmVjdGFtZW50ZSFcIixcclxuICAgICAgICAgICAgICBtc2dFbnZpb05vRXhpdG9zbzogXCJObyBzZSBwdWRvIHJlYWxpemFyIGVsIGVudmlvLCBpbnRlbnRlIGRlIG51ZXZvXCIsXHJcbiAgICAgICAgICAgICAgbXNnQ3N2OiBcIlBvciBmYXZvciBzZWxlY2Npb25lIHVuIGFyY2hpdm8gQ1NWLGludGVudGUgZGUgbnVldm9cIixcclxuICAgICAgICAgICAgICBtc2dJbnZhbGlkTWFpbDE6IFwiRWwgY29ycmVvIFwiLFxyXG4gICAgICAgICAgICAgIG1zZ0ludmFsaWRNYWlsMjogXCIgbm8gZXMgdmFsaWRvLlwiLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdmFsdWVzOiB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiB7XHJcbiAgICAgICAgICAgICAgbXNnTWF4RGVzdGluYXRhcmllc1ZhbHVlOjUwMCxcclxuICAgICAgICAgICAgICBtc2dNYXhQaG9uZURpZ2l0czogMTAsXHJcbiAgICAgICAgICAgICAgbXNnTWF4Q2hhcmFjdGVyczogMTYwLFxyXG4gICAgICAgICAgICAgIG1zZ01pblR5cGVSZXNwb25zZVZhbHVlOiAyLFxyXG4gICAgICAgICAgICAgIG1zZ01heEhvbW9sb2dhdGVDb250ZW50VmFsdWU6IDEwLFxyXG4gICAgICAgICAgICAgIG1zZ01heEVtYWlsVmFsdWU6IDgsXHJcbiAgICAgICAgICAgICAgaW5pdFZhbHVlWmVybzogMCxcclxuICAgICAgICAgICAgICBpbml0VmFsdWVPbmU6IDEsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtaXNjOiB7XHJcbiAgICAgICAgICAgIGlkU3ViYWNjb3VudDogaWRTdWJhY2NvdW50LFxyXG4gICAgICAgICAgICBhcnJCb29sZWFuOiBbXCJ0cnVlXCIsIFwiZmFsc2VcIiwgXCJUUlVFXCIsIFwiRkFMU0VcIiwgMCwgMSwgXCIwXCIsIFwiMVwiXSxcclxuICAgICAgICAgICAgbGltaXRUeXBlUmVzcG9uc2U6IDUsXHJcbiAgICAgICAgICAgIG1pblR5cGVSZXNwb25zZTogMixcclxuICAgICAgICAgICAgdHlwZVJlc3BvbnNlSW5pdDogW3tyZXNwb25zZTpcInNpXCIsaG9tb2xvZ2F0ZTpcImNvbmZpcm1hZG8sYWNlcHRvLG9rXCJ9LHtyZXNwb25zZTpcIm5vXCIsaG9tb2xvZ2F0ZTpcImNhbmNlbGFkbyxuZWdhdGl2b1wifV0sXHJcbiAgICAgICAgICAgIHRpbWVabjogXCItMDUwMFwiLFxyXG4gICAgICAgICAgICBtaW5WYWx1ZTogJ21pbnV0ZScsXHJcbiAgICAgICAgICAgIG1pbk5hbWU6IFwiTWludXRvKHMpXCIsIFxyXG4gICAgICAgICAgICBob3VyVmFsdWU6ICdob3VyJyxcclxuICAgICAgICAgICAgaG91ck5hbWU6IFwiSG9yYShzKVwiLFxyXG4gICAgICAgICAgICBkYXlWYWx1ZTogJ2RheScsXHJcbiAgICAgICAgICAgIGRheU5hbWU6IFwiRMOtYShzKVwiLFxyXG4gICAgICAgICAgICB3ZWVrVmFsdWU6ICd3ZWVrJyxcclxuICAgICAgICAgICAgd2Vla05hbWU6IFwiU2VtYW5hKHMpXCIsXHJcbiAgICAgICAgICAgIG1vbnRoVmFsdWU6J21vbnRoJyxcclxuICAgICAgICAgICAgbW9udGhOYW1lOiBcIk1lcyhlcylcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjbGFzc1Rvb2dsZToge1xyXG4gICAgICAgICAgICBkYW5nZXI6IFwiZGFuZ2VyXCIsXHJcbiAgICAgICAgICAgIGVycm9yOiBcImVycm9yXCIsXHJcbiAgICAgICAgICAgIHdhcm5pbmc6IFwid2FybmluZ1wiLFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBcInN1Y2Nlc3NcIixcclxuICAgICAgICAgICAgbm90aWNlOiBcIm5vdGljZVwiLFxyXG4gICAgICAgICAgICBpbmZvOiBcImluZm9cIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtaWxsaVNlY29uZHM6IHtcclxuICAgICAgICAgICAgdGhyZWVUaG91c2FuZDogMzAwMCxcclxuICAgICAgICAgICAgZm91clRob3VzYW5kOiA0MDAwLFxyXG5cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzbGlkZU9uVG9wOiB7XHJcbiAgICAgICAgICAgIGNsYXNzU2xpZGU6IFwiZ2x5cGhpY29uIGdseXBoaWNvbi1pbmZvLXNpZ25cIixcclxuICAgICAgICAgICAgY2xhc3NTbGlkZVJlbW92ZUNpcmNsZTogXCJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZS1jaXJjbGVcIixcclxuICAgICAgICAgICAgY2xhc3NTbGlkZU9rQ2lyY2xlOiBcImdseXBoaWNvbiBnbHlwaGljb24tb2stY2lyY2xlXCIsXHJcbiAgICAgICAgICAgIGNsYXNzU2xpZGVFeGNsYW1hdGlvblNpZ246IFwiZ2x5cGhpY29uIGdseXBoaWNvbi1leGNsYW1hdGlvbi1zaWduXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdGl0bGU6e1xyXG4gICAgICAgICAgICBlZGl0c21zY29udGFjOlwiRWRpdGFyIFNNUyBkb2JsZSB2w61hIHBvciBjb250YWN0byBvIHNlZ21lbnRvcy5cIixcclxuICAgICAgICAgICAgY3JlYXRlZHNtc2NvbnRhYzpcIkNyZWFyIFNNUyBkb2JsZSB2w61hIHBvciBjb250YWN0byBvIHNlZ21lbnRvcy5cIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBwYXR0ZXJuczp7XHJcbiAgICAgICAgICAgIGFjY2VudHNNc2dEZXN0aW5hdGFyaWVzOiAvW8Oxw5HDocOpw63Ds8O6w4HDicONw5PDmsK0XS8sXHJcbiAgICAgICAgICAgIGJsYW5rU3BhY2VzUmVzcG9uc2VBbmRIb21vbG9nYXRlOi9cXHMvLFxyXG4gICAgICAgICAgICBhY2NlbnRzUmVzcG9uc2VBbmRIb21vbG9nYXRlOi9bw7HDkcOhw6nDrcOzw7rDgcOJw43Dk8Oawr/CocK0XS8sXHJcbiAgICAgICAgICAgIHZlcmlmeUNvcnJlY3RFbWFpbDogL14oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC9cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjYXNlczoge1xyXG4gICAgICAgICAgICBjb250YWN0OiAnY29udGFjdCcsXHJcbiAgICAgICAgICAgIGNzdjogJ2NzdicsXHJcbiAgICAgICAgICAgIHNwZWVkU2VudDogJ2xvdGUnLFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZHJhZnQ6ICdkcmFmdCcsXHJcbiAgICAgICAgICAgIHNjaGVkdWxlZDogJ3NjaGVkdWxlZCcsXHJcbiAgICAgICAgICAgIHBlbmRpbmc6ICdwZW5kaW5nJyxcclxuICAgICAgICAgICAgc2VuZGluZzogJ3NlbmRpbmcnLFxyXG4gICAgICAgICAgICBzZW50OiAnc2VudCcsXHJcbiAgICAgICAgICAgIHBhdXNlZDogJ3BhdXNlZCcsXHJcbiAgICAgICAgICAgIGNhbmNlbGVkOiAnY2FuY2VsZWQnLFxyXG4gICAgICAgICAgICB1bmRlbGl2ZXJlZDogJ3VuZGVsaXZlcmVkJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHN0YXR1c1R5cGU6e1xyXG4gICAgICAgICAgICBjb250YWN0OiBcIkNvbnRhY3RvXCIsXHJcbiAgICAgICAgICAgIGNzdjogXCJDc3ZcIixcclxuICAgICAgICAgICAgc2VudFNwZWVkOiBcIkVudsOtbyByYXBpZG9cIlxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHJlc3RyaWN0czoge1xyXG4gICAgICAgICAgICBsZXR0ZXJSZXN0cmljdDogJ0EnXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYXRTeW06IHtcclxuICAgICAgICAgICAgc3ltYm9sQXQ6ICdAJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGNsYXNzU3Q6e1xyXG4gICAgICAgICAgICBjb2xvckRyYWZ0OiAnY29sb3ItZHJhZnQnLFxyXG4gICAgICAgICAgICBjb2xvclNjaGVkdWxlZDogJ2NvbG9yLXNjaGVkdWxlZCcsXHJcbiAgICAgICAgICAgIGNvbG9yUGVuZGluZzogJ2NvbG9yLXBlbmRpbmcnLFxyXG4gICAgICAgICAgICBjb2xvclNlbmRpbmc6ICdjb2xvci1zZW5kaW5nJyxcclxuICAgICAgICAgICAgY29sb3JTZW50Oidjb2xvci1zZW50JyxcclxuICAgICAgICAgICAgY29sb3JQYXVzZWQ6J2NvbG9yLXBhdXNlZCcsXHJcbiAgICAgICAgICAgIGNvbG9yQ2FuY2VsZWQxOidjb2xvci1jYW5jZWxlZCcsIFxyXG4gICAgICAgICAgICBjb2xvckNhbmNlbGVkMjonY29sb3ItY2FuY2VsZWQnLCBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzbXNUcmFuc2xhdGU6e1xyXG4gICAgICAgICAgICBib3JyYWRvcjogXCJCb3JyYWRvclwiLFxyXG4gICAgICAgICAgICBwcm9ncmFtYWRvOiBcIlByb2dyYW1hZG9cIixcclxuICAgICAgICAgICAgcGVuZGllbnRlOiBcIlBlbmRpZW50ZVwiLFxyXG4gICAgICAgICAgICBlblByb2Nlc29EZUVudmlvOiBcIkVuIHByb2Nlc28gZGUgZW52w61vXCIsXHJcbiAgICAgICAgICAgIGVudmlhZG86IFwiRW52aWFkb1wiLFxyXG4gICAgICAgICAgICBwYXVzYWRvOiBcIlBhdXNhZG9cIixcclxuICAgICAgICAgICAgY2FuY2VsYWRvOiBcIkNhbmNlbGFkb1wiLFxyXG4gICAgICAgICAgICBub0VudmlhZG86IFwiTm8gZW52aWFkb1wiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNja3RzOntcclxuICAgICAgICAgICAgc3RvcFNtc1R3b3dheTogJ3N0b3Atc21zLXR3b3dheScsXHJcbiAgICAgICAgICAgIHBhdXNlZFNtc1R3b3dheTogJ3BhdXNlZC1zbXMtdHdvd2F5JyxcclxuICAgICAgICAgICAgcmVzdW1lU21zVHdvd2F5OiAncmVzdW1lLXNtcy10d293YXknLFxyXG4gICAgICAgICAgICByZWZyZXNoVmlld1Ntc1R3b1dheToncmVmcmVzaC12aWV3LXNtcy10d28td2F5JyxcclxuICAgICAgICAgICAgcHJvY2Vzc1Ntc1R3b1dheTogJ3Byb2Nlc3Mtc21zLXR3b3dheSdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBmdW5jTm9kZTp7XHJcbiAgICAgICAgICAgIGNhbmM6XCJjYW5jZWxlZFwiLFxyXG4gICAgICAgICAgICBwYXVzOiBcInBhdXNlZFwiLFxyXG4gICAgICAgICAgICBzY2hlOiBcInNjaGVkdWxlZFwiXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY2FzZXNOb2RlOntcclxuICAgICAgICAgICAgY2FuY2VsYTogJ2NhbmNlbCcsXHJcbiAgICAgICAgICAgIHBhdTogJ3BhdXNlJyxcclxuICAgICAgICAgICAgY29udGluOiAnY29udGludWUnLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGNhc2VSZXNwb25zZU5vZGU6e1xyXG4gICAgICAgICAgICBjYXNlT25lOiAnMScsXHJcbiAgICAgICAgICAgIGNhc2VUd286ICcyJyxcclxuICAgICAgICAgICAgY2FzZVRocmVlOiAnMydcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB0b2dnbGVTbXNUd293YXk6e1xyXG4gICAgICAgICAgICB0b2dnT246ICdTaScsIFxyXG4gICAgICAgICAgICB0b2dnT2ZmOiAnTm8nLFxyXG4gICAgICAgICAgICB0b2dnT25TdHlsZTogJ3N1Y2Nlc3MnLCBcclxuICAgICAgICAgICAgdG9nZ09mZlN0eWxlOiAnZGFuZ2VyJyxcclxuICAgICAgICAgICAgdG9nZ1NpemU6ICdzbWFsbCdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBkVFBpY2tlcjp7XHJcbiAgICAgICAgICAgIGZybXQ6ICd5eXl5LU1NLWRkIGhoOm1tOnNzJyxcclxuICAgICAgICAgICAgbG5nOiAnZXMnLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHJvdXRpbmc6e1xyXG4gICAgICAgICAgICBzbXN0d293YXlSb3V0ZTogXCJzbXN0d293YXkvXCIsXHJcbiAgICAgICAgICAgIGdvU3RhdGU6ICdpbmRleHR3b3dheSdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzdGF0dXNMb2FkaW5nQ3N2OntcclxuICAgICAgICAgICAgcHJlbG9hZDogXCJwcmVsb2FkXCIsXHJcbiAgICAgICAgICAgIHZhbGlkYXRpb25zOiBcInZhbGlkYXRpb25zXCIsXHJcbiAgICAgICAgICAgIGxvYWQ6IFwibG9hZFwiLFxyXG4gICAgICAgICAgICBmaW5pc2g6IFwiZmluaXNoXCJcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjbFR5cGU6e1xyXG4gICAgICAgICAgICB0eXBlQ29udGFjdExpc3Q6ICdjb250YWN0bGlzdCcsXHJcbiAgICAgICAgICAgIHR5cGVTZWdtZW50OiAnc2VnbWVudCdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBlcXVhbEZSOntcclxuICAgICAgICAgICAgZXF1YWxGaWxlUmVhZDogXCI9XCJcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjc3ZQcm9jZXNzOntcclxuICAgICAgICAgICAgY3N2UG9yYzogMjBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB2YWx1ZVNlbml0aXplQ3N2OntcclxuICAgICAgICAgICAgdmFsdVNDOiBcIjFcIlxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgYW5ndWxhci5ib290c3RyYXAoZG9jdW1lbnQsIFsnc21zdHdvd2F5J10pO1xyXG59KVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2pzL2FuZ3VsYXIvc21zdHdvd2F5L2FwcC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///1\n");

/***/ }),
/* 2 */
/***/ (function(module, exports) {

eval("angular.module('smstwoway.controllers', [])\r\n        .filter('propsFilter', function () {\r\n          return function (items, props) {\r\n            var out = [];\r\n\r\n            if (angular.isArray(items)) {\r\n              var keys = Object.keys(props);\r\n\r\n              items.forEach(function (item) {\r\n                var itemMatches = false;\r\n\r\n                for (var i = 0; i < keys.length; i++) {\r\n                  var prop = keys[i];\r\n                  var text = props[prop].toLowerCase();\r\n                  if (item[prop].toString().toLowerCase().indexOf(text) !== -1) {\r\n                    itemMatches = true;\r\n                    break;\r\n                  }\r\n                }\r\n\r\n                if (itemMatches) {\r\n                  out.push(item);\r\n                }\r\n              });\r\n            } else {\r\n              // Let the output be the input untouched\r\n              out = items;\r\n            }\r\n\r\n            return out;\r\n          };\r\n        })\r\n        .filter('split', function () {\r\n          return function (input, splitChar) {\r\n            // do some bounds checking here to ensure it has that index\r\n            return input.split(splitChar);\r\n          }\r\n        })\r\n        .directive('typeSms', function ($compile, contantSmstwoway) {\r\n          return{\r\n            restrict: 'A',\r\n            link: function (scope, element, attr) {\r\n              //console.log(attr);\r\n              var template = \"Tipo: {{statusType}}\";\r\n              switch (attr.typeSms) {\r\n                case contantSmstwoway.cases.contact:\r\n                  scope.statusType = contantSmstwoway.statusType.contact;\r\n                  break;\r\n                case contantSmstwoway.cases.csv:\r\n                  scope.statusType = contantSmstwoway.statusType.csv;\r\n                  break;\r\n                case contantSmstwoway.cases.speedSent:\r\n                  scope.statusType = contantSmstwoway.statusType.sentSpeed;\r\n                  break;\r\n                default:\r\n                  break;\r\n              }\r\n\r\n              element.html(template);\r\n              $compile(element.contents())(scope);\r\n            }\r\n          }\r\n        })\r\n        .directive('statusSms', function ($compile, contantSmstwoway) {\r\n          return{\r\n            scope: {statusSms: '@'},\r\n            restrict: 'A',\r\n            link: function (scope, element, attr) {\r\n              //console.log(scope);\r\n              var template = \"Estado: <span class='{{classStatus}}'>{{tralateSms}}<span>\";\r\n              scope.chaneStatus = function () {\r\n                switch (scope.statusSms) {\r\n                  case contantSmstwoway.cases.draft:\r\n                    scope.classStatus = contantSmstwoway.classSt.colorDraft;\r\n                    scope.tralateSms = contantSmstwoway.smsTranslate.borrador;\r\n                    break;\r\n                  case contantSmstwoway.cases.scheduled:\r\n                    scope.classStatus = contantSmstwoway.classSt.colorScheduled;\r\n                    scope.tralateSms = contantSmstwoway.smsTranslate.programado;\r\n                    break;\r\n                  case contantSmstwoway.cases.pending:\r\n                    scope.classStatus = contantSmstwoway.classSt.colorPending;\r\n                    scope.tralateSms = contantSmstwoway.smsTranslate.pendiente;\r\n                    break;\r\n                  case contantSmstwoway.cases.sending:\r\n                    scope.classStatus = contantSmstwoway.classSt.colorSending;\r\n                    scope.tralateSms = contantSmstwoway.smsTranslate.enProcesoDeEnvio;\r\n                    break;\r\n                  case contantSmstwoway.cases.sent:\r\n                    scope.classStatus = contantSmstwoway.classSt.colorSent;\r\n                    scope.tralateSms = contantSmstwoway.smsTranslate.enviado;\r\n                    break;\r\n                  case contantSmstwoway.cases.paused:\r\n                    scope.classStatus = contantSmstwoway.classSt.colorPaused;\r\n                    scope.tralateSms = contantSmstwoway.smsTranslate.pausado;\r\n                    break;\r\n                  case contantSmstwoway.cases.canceled:\r\n                    scope.classStatus = contantSmstwoway.classSt.colorCanceled1;\r\n                    scope.tralateSms = contantSmstwoway.smsTranslate.cancelado;\r\n                    break;\r\n                  case contantSmstwoway.cases.undelivered:\r\n                    scope.classStatus = contantSmstwoway.classSt.colorCanceled2;\r\n                    scope.tralateSms = contantSmstwoway.smsTranslate.noEnviado;\r\n                    break;\r\n\r\n                  default:\r\n                    break;\r\n                }\r\n              }\r\n              scope.$watch('statusSms', function (v) {\r\n                scope.chaneStatus();\r\n                element.html(template);\r\n                $compile(element.contents())(scope);\r\n              });\r\n              scope.chaneStatus();\r\n              element.html(template);\r\n              $compile(element.contents())(scope);\r\n            }\r\n          }\r\n        })\r\n        .factory('socket', function ($rootScope) {\r\n          return {\r\n            on: function (eventName, callback) {\r\n              socket.on(eventName, function () {\r\n                var args = arguments;\r\n                $rootScope.$apply(function () {\r\n                  callback.apply(socket, args);\r\n                });\r\n              });\r\n            },\r\n            emit: function (eventName, data, callback) {\r\n              socket.emit(eventName, data, function () {\r\n                var args = arguments;\r\n                $rootScope.$apply(function () {\r\n                  if (callback) {\r\n                    callback.apply(socket, args);\r\n                  }\r\n                });\r\n              })\r\n            }\r\n          }\r\n        })\r\n        .directive(\"fileread\", [function (contantSmstwoway) {\r\n            return {\r\n              scope: {\r\n                fileread: contantSmstwoway.equalFR.equalFileRead\r\n              },\r\n              link: function (scope, element, attributes) {\r\n                element.bind(\"change\", function (changeEvent) {\r\n                  var reader = new FileReader();\r\n                  reader.onload = function (loadEvent) {\r\n                    scope.$apply(function () {\r\n                      scope.fileread = loadEvent.target.result;\r\n                    });\r\n                  }\r\n                  reader.readAsDataURL(changeEvent.target.files[0]);\r\n                });\r\n              }\r\n            }\r\n          }])\r\n        .directive('fileModel', ['$parse', function ($parse, contantSmstwoway) {\r\n            return {\r\n              restrict: 'A',\r\n              link: function (scope, element, attrs) {\r\n                var model = $parse(attrs.fileModel);\r\n                var modelSetter = model.assign;\r\n\r\n                element.bind('change', function () {\r\n                  scope.$apply(function () {\r\n                    modelSetter(scope, element[0].files[0]);\r\n                  });\r\n                });\r\n              }\r\n            };\r\n          }])\r\n        .controller('tools', ['$scope', function ($scope) {}])\r\n        .controller('main', ['$scope', '$state', 'contantSmstwoway', 'restservices', '$q', 'notificationService', 'socket', function ($scope, $state, contantSmstwoway, restservices, $q, notificationService, socket) {\r\n            /**\r\n             * aray de los sockets que se usan en nod.js\r\n             */\r\n            $scope.sockets = {\r\n              cancelSent: function () {\r\n                socket.emit(contantSmstwoway.sckts.stopSmsTwoway, {idSmsTwoway: $scope.node.idSmsTwoway, func: contantSmstwoway.funcNode.canc});\r\n              },\r\n              pausedSent: function () {\r\n\r\n                socket.emit(contantSmstwoway.sckts.pausedSmsTwoway, {idSmsTwoway: $scope.node.idSmsTwoway, func: contantSmstwoway.funcNode.paus});\r\n              },\r\n              resumenSent: function () {\r\n                socket.emit(contantSmstwoway.sckts.resumeSmsTwoway, {idSmsTwoway: $scope.node.idSmsTwoway, func: contantSmstwoway.funcNode.sche});\r\n              },\r\n              executeFunction: function () {\r\n                // switch ($scope.node.status) {\r\n                //   case contantSmstwoway.casesNode.cancel:\r\n                //     $scope.sockets.cancelSent();\r\n                //     break;\r\n                //   case contantSmstwoway.casesNode.pau:\r\n                //     $scope.sockets.pausedSent();\r\n                //     break;\r\n                //   case contantSmstwoway.casesNode.contin:\r\n                //     $scope.sockets.resumenSent();\r\n                //     break;\r\n                // }\r\n                restservices.changestatus($scope.node.idSmsTwoway, $scope.node.status).then(function () {\r\n                  $scope.functions.clseModal();\r\n                  $scope.services.getInitial();\r\n                });\r\n              }\r\n            }\r\n\r\n            $scope.validateDate = function (data) {\r\n              restservices.validateDate(data).then(function () {}).catch(function () {})\r\n            }\r\n\r\n            /**\r\n             * llamado al soked que escucha las respuestas de nod.js\r\n             */\r\n            socket.on(contantSmstwoway.sckts.refreshViewSmsTwoWay, function (data) {\r\n              for (i in $scope.misc.smstwoway.items) {\r\n                if ($scope.misc.smstwoway.items[i].idSmsTwoway == data.idSms) {\r\n                  $scope.misc.smstwoway.items[i].status = data.status;\r\n                }\r\n              }\r\n            });\r\n\r\n            socket.on(contantSmstwoway.sckts.processSmsTwoWay, function (data) {\r\n              $scope.functions.responseNode(data);\r\n            });\r\n            /**\r\n             * array de funciones que se utilizan en el front net \r\n             */\r\n            $scope.functions = {\r\n              searchcategory: function () {\r\n                if ($scope.data.filter.category.length >= contantSmstwoway.values.messages.initValueOne) {\r\n                  $scope.services.getInitial();\r\n                } else {\r\n                  $scope.services.getInitial();\r\n                }\r\n              },\r\n              getCategory: function () {\r\n                restservices.getCategory().then(function (data) {\r\n                  $scope.smsCategory = data;\r\n                });\r\n              },\r\n              setAll: function (data) {\r\n                $scope.misc.smstwoway = data;\r\n              },\r\n              forward: function () {\r\n\r\n                $scope.misc.initial += contantSmstwoway.values.messages.initValueOne;\r\n                $scope.misc.page += contantSmstwoway.values.messages.initValueOne;\r\n                $scope.services.getInitial();\r\n              },\r\n              fastforward: function () {\r\n\r\n                $scope.misc.initial = ($scope.misc.smstwoway.total_pages - contantSmstwoway.values.messages.initValueOne);\r\n                $scope.misc.page = $scope.misc.smstwoway.total_pages;\r\n                $scope.services.getInitial();\r\n              },\r\n              backward: function () {\r\n\r\n                $scope.misc.initial -= contantSmstwoway.values.messages.initValueOne;\r\n                $scope.misc.page -= contantSmstwoway.values.messages.initValueOne;\r\n                $scope.services.getInitial();\r\n              },\r\n              fastbackward: function () {\r\n\r\n                $scope.misc.initial = contantSmstwoway.values.messages.initValueZero;\r\n                $scope.misc.page = contantSmstwoway.values.messages.initValueOne;\r\n                $scope.services.getInitial();\r\n              },\r\n              search: function () {\r\n                $scope.services.getInitial();\r\n              },\r\n              initVariable: function () {\r\n                $scope.data = {};\r\n                $scope.node = {};\r\n                $scope.misc = {};\r\n                $scope.misc.initial = 0;\r\n                $scope.misc.page = 1;\r\n                $scope.data.filter = {category: []};\r\n              },\r\n              openModal: function (id, status) {\r\n                $scope.node.status = status;\r\n                $scope.node.idSmsTwoway = id;\r\n                $('#cancelDialog').addClass('dialog--open');\r\n              },\r\n              clseModal: function () {\r\n                $('#cancelDialog').removeClass('dialog--open');\r\n              },\r\n              responseNode: function (data) {\r\n                if (data.response) {\r\n                  $scope.functions.clseModal();\r\n                  switch (data.type) {\r\n                    case contantSmstwoway.caseResponseNode.caseOne:\r\n                      notificationService.warning(data.response);\r\n                      break;\r\n                    case contantSmstwoway.caseResponseNode.caseTwo:\r\n                      notificationService.info(data.response);\r\n                      break;\r\n                    case contantSmstwoway.caseResponseNode.caseThree:\r\n                      notificationService.success(data.response);\r\n                      break;\r\n                  }\r\n                }\r\n              }\r\n            };\r\n            /**\r\n             * array de funciones que haran peticiones al services\r\n             */\r\n            $scope.services = {\r\n              getInitial: function () {\r\n                var arrInitialPeticion = [restservices.getAllSmsTwoway($scope.misc.initial, $scope.data.filter)];\r\n                $q.all(arrInitialPeticion).then(function (data) {\r\n                  $scope.functions.setAll(data[0].data);\r\n                }).catch(function (error) {\r\n                  notificationService.error(error.message);\r\n                })\r\n              }\r\n            };\r\n            /**\r\n             * observador para filtros de fecha\r\n             */\r\n            $scope.$watch('[data.filter.dateinitial,data.filter.dateend]', function () {\r\n\r\n              if (angular.isDefined($scope.data.filter.dateinitial) & angular.isDefined($scope.data.filter.dateend)) {\r\n                //console.log($scope.data.filter);\r\n                $scope.services.getInitial();\r\n              }\r\n            });\r\n            //ELIMINAR SMS2WAY\r\n            $scope.cancelSms2way = function (status) {\r\n              restservices.changestatus($scope.node.idSmsTwoway, status).then(function () {\r\n                $scope.functions.clseModal();\r\n                $scope.services.getInitial();\r\n              });\r\n\r\n            };\r\n            $scope.functions.initVariable();\r\n            $scope.functions.getCategory();\r\n            $scope.services.getInitial();\r\n\r\n\r\n          }])\r\n        .controller('speedsent', ['$scope', '$state', 'contantSmstwoway', 'restservices', 'notificationService', '$q', '$window', '$stateParams', 'misc', function ($scope, $state, contantSmstwoway, restservices, notificationService, $q, $window, $stateParams, misc) {\r\n\r\n            //Carga JQuery\r\n            $('.toggle-sms-two-way').bootstrapToggle({\r\n              on: contantSmstwoway.toggleSmsTwoway.toggOn,\r\n              off: contantSmstwoway.toggleSmsTwoway.toggOff,\r\n              onstyle: contantSmstwoway.toggleSmsTwoway.toggOnStyle,\r\n              offstyle: contantSmstwoway.toggleSmsTwoway.toggOffStyle,\r\n              size: contantSmstwoway.toggleSmsTwoway.toggSize\r\n            });\r\n            $.fn.datetimepicker.defaults = {\r\n              maskInput: false,\r\n              pickDate: true,\r\n              pickTime: true,\r\n              startDate: new Date()\r\n            };\r\n            $('.datetimepicker').datetimepicker({\r\n              format: contantSmstwoway.dTPicker.frmt,\r\n              language: contantSmstwoway.dTPicker.lng\r\n            });\r\n\r\n            //Universal functions\r\n            $scope.functions = {\r\n              addResponse: function () {\r\n                $scope.data.typeResponse.push({});\r\n              },\r\n              deleteResponse: function (index) {\r\n                console.log(index);\r\n                $scope.data.typeResponse.splice(index, 1);\r\n              },\r\n              validate: function () {\r\n                if ($stateParams.idSmsTwoway) {\r\n                  $scope.data.idSmsTwoway = $stateParams.idSmsTwoway;\r\n                }\r\n                misc.validationGeneral($scope.data).then(function () {\r\n                  var breaks = (angular.isDefined($scope.data.receiver)) ? $scope.data.receiver.split('\\n') : [];\r\n                  if (!$scope.data.receiver) {\r\n                    slideOnTop(contantSmstwoway.error.messages.msgDestinataries, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                    return;\r\n                  } else if ($scope.data.receiver) {\r\n                    $scope.misc.smsCount = breaks.length;\r\n                    for (var i = 0; i < breaks.length; i++) {\r\n                      if (!breaks[i].includes(\";\")) {\r\n                        slideOnTop(contantSmstwoway.error.messages.msgValidatePuntoYComa, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                        return;\r\n                      }\r\n                      var smscontent = breaks[i].split(\";\");\r\n                      if (!Number(smscontent[0])) {\r\n                        slideOnTop(contantSmstwoway.error.messages.msgIndicative, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                        return;\r\n                      }\r\n\r\n                      if (!Number(smscontent[1])) {\r\n                        slideOnTop(contantSmstwoway.error.messages.msgValidatePhone, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                        return;\r\n                      }\r\n                      if (angular.isUndefined(smscontent[2]) || smscontent[2].length <= 0 || smscontent[2].length > contantSmstwoway.values.messages.msgMaxCharacters) {\r\n                        slideOnTop(contantSmstwoway.error.messages.msgMaxCharacters, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                        return;\r\n                      }\r\n//                      else {\r\n//                        var patternAccents = contantSmstwoway.patterns.accentsMsgDestinataries;\r\n//                        if (patternAccents.test(smscontent[2])) {\r\n//                          slideOnTop(contantSmstwoway.error.messages.msgValidateInvalidCharacters, contantSmstwoway.milliSeconds.fourThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.warning);\r\n//                          return;\r\n//                        }\r\n//                      }\r\n                    }\r\n                    if (breaks.length > contantSmstwoway.values.messages.msgMaxDestinatariesValue) {\r\n                      slideOnTop(contantSmstwoway.error.messages.msgMaxDestinataries, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                      return;\r\n                    }\r\n                  }\r\n                  openModal();\r\n                }).catch(function (message) {\r\n                  slideOnTop(message, 3000, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                })\r\n\r\n              },\r\n              initVariable: function () {\r\n                //Universal Data\r\n                $scope.data = {};\r\n                //set misc\r\n                $scope.misc = {};\r\n                //set Response array \r\n                $scope.data.typeResponse = contantSmstwoway.misc.typeResponseInit;\r\n                //set default gmt(bogota)\r\n                $scope.data.gmt = contantSmstwoway.misc.timeZn;\r\n                //set arrayNumber misc\r\n                $scope.misc.numberSending = new Array(60);\r\n                //set Limit typeResponse\r\n                $scope.misc.limitTypeResponse = contantSmstwoway.misc.limitTypeResponse;\r\n                //set min typeResponse\r\n                $scope.misc.minTypeResponse = contantSmstwoway.misc.minTypeResponse;\r\n                //set timeFormats \r\n                $scope.misc.timeFormats = [{\r\n                    value: contantSmstwoway.misc.minValue,\r\n                    name: contantSmstwoway.misc.minName\r\n                  },\r\n                  {\r\n                    value: contantSmstwoway.misc.hourValue,\r\n                    name: contantSmstwoway.misc.hourName\r\n                  },\r\n                  {\r\n                    value: contantSmstwoway.misc.dayValue,\r\n                    name: contantSmstwoway.misc.dayName\r\n                  },\r\n                  {\r\n                    value: contantSmstwoway.misc.weekValue,\r\n                    name: contantSmstwoway.misc.weekName\r\n                  },\r\n                  {\r\n                    value: contantSmstwoway.misc.monthValue,\r\n                    name: contantSmstwoway.misc.monthName\r\n                  }\r\n                ];\r\n              },\r\n\r\n              setCategory: function (data) {\r\n                for(i=0; i< data.length; i++){\r\n                  if(data[i][\"idSmsCategory\"] == $scope.data.category){\r\n                    $scope.data.category = data[i];\r\n                  }\r\n                }\r\n                $scope.misc.listCategory = data;\r\n              },\r\n              setTimezone: function (data) {\r\n                for(i=0; i< data.length; i++){\r\n                  if(data[i][\"gmt\"] == $scope.data.gmt){\r\n                    $scope.data.gmt = data[i];\r\n                  }\r\n                }\r\n                $scope.misc.listTimezone = data;\r\n              },\r\n            };\r\n            //Functions RestServices\r\n            $scope.restServicesFunction = {\r\n              getAllSmsTwoway: function (data) {\r\n                $scope.misc.listSmsTwoway = data;\r\n              },\r\n              getInitial: function () {\r\n                $scope.functions.initVariable();\r\n                $scope.restServicesFunction.getAllEdit();\r\n                var arrInitialPeticion = [restservices.getCategory(), restservices.getlisttimezone()];\r\n                $q.all(arrInitialPeticion).then(function (data) {\r\n                  $scope.functions.setCategory(data[0]);\r\n                  $scope.functions.setTimezone(data[1].data);\r\n                }).catch(function (error) {})\r\n              },\r\n              setSmsTwoway: function (data) {\r\n                $scope.data.smstwoway = data;\r\n              },\r\n              createLoteTwoway: function () {\r\n                $scope.data.response = JSON.stringify({\r\n                  typeResponse: $scope.data.typeResponse\r\n                });\r\n                restservices.create($scope.data).then(function (data) {\r\n                  closeModal();\r\n                  var route = $window.myBaseURL + contantSmstwoway.routing.smstwowayRoute;\r\n                  $window.location.href = route;\r\n                  slideOnTop(contantSmstwoway.error.messages.msgEnvioExitoso, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.success);\r\n                }).catch(function (res) {\r\n                  slideOnTop(res.message, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                });\r\n              },\r\n              getAllEdit: function () {\r\n                if ($stateParams.idSmsTwoway) {\r\n                  restservices.getDataAll($stateParams.idSmsTwoway).then(function (data) {\r\n                    $scope.data = data;\r\n                    $scope.data.category = data[\"category\"];\r\n                    $scope.data.gmt = data[\"gmt\"];\r\n                    $scope.data.typeResponse = data.typeResponse.typeResponse;\r\n                  }).catch(function (data) {\r\n                  })\r\n                }\r\n              },\r\n              cancel: function () {\r\n                if ($stateParams.idSmsTwoway) {\r\n                  restservices.cancelEdit($stateParams.idSmsTwoway).then(function (data) {\r\n                    var route = $window.myBaseURL + contantSmstwoway.routing.smstwowayRoute;\r\n                    $window.location.href = route;\r\n                  }).catch(function (data) {\r\n                  })\r\n                } else {\r\n                  var route = $window.myBaseURL + contantSmstwoway.routing.smstwowayRoute;\r\n                  $window.location.href = route;\r\n                }\r\n              },\r\n\r\n            }\r\n            $scope.restServicesFunction.getInitial();\r\n          }])\r\n        .controller('createdcontact', ['$scope', '$state', 'contantSmstwoway', 'restservices', '$q', '$window', '$stateParams', function ($scope, $state, contantSmstwoway, restservices, $q, $window, $stateParams) {\r\n            console.log(\"contact\");\r\n            //Carga JQuery\r\n            $('.toggle-sms-two-way').bootstrapToggle({\r\n              on: contantSmstwoway.toggleSmsTwoway.toggOn,\r\n              off: contantSmstwoway.toggleSmsTwoway.toggOff,\r\n              onstyle: contantSmstwoway.toggleSmsTwoway.toggOnStyle,\r\n              offstyle: contantSmstwoway.toggleSmsTwoway.toggOffStyle,\r\n              size: contantSmstwoway.toggleSmsTwoway.toggSize\r\n            });\r\n            $.fn.datetimepicker.defaults = {\r\n              maskInput: false,\r\n              pickDate: true,\r\n              pickTime: true,\r\n              startDate: new Date()\r\n            };\r\n            $('.datetimepicker').datetimepicker({\r\n              format: contantSmstwoway.dTPicker.frmt,\r\n              language: contantSmstwoway.dTPicker.lng\r\n            });\r\n\r\n            $scope.countContactsApproximate = {};\r\n\r\n            $scope.functions = {\r\n              countContacts: function () {\r\n\r\n                var type = '';\r\n                if ($scope.data.listSelected == 1) {\r\n                  type = contantSmstwoway.clType.typeContactList;\r\n                } else {\r\n                  type = contantSmstwoway.clType.typeSegment;\r\n                }\r\n                if (angular.isUndefined($scope.data.arrAddressee) || $scope.data.arrAddressee == 0) {\r\n                  $scope.countContactsApproximate.counts = 0;\r\n                  return;\r\n                }\r\n                var data = {\r\n                  type: type,\r\n                  segment: $scope.data.arrAddressee,\r\n                  contactlist: $scope.data.arrAddressee\r\n                };\r\n                $scope.restServicesFunction.getCountContac(data);\r\n              },\r\n              addTag: function (tag) {\r\n\r\n                if (tangular.isUndefined($scope.data.message)) {\r\n                  $scope.data.message = \"\";\r\n                  $scope.data.message += tag;\r\n                } else {\r\n                  $scope.data.message += \" \" + tag;\r\n                }\r\n\r\n                $scope.functions.validateInLine();\r\n              },\r\n              smstemplate: function (data) {\r\n                $scope.restServicesFunction.getSmsTemplate();\r\n              },\r\n              timeSender: function () {\r\n                for (var i = 1; i <= 60; i++) {\r\n                  $scope.timeSender[i] = i;\r\n                }\r\n                console.log($scope.timeSender);\r\n              },\r\n              addResponse: function () {\r\n                $scope.data.typeResponse.push({});\r\n              },\r\n              deleteResponse: function (index) {\r\n                console.log(index);\r\n                $scope.data.typeResponse.splice(index, 1);\r\n              },\r\n              validate: function () {\r\n\r\n                $scope.error = 0;\r\n                $scope.success = 0;\r\n                var flag = true;\r\n                $scope.arrError = [{}];\r\n                try {\r\n                  if (!$scope.data.sentNow || $scope.data.sentNow == false) {\r\n                    if ($scope.data.timezone == \"\" || angular.isUndefined($scope.data.timezone) || !$scope.data.timezone) {\r\n                      throw(\"Debe seleccionar una zona horaria.\");\r\n                    }\r\n                    if (document.getElementById(\"datesend\").value == \"undefined\" || document.getElementById(\"datesend\").value == \"\") {\r\n                      throw(\"Debe agregar una fecha y hora de envio.\");\r\n                    }\r\n                  }\r\n                  if ($scope.data.email) {\r\n                    var email = $scope.data.email.split(\",\");\r\n                    if (email.length == 0) {\r\n                      throw(\"No se encontro ningun correo electronico.\");\r\n                    }\r\n                    if (email.length > 8) {\r\n                      throw(\"Solo se puede ingresar un máximo de 8 correos electrónicos\");\r\n                    }\r\n                    for (var i = 0; i < email.length; i++) {\r\n                      var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n                      email[i] = email[i].trim();\r\n                      if (!email[i].match(re)) {\r\n                        throw(\"El correo \" + email[i] + \" no es valido.\");\r\n                      }\r\n                    }\r\n                  }\r\n                  if (!$scope.data.idSmsCategory) {\r\n                    throw(\"Debes seleccionar una categoria\");\r\n                  }\r\n                  if (angular.isUndefined($scope.data.listSelected)) {\r\n                    throw(\"Debe seleccionar una lista de destinatarios\");\r\n                  }\r\n                  if (angular.isUndefined($scope.data.arrAddressee) || $scope.data.arrAddressee == 0) {\r\n                    throw (\"Debe seleccionar al menos un segmento o lista de contacto.\");\r\n                  }\r\n                  var re = /[Ã±Ã‘Ã¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÂ¿Â¡Â´]/;\r\n                  if (angular.isUndefined($scope.data.message) || $scope.data.message.length < 2) {\r\n                    throw (\"El mensaje es obligatorio y debe ser mayor a dos caracteres.\");\r\n                  }\r\n                  if (re.test($scope.data.message)) {\r\n                    throw (\"Hay caracteres no válidos en el mensaje\");\r\n                  }\r\n                  if ($scope.data.typeResponse.length == 0) {\r\n                    throw (\"Debe agregar minimo una respuesta con su respectiva homologacion.\");\r\n                  } else {\r\n                    for (var key in $scope.data.typeResponse) {\r\n                      if ((!$scope.data.typeResponse[key].homologate || $scope.data.typeResponse[key].homologate == \"\") || (!$scope.data.typeResponse[key].response || $scope.data.typeResponse[key].response == \"\")) {\r\n                        throw (\"Debe agregar minimo una respuesta con su respectiva homologacion.\");\r\n                      } else {\r\n                        break;\r\n                      }\r\n                    }\r\n                  }\r\n                  $scope.functions.openModal();\r\n                } catch ($err) {\r\n                  slideOnTop($err, 3000, \"glyphicon glyphicon-info-sign\", \"danger\");\r\n                }\r\n              },\r\n              openPreview: function () {\r\n                $(\"#preview\").addClass('dialog--open');\r\n              },\r\n              closePreview: function () {\r\n                $(\"#preview\").removeClass('dialog--open');\r\n              },\r\n              validateInLine: function () {\r\n                $scope.misc.invalidCharacters = false;\r\n                $scope.misc.existTags = false;\r\n                $scope.misc.taggedMessage = $scope.data.message;\r\n                $scope.misc.newMessage = $scope.data.message;\r\n                var re = /[Ã±Ã‘Ã¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÂ¿Â¡Â´]/;\r\n                var tags = /%%+[a-zA-Z0-9_]+%%/;\r\n                var count = 0;\r\n                if (re.test($scope.data.message)) {\r\n                  $scope.misc.invalidCharacters = true;\r\n                }\r\n                if (tags.test($scope.data.message)) {\r\n                  $scope.misc.existTags = true;\r\n                  $scope.misc.taggedMessage = \"\";\r\n                  $scope.misc.newMessage = \"\";\r\n\r\n                  var words = $scope.data.message.split(\" \");\r\n                  for (var cont = 0; cont < words.length; cont++) {\r\n                    var word = words[cont];\r\n                    var word2 = words[cont];\r\n                    if (word.substr(0, 2) == \"%%\" && (word.substr(-2) == \"%%\" || word.substr(-3) == \"%%,\" || word.substr(-3) == \"%%.\" || word.substr(-3) == \"%%;\")) {\r\n                      word = word.substr(2);\r\n                      word2 = \"\";\r\n                      word = \"<b><i>\" + word;\r\n                      if (word.substr(-2) == \"%%\") {\r\n                        word = word.substr(0, word.length - 2);\r\n                      } else if (word.substr(-3) == \"%%,\" || word.substr(-3) == \"%%.\" || word.substr(-3) == \"%%;\") {\r\n                        word = word.substr(0, word.length - 3);\r\n                      }\r\n                      word = word + \"</i></b>\";\r\n                      count = count + word.length;\r\n                    }\r\n                    $scope.misc.taggedMessage += word + \" \";\r\n                    $scope.misc.newMessage += word2 + \" \";\r\n                  }\r\n                }\r\n              },\r\n              openModal: function () {\r\n                $('.dialog').addClass('dialog--open');\r\n              },\r\n              closeModal: function () {\r\n                $('.dialog').removeClass('dialog--open');\r\n              },\r\n              createcontact: function () {\r\n                $scope.data.originalDate = angular.copy(document.getElementById(\"datesend\").value);\r\n                $scope.data.idSmsTwoway = $stateParams.idSmsTwoway;\r\n                var target = {};\r\n                if ($scope.data.listSelected == 1) {\r\n                  target = {type: 'contactlist', contactlists: $scope.data.arrAddressee};\r\n                } else {\r\n                  target = {type: 'segment', segment: $scope.data.arrAddressee};\r\n                }\r\n                $scope.data.receiver = target;\r\n                $scope.data.target = $scope.countContactsApproximate.counts;\r\n                $scope.restServicesFunction.createContact($scope.data);\r\n              },\r\n              setEdit: function () {\r\n                if ($stateParams.idSmsTwoway) {\r\n                  $scope.restServicesFunction.getEdit($stateParams.idSmsTwoway);\r\n                }\r\n              },\r\n              useTemplate: function () {\r\n                angular.forEach($scope.misc.listfullsmstemplate, function (value, key) {\r\n                  if (value.idSmsTemplate == $scope.data.idSmsTemplate) {\r\n                    $scope.functions.addTag(value.content);\r\n                  }\r\n                });\r\n              },\r\n              initializeVariables: function () {\r\n                //Universal Data\r\n                $scope.data = {};\r\n                $scope.data.gmt = \"-0500\";\r\n                //set misc\r\n                $scope.misc = {};\r\n                $scope.misc.listAddressee = [{id: 1, name: \"Lista de contactos\"}, {id: 2, name: \"Segmentos\"}];\r\n                //set Response array \r\n                $scope.data.typeResponse = [];\r\n                $scope.misc.timeFormats = [\r\n                  {value: 'minute', name: \"Minuto(s)\"},\r\n                  {value: 'hour', name: \"Hora(s)\"},\r\n                  {value: 'day', name: \"Día(s)\"},\r\n                  {value: 'week', name: \"Semana(s)\"},\r\n                  {value: 'month', name: \"Mes(es)\"}\r\n                ];\r\n                $scope.misc.arrAddressee = [];\r\n                $scope.viewTemplate = false;\r\n                $scope.timeSender = [];\r\n              },\r\n              changeTitle: function () {\r\n                if ($stateParams.idSmsTwoway) {\r\n                  $scope.misc.title = \"Editar SMS TWOWAY por contacto o segmentos.\";\r\n                } else {\r\n                  $scope.misc.title = \"Crear SMS TWOWAY por contacto o segmentos.\";\r\n                }\r\n              }\r\n            };\r\n            $scope.restServicesFunction = {\r\n              getDetinatary: function (list) {\r\n                $scope.misc.typeDestin = false;\r\n                $scope.showAddressee = false;\r\n                if (list == 1) {\r\n//                  let arrDestinatarylist = restservices.getcontactlist();\r\n                  restservices.getcontactlist().then(function (data) {\r\n                    $scope.showAddressee = true;\r\n                    $scope.misc.listAllAddressee = data;\r\n                  }).catch(function (error) {})\r\n                } else {\r\n//                  let arrDestinataryseg = restservices.getsegments();\r\n                  restservices.getsegments().then(function (data) {\r\n                    $scope.showAddressee = true;\r\n                    $scope.misc.listAllAddressee = data;\r\n                  }).catch(function (error) {})\r\n                }\r\n              },\r\n              setCategory: function (data) {\r\n                $scope.misc.listCategory = data;\r\n              },\r\n              getInitial: function () {\r\n                var arrInitialPeticion = [restservices.getCategory(), restservices.getlisttimezone()];\r\n                $q.all(arrInitialPeticion).then(function (data) {\r\n                  $scope.restServicesFunction.setCategory(data[0]);\r\n                  $scope.restServicesFunction.setTimezone(data[1].data);\r\n                }).catch(function (error) {})\r\n              },\r\n              setTimezone: function (data) {\r\n                $scope.misc.listTimezone = data;\r\n                $scope.data.timezone = \"-0500\";\r\n              },\r\n              getCountContac: function (data) {\r\n                restservices.countContact(data).then(function (data) {\r\n                  $scope.countContactsApproximate = data;\r\n                }).catch(function (error) {\r\n                })\r\n              },\r\n              getSmsTemplate: function () {\r\n                restservices.listfullsmstemplate().then(function (data) {\r\n                  $scope.misc.listfullsmstemplate = data;\r\n                }).catch(function (error) {\r\n\r\n                })\r\n              },\r\n              createContact: function (data) {\r\n\r\n                restservices.savesmstwowaycontact(data).then(function (data) {\r\n                  $scope.functions.closeModal();\r\n                  $window.location.href = contantSmstwoway.urlPeticion.indexSmsTwoway;\r\n                }).catch(function (error) {\r\n\r\n                })\r\n              },\r\n              getEdit: function (data) {\r\n                restservices.getEdit(data).then(function (data) {\r\n                  $scope.restServicesFunction.getDetinatary(data.listSelected);\r\n                  $scope.data = data;\r\n                  $scope.functions.countContacts();\r\n                }).catch(function (error) {\r\n\r\n                })\r\n              }\r\n            };\r\n\r\n            $scope.restServicesFunction.getInitial();\r\n            $scope.functions.setEdit();\r\n            $scope.functions.initializeVariables();\r\n            $scope.functions.changeTitle();\r\n          }])\r\n        .controller('csv', ['$scope', '$state', 'contantSmstwoway', 'restservices', '$q', 'socket', '$stateParams', 'notificationService', 'misc', function ($scope, $state, contantSmstwoway, restservices, $q, socket, $stateParams, notificationService, misc) {\r\n            $scope.validateCheckInternational = false;\r\n            //Carga JQuery\r\n            $('.toggle-sms-two-way').bootstrapToggle({\r\n              on: contantSmstwoway.toggleSmsTwoway.toggOn,\r\n              off: contantSmstwoway.toggleSmsTwoway.toggOff,\r\n              onstyle: contantSmstwoway.toggleSmsTwoway.toggOnStyle,\r\n              offstyle: contantSmstwoway.toggleSmsTwoway.toggOffStyle,\r\n              size: contantSmstwoway.toggleSmsTwoway.toggSize\r\n            });\r\n\r\n            $.fn.datetimepicker.defaults = {\r\n              maskInput: false,\r\n              pickDate: true,\r\n              pickTime: true,\r\n              startDate: new Date()\r\n            };\r\n\r\n            $('.datetimepicker').datetimepicker({\r\n              format: contantSmstwoway.dTPicker.frmt,\r\n              language: contantSmstwoway.dTPicker.lng\r\n            });\r\n\r\n            //Universal Data\r\n            $scope.data = {};\r\n            //set misc\r\n            $scope.misc = {};\r\n            $scope.misc.ProccessCsv = {};\r\n\r\n\r\n            //set SentNow\r\n            $scope.data.dateNow = false;\r\n\r\n            //set optionsAvanced\r\n            $scope.data.advancedoptions = false;\r\n\r\n            //set sendNotification\r\n            $scope.data.notification = false;\r\n\r\n            //set divideSendign\r\n            $scope.data.divide = false;\r\n\r\n            //set Response array \r\n            $scope.data.typeResponse = contantSmstwoway.misc.typeResponseInit;\r\n            //set default gmt(bogota)\r\n            $scope.data.gmt = contantSmstwoway.misc.timeZn;\r\n            //set Limit typeResponse\r\n            $scope.misc.limitTypeResponse = contantSmstwoway.misc.limitTypeResponse;\r\n            //set min typeResponse\r\n            $scope.misc.minTypeResponse = contantSmstwoway.misc.minTypeResponse;\r\n\r\n            //set arrayNumber misc\r\n            $scope.misc.numberSending = new Array(60);\r\n\r\n            //set timeFormats \r\n            $scope.misc.timeFormats = [\r\n              {value: contantSmstwoway.misc.minValue, name: contantSmstwoway.misc.minName},\r\n              {value: contantSmstwoway.misc.hourValue, name: contantSmstwoway.misc.hourName},\r\n              {value: contantSmstwoway.misc.dayValue, name: contantSmstwoway.misc.dayName},\r\n              {value: contantSmstwoway.misc.weekValue, name: contantSmstwoway.misc.weekName},\r\n              {value: contantSmstwoway.misc.monthValue, name: contantSmstwoway.misc.monthName}\r\n            ];\r\n            \r\n            $scope.ValidateCheckInter = function (){\r\n                if($scope.validateCheckInternational == true){\r\n                    slideOnTop(\"Lo sentimos, la cuenta no tiene habilitado envios internacionales, si deseas habilitarlo comunicate con soporte\", 3000, \"glyphicon glyphicon-info-sign\", \"danger\");    \r\n                $scope.data.international = false;\r\n                }\r\n                \r\n            }\r\n            //Universal functions\r\n            $scope.functions = {\r\n\r\n              optionsAvanced: function () {\r\n                if (!$scope.data.advancedoptions || angular.isUndefined($scope.data.advancedoptions)) {\r\n                  $scope.data.advancedoptions = true;\r\n                } else {\r\n                  $scope.data.advancedoptions = false;\r\n                }\r\n              },\r\n              sentNow: function () {\r\n                if (!$scope.data.dateNow || angular.isUndefined($scope.data.dateNow)) {\r\n                  $scope.data.dateNow = true;\r\n                } else {\r\n                  $scope.data.dateNow = false;\r\n                }\r\n              },\r\n              sendNotification: function () {\r\n                if (!$scope.data.notification || angular.isUndefined($scope.data.notification)) {\r\n                  $scope.data.notification = true;\r\n                } else {\r\n                  $scope.data.notification = false;\r\n                }\r\n              },\r\n              divideSending: function () {\r\n                if (!$scope.data.divide || angular.isUndefined($scope.data.divide)) {\r\n                  $scope.data.divide = true;\r\n                } else {\r\n                  $scope.data.divide = false;\r\n                }\r\n              },\r\n              addResponse: function () {\r\n                $scope.data.typeResponse.push({});\r\n              },\r\n              deleteResponse: function (index) {\r\n                console.log($scope.data.typeResponse);\r\n                $scope.data.typeResponse.splice(index, 1);\r\n              },\r\n              validate: function () {\r\n                misc.validationGeneral($scope.data).then(function (data) {\r\n                  if (angular.isUndefined($scope.data.csv) && angular.isUndefined($scope.data.idSmsTwoway)) {\r\n                    slideOnTop(contantSmstwoway.error.messages.msgCsv, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                    return;\r\n                  }\r\n                  if($scope.data.international == true && angular.isUndefined($scope.data.idcountry)){\r\n                    slideOnTop(\"Seleccione un pais para el envio internacional\", contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                    return;\r\n                  }\r\n                  $scope.functions.openModal();\r\n                }).catch(function (message) {\r\n                  slideOnTop(message, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                });\r\n              },\r\n              openModal: function () {\r\n                $('#ProcessCsv').addClass('dialog--open');\r\n              },\r\n              openModalEdit: function () {\r\n                $('#editCsv').addClass('dialog--open');\r\n              },\r\n              closeModalEdit: function () {\r\n                $('#editCsv').removeClass('dialog--open');\r\n              },\r\n              setDataEdit: function (data) {\r\n                $scope.misc.edit = true;\r\n                $scope.data.category = data[\"idSmsCategory\"];\r\n                $scope.data.gmt = data[\"gmt\"];\r\n                angular.forEach(data, function (value, key) {\r\n                  if (key == 'typeResponse') {\r\n                    var typeResponse = JSON.parse(value);\r\n                    $scope.data[key] = typeResponse.typeResponse;\r\n                  } else {\r\n                    $scope.data[key] = value;\r\n                  }\r\n                });\r\n              },\r\n              senitize: function (data, callback) {\r\n                angular.forEach(data, function (value, key) {\r\n                  if (contantSmstwoway.misc.arrBoolean.indexOf(value) >= 0) {\r\n                    data[key] = (value == contantSmstwoway.valueSenitizeCsv.valuSC) ? true : false;\r\n                  }\r\n                });\r\n                callback(data);\r\n              }\r\n            };\r\n            //Functions RestServices\r\n            $scope.restServicesFunction = {\r\n              getAllSmsTwoway: function (data) {\r\n                $scope.misc.listSmsTwoway = data;\r\n              },\r\n              getInitial: function () {\r\n                var arrInitialPeticion = [restservices.getCategory(), restservices.getlisttimezone()];\r\n                $q.all(arrInitialPeticion).then(function (data) {\r\n                  $scope.restServicesFunction.setCategory(data[0]);\r\n                  $scope.restServicesFunction.setTimezone(data[1].data);\r\n                }).catch(function (error) {})\r\n              },\r\n              setCategory: function (data) {\r\n                for(i=0; i< data.length; i++){\r\n                  if(data[i][\"idSmsCategory\"] == $scope.data.category){\r\n                    $scope.data.category = data[i];\r\n                  }\r\n                }\r\n                $scope.misc.listCategory = data;\r\n              },\r\n              setTimezone: function (data) {\r\n                for(i=0; i< data.length; i++){\r\n                  if(data[i][\"gmt\"] == $scope.data.gmt){\r\n                    $scope.data.gmt = data[i];\r\n                  }\r\n                }\r\n                $scope.misc.listTimezone = data;\r\n              },\r\n              setAvalaibleCountry: function (){\r\n                restservices.getAvalaibleCountry().then(function (data) {                  \r\n                  \r\n                  if(data.result != false){\r\n                    $scope.internationalcountries = data.result;\r\n                  }else{\r\n                    $scope.validateCheckInternational = true;\r\n                  }\r\n                }).catch(function () {\r\n\r\n                });\r\n              },\r\n              setSmsTwoway: function (data) {\r\n                $scope.data.smstwoway = data;\r\n              },\r\n              createLoteTwoway: function () {\r\n                if (!$stateParams.idSmsTwoway) {\r\n                  $scope.misc.initProcessUpload = true;\r\n                  $scope.misc.ProccessCsv.porc = contantSmstwoway.csvProcess.csvPorc;\r\n                  $scope.data.response = JSON.stringify({typeResponse: $scope.data.typeResponse});\r\n                  if(angular.isUndefined($scope.data.international)){\r\n                    $scope.data.international = false;\r\n                  }\r\n                  //if($scope.data.idcountry != '' || !angular.isUndefined($scope.data.idcountry)){\r\n//                    var tmp = $scope.data.idcountry;\r\n//                    //$scope.data.idcountry = null;\r\n//                    //$scope.data.idcountry; = tmp.idcountry;\r\n//                  }\r\n                  console.log(\"PASE POR AQUI\",$scope.data);   \r\n                  restservices.createcsv($scope.data).then(function (data) {\r\n\r\n                  }).catch(function (res) {\r\n                    $scope.misc.initProcessUpload = false;\r\n                    closeModal();\r\n                    slideOnTop(res.message, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n                  });\r\n                }else{\r\n                  console.log($scope.data);\r\n                  $scope.data.response = JSON.stringify({\r\n                  typeResponse: $scope.data.typeResponse\r\n                });\r\n                  restservices.editcsv($scope.data).then(function(data){\r\n                  closeModal();\r\n                  $state.go(contantSmstwoway.routing.goState);\r\n                  }).catch(function(res){\r\n                  slideOnTop(res.message, contantSmstwoway.milliSeconds.threeThousand, contantSmstwoway.slideOnTop.classSlide, contantSmstwoway.classToogle.danger);\r\n\r\n                    \r\n                  });\r\n                }\r\n\r\n              },\r\n              changeStatusCsv: function (status) {\r\n                var idSms = false;\r\n                if (angular.isDefined($scope.data.idSmsTwoway)) {\r\n                  idSms = $scope.data.idSmsTwoway;\r\n                } else {\r\n                  idSms = $scope.misc.idSms;\r\n                }\r\n                restservices.changestatus(idSms, status).then(function () {\r\n                  if (angular.isDefined($scope.data.idSmsTwoway)) {\r\n                    $scope.functions.closeModalEdit();\r\n                  } else {\r\n                    $state.go(contantSmstwoway.routing.goState);\r\n                  }\r\n                }).catch(function () {\r\n\r\n                });\r\n              },\r\n              getOneSms: function () {\r\n                restservices.getOne($scope.data.idSmsTwoway).then(function (data) {\r\n                  $scope.functions.senitize(data, $scope.functions.setDataEdit);\r\n//                  $scope.functions.setDataEdit(data);\r\n                }).catch(function (error) {\r\n                  notificationService.error(error.message);\r\n                  $state.go(contantSmstwoway.routing.goState);\r\n                });\r\n              },\r\n              cancel: function () {\r\n                if ($stateParams.idSmsTwoway) {\r\n                  restservices.cancelEdit($stateParams.idSmsTwoway).then(function (data) {\r\n                    var route = $window.myBaseURL + contantSmstwoway.routing.smstwowayRoute;\r\n                    $window.location.href = route;\r\n                  }).catch(function (data) {\r\n\r\n                  })\r\n                } else {\r\n                  var route = $window.myBaseURL + contantSmstwoway.routing.smstwowayRoute;\r\n                  $window.location.href = route;\r\n                }\r\n\r\n              },\r\n            }\r\n\r\n            $scope.socket = {\r\n              searchProcess: function (idSmsTwoway) {\r\n                socket.emit('search-sms-twoway', idSmsTwoway);\r\n              }\r\n            }\r\n            if (angular.isDefined($stateParams.idSmsTwoway) && $stateParams.idSmsTwoway != \"\") {\r\n              $scope.data.idSmsTwoway = $stateParams.idSmsTwoway;\r\n              $scope.functions.openModalEdit();\r\n              $scope.restServicesFunction.getOneSms();\r\n              $scope.restServicesFunction.getInitial();\r\n            } else {\r\n              $scope.restServicesFunction.getInitial();\r\n              $scope.restServicesFunction.setAvalaibleCountry();\r\n            }\r\n\r\n            socket.on('loading-csv-twoway', function (data) {\r\n              if (data.idSubaccount == contantSmstwoway.misc.idSubaccount) {\r\n                if (data.status == contantSmstwoway.statusLoadingCsv.preload) {\r\n                  $scope.misc.ProccessCsv.preload = {};\r\n                  $scope.misc.ProccessCsv.porc += contantSmstwoway.csvProcess.csvPorc;\r\n                }\r\n                if (data.status == contantSmstwoway.statusLoadingCsv.validations) {\r\n                  $scope.misc.ProccessCsv.porc += contantSmstwoway.csvProcess.csvPorc;\r\n                  $scope.misc.ProccessCsv.preload.data = data.data;\r\n                  $scope.misc.ProccessCsv.validations = {};\r\n                }\r\n                if (data.status == contantSmstwoway.statusLoadingCsv.load) {\r\n                  $scope.misc.ProccessCsv.porc += contantSmstwoway.csvProcess.csvPorc;\r\n                  $scope.misc.ProccessCsv.validations.data = data.data;\r\n                  $scope.misc.ProccessCsv.load = {};\r\n                }\r\n                if (data.status == contantSmstwoway.statusLoadingCsv.finish) {\r\n                  $scope.misc.ProccessCsv.porc += contantSmstwoway.csvProcess.csvPorc;\r\n                  $scope.misc.ProccessCsv.load.data = data.data;\r\n                  $scope.misc.ProccessCsv.finish = {};\r\n                  $scope.misc.idSms = data.id;\r\n                  $scope.misc.ProccessCsv.finish.message = data.message;\r\n                }\r\n              }\r\n            });\r\n\r\n            socket.on('process-sms-twoway', function (data) {\r\n              $scope.misc.hideSpinner = true;\r\n              $scope.misc.isProcess = false;\r\n            });\r\n\r\n          }]);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9hbmd1bGFyL3Ntc3R3b3dheS9jb250cm9sbGVycy5qcz9hMWE3Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSwrQkFBK0IsaUJBQWlCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZixhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLFlBQVk7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLG9CQUFvQixlQUFlO0FBQ25DO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxhQUFhLElBQUksWUFBWTtBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsZUFBZTtBQUNmLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixlQUFlO0FBQ2Y7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsNERBQTREO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSwyRUFBMkU7QUFDOUksZUFBZTtBQUNmOztBQUVBLHFFQUFxRSwyRUFBMkU7QUFDaEosZUFBZTtBQUNmO0FBQ0EscUVBQXFFLDJFQUEyRTtBQUNoSixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQSxpRUFBaUUsc0JBQXNCO0FBQ3ZGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixlQUFlO0FBQ2Y7QUFDQTtBQUNBLGVBQWU7QUFDZjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEMsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQSxXQUFXO0FBQ1g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQSxtQ0FBbUMsbUJBQW1CO0FBQ3RELGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQSx5REFBeUQ7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUI7O0FBRWpCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBLHdCQUF3QixnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBLHdCQUF3QixnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDJCQUEyQjtBQUM1QyxlQUFlO0FBQ2Y7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsbUJBQW1CO0FBQ25CO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsbUJBQW1CO0FBQ25CLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSwrQkFBK0IsU0FBUztBQUN4QztBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSxnREFBZ0Q7QUFDaEQsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxrQkFBa0I7QUFDckQsa0RBQWtELHlCQUF5Qiw2QkFBNkIsSUFBSSxRQUFRLElBQUksUUFBUSxJQUFJLFFBQVEsSUFBSSxnQ0FBZ0MsR0FBRztBQUNuTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esb0NBQW9DLHFCQUFxQjtBQUN6RDtBQUNBO0FBQ0EsZ0tBQWdLO0FBQ2hLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIseUZBQXlGO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QixpQkFBaUI7QUFDakIsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxrQ0FBa0MsR0FBRyx5QkFBeUI7QUFDNUc7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLG1DQUFtQztBQUN0RCxtQkFBbUIsK0JBQStCO0FBQ2xELG1CQUFtQiw2QkFBNkI7QUFDaEQsbUJBQW1CLGlDQUFpQztBQUNwRCxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDJCQUEyQjtBQUM5QyxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsMkJBQTJCO0FBQzlDO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwyQkFBMkI7QUFDNUMsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsaUJBQWlCO0FBQ2pCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7O0FBRWpCLGlCQUFpQjtBQUNqQixlQUFlO0FBQ2Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQixpQkFBaUI7QUFDakIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7O0FBRWpCLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsMkVBQTJFO0FBQzFGLGVBQWUsNkVBQTZFO0FBQzVGLGVBQWUsMkVBQTJFO0FBQzFGLGVBQWUsNkVBQTZFO0FBQzVGLGVBQWU7QUFDZjs7QUFFQTtBQUNBO0FBQ0EsbU07QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBLGdEQUFnRDtBQUNoRCxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUI7QUFDakIsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDJCQUEyQjtBQUM1QyxlQUFlO0FBQ2Y7QUFDQSx3QkFBd0IsZ0JBQWdCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSx3QkFBd0IsZ0JBQWdCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSx5RTs7QUFFQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQSxpQkFBaUI7O0FBRWpCLGlCQUFpQjtBQUNqQixlQUFlO0FBQ2Y7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCx1Q0FBdUM7QUFDaEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0EsMkQ7QUFDQTs7QUFFQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25COzs7QUFHQSxtQkFBbUI7QUFDbkI7O0FBRUEsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLGlCQUFpQjs7QUFFakIsaUJBQWlCO0FBQ2pCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1COztBQUVuQixtQkFBbUI7QUFDbkIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQSxlQUFlO0FBQ2Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYixXQUFXIiwiZmlsZSI6IjIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnc21zdHdvd2F5LmNvbnRyb2xsZXJzJywgW10pXHJcbiAgICAgICAgLmZpbHRlcigncHJvcHNGaWx0ZXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGl0ZW1zLCBwcm9wcykge1xyXG4gICAgICAgICAgICB2YXIgb3V0ID0gW107XHJcblxyXG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGl0ZW1zKSkge1xyXG4gICAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMocHJvcHMpO1xyXG5cclxuICAgICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXRlbU1hdGNoZXMgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIHByb3AgPSBrZXlzW2ldO1xyXG4gICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IHByb3BzW3Byb3BdLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChpdGVtW3Byb3BdLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRleHQpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1NYXRjaGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpdGVtTWF0Y2hlcykge1xyXG4gICAgICAgICAgICAgICAgICBvdXQucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAvLyBMZXQgdGhlIG91dHB1dCBiZSB0aGUgaW5wdXQgdW50b3VjaGVkXHJcbiAgICAgICAgICAgICAgb3V0ID0gaXRlbXM7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBvdXQ7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbHRlcignc3BsaXQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGlucHV0LCBzcGxpdENoYXIpIHtcclxuICAgICAgICAgICAgLy8gZG8gc29tZSBib3VuZHMgY2hlY2tpbmcgaGVyZSB0byBlbnN1cmUgaXQgaGFzIHRoYXQgaW5kZXhcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0LnNwbGl0KHNwbGl0Q2hhcik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZGlyZWN0aXZlKCd0eXBlU21zJywgZnVuY3Rpb24gKCRjb21waWxlLCBjb250YW50U21zdHdvd2F5KSB7XHJcbiAgICAgICAgICByZXR1cm57XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYXR0cik7XHJcbiAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gXCJUaXBvOiB7e3N0YXR1c1R5cGV9fVwiO1xyXG4gICAgICAgICAgICAgIHN3aXRjaCAoYXR0ci50eXBlU21zKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnRhbnRTbXN0d293YXkuY2FzZXMuY29udGFjdDpcclxuICAgICAgICAgICAgICAgICAgc2NvcGUuc3RhdHVzVHlwZSA9IGNvbnRhbnRTbXN0d293YXkuc3RhdHVzVHlwZS5jb250YWN0O1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgY29udGFudFNtc3R3b3dheS5jYXNlcy5jc3Y6XHJcbiAgICAgICAgICAgICAgICAgIHNjb3BlLnN0YXR1c1R5cGUgPSBjb250YW50U21zdHdvd2F5LnN0YXR1c1R5cGUuY3N2O1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgY29udGFudFNtc3R3b3dheS5jYXNlcy5zcGVlZFNlbnQ6XHJcbiAgICAgICAgICAgICAgICAgIHNjb3BlLnN0YXR1c1R5cGUgPSBjb250YW50U21zdHdvd2F5LnN0YXR1c1R5cGUuc2VudFNwZWVkO1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgZWxlbWVudC5odG1sKHRlbXBsYXRlKTtcclxuICAgICAgICAgICAgICAkY29tcGlsZShlbGVtZW50LmNvbnRlbnRzKCkpKHNjb3BlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnc3RhdHVzU21zJywgZnVuY3Rpb24gKCRjb21waWxlLCBjb250YW50U21zdHdvd2F5KSB7XHJcbiAgICAgICAgICByZXR1cm57XHJcbiAgICAgICAgICAgIHNjb3BlOiB7c3RhdHVzU21zOiAnQCd9LFxyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHNjb3BlKTtcclxuICAgICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBcIkVzdGFkbzogPHNwYW4gY2xhc3M9J3t7Y2xhc3NTdGF0dXN9fSc+e3t0cmFsYXRlU21zfX08c3Bhbj5cIjtcclxuICAgICAgICAgICAgICBzY29wZS5jaGFuZVN0YXR1cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoc2NvcGUuc3RhdHVzU21zKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgY29udGFudFNtc3R3b3dheS5jYXNlcy5kcmFmdDpcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5jbGFzc1N0YXR1cyA9IGNvbnRhbnRTbXN0d293YXkuY2xhc3NTdC5jb2xvckRyYWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnRyYWxhdGVTbXMgPSBjb250YW50U21zdHdvd2F5LnNtc1RyYW5zbGF0ZS5ib3JyYWRvcjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgY2FzZSBjb250YW50U21zdHdvd2F5LmNhc2VzLnNjaGVkdWxlZDpcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5jbGFzc1N0YXR1cyA9IGNvbnRhbnRTbXN0d293YXkuY2xhc3NTdC5jb2xvclNjaGVkdWxlZDtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS50cmFsYXRlU21zID0gY29udGFudFNtc3R3b3dheS5zbXNUcmFuc2xhdGUucHJvZ3JhbWFkbztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgY2FzZSBjb250YW50U21zdHdvd2F5LmNhc2VzLnBlbmRpbmc6XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2xhc3NTdGF0dXMgPSBjb250YW50U21zdHdvd2F5LmNsYXNzU3QuY29sb3JQZW5kaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnRyYWxhdGVTbXMgPSBjb250YW50U21zdHdvd2F5LnNtc1RyYW5zbGF0ZS5wZW5kaWVudGU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgY29udGFudFNtc3R3b3dheS5jYXNlcy5zZW5kaW5nOlxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmNsYXNzU3RhdHVzID0gY29udGFudFNtc3R3b3dheS5jbGFzc1N0LmNvbG9yU2VuZGluZztcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS50cmFsYXRlU21zID0gY29udGFudFNtc3R3b3dheS5zbXNUcmFuc2xhdGUuZW5Qcm9jZXNvRGVFbnZpbztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgY2FzZSBjb250YW50U21zdHdvd2F5LmNhc2VzLnNlbnQ6XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2xhc3NTdGF0dXMgPSBjb250YW50U21zdHdvd2F5LmNsYXNzU3QuY29sb3JTZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnRyYWxhdGVTbXMgPSBjb250YW50U21zdHdvd2F5LnNtc1RyYW5zbGF0ZS5lbnZpYWRvO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICBjYXNlIGNvbnRhbnRTbXN0d293YXkuY2FzZXMucGF1c2VkOlxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmNsYXNzU3RhdHVzID0gY29udGFudFNtc3R3b3dheS5jbGFzc1N0LmNvbG9yUGF1c2VkO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnRyYWxhdGVTbXMgPSBjb250YW50U21zdHdvd2F5LnNtc1RyYW5zbGF0ZS5wYXVzYWRvO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICBjYXNlIGNvbnRhbnRTbXN0d293YXkuY2FzZXMuY2FuY2VsZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2xhc3NTdGF0dXMgPSBjb250YW50U21zdHdvd2F5LmNsYXNzU3QuY29sb3JDYW5jZWxlZDE7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudHJhbGF0ZVNtcyA9IGNvbnRhbnRTbXN0d293YXkuc21zVHJhbnNsYXRlLmNhbmNlbGFkbztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgY2FzZSBjb250YW50U21zdHdvd2F5LmNhc2VzLnVuZGVsaXZlcmVkOlxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmNsYXNzU3RhdHVzID0gY29udGFudFNtc3R3b3dheS5jbGFzc1N0LmNvbG9yQ2FuY2VsZWQyO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnRyYWxhdGVTbXMgPSBjb250YW50U21zdHdvd2F5LnNtc1RyYW5zbGF0ZS5ub0VudmlhZG87XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goJ3N0YXR1c1NtcycsIGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS5jaGFuZVN0YXR1cygpO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5odG1sKHRlbXBsYXRlKTtcclxuICAgICAgICAgICAgICAgICRjb21waWxlKGVsZW1lbnQuY29udGVudHMoKSkoc2NvcGUpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHNjb3BlLmNoYW5lU3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgZWxlbWVudC5odG1sKHRlbXBsYXRlKTtcclxuICAgICAgICAgICAgICAkY29tcGlsZShlbGVtZW50LmNvbnRlbnRzKCkpKHNjb3BlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZhY3RvcnkoJ3NvY2tldCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBvbjogZnVuY3Rpb24gKGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICBzb2NrZXQub24oZXZlbnROYW1lLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkoc29ja2V0LCBhcmdzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlbWl0OiBmdW5jdGlvbiAoZXZlbnROYW1lLCBkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgIHNvY2tldC5lbWl0KGV2ZW50TmFtZSwgZGF0YSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHNvY2tldCwgYXJncyk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5kaXJlY3RpdmUoXCJmaWxlcmVhZFwiLCBbZnVuY3Rpb24gKGNvbnRhbnRTbXN0d293YXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICAgICAgZmlsZXJlYWQ6IGNvbnRhbnRTbXN0d293YXkuZXF1YWxGUi5lcXVhbEZpbGVSZWFkXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuYmluZChcImNoYW5nZVwiLCBmdW5jdGlvbiAoY2hhbmdlRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAobG9hZEV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmZpbGVyZWFkID0gbG9hZEV2ZW50LnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoY2hhbmdlRXZlbnQudGFyZ2V0LmZpbGVzWzBdKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfV0pXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnZmlsZU1vZGVsJywgWyckcGFyc2UnLCBmdW5jdGlvbiAoJHBhcnNlLCBjb250YW50U21zdHdvd2F5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSAkcGFyc2UoYXR0cnMuZmlsZU1vZGVsKTtcclxuICAgICAgICAgICAgICAgIHZhciBtb2RlbFNldHRlciA9IG1vZGVsLmFzc2lnbjtcclxuXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbFNldHRlcihzY29wZSwgZWxlbWVudFswXS5maWxlc1swXSk7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfV0pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3Rvb2xzJywgWyckc2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlKSB7fV0pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ21haW4nLCBbJyRzY29wZScsICckc3RhdGUnLCAnY29udGFudFNtc3R3b3dheScsICdyZXN0c2VydmljZXMnLCAnJHEnLCAnbm90aWZpY2F0aW9uU2VydmljZScsICdzb2NrZXQnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGUsIGNvbnRhbnRTbXN0d293YXksIHJlc3RzZXJ2aWNlcywgJHEsIG5vdGlmaWNhdGlvblNlcnZpY2UsIHNvY2tldCkge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogYXJheSBkZSBsb3Mgc29ja2V0cyBxdWUgc2UgdXNhbiBlbiBub2QuanNcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICRzY29wZS5zb2NrZXRzID0ge1xyXG4gICAgICAgICAgICAgIGNhbmNlbFNlbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KGNvbnRhbnRTbXN0d293YXkuc2NrdHMuc3RvcFNtc1R3b3dheSwge2lkU21zVHdvd2F5OiAkc2NvcGUubm9kZS5pZFNtc1R3b3dheSwgZnVuYzogY29udGFudFNtc3R3b3dheS5mdW5jTm9kZS5jYW5jfSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBwYXVzZWRTZW50OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc29ja2V0LmVtaXQoY29udGFudFNtc3R3b3dheS5zY2t0cy5wYXVzZWRTbXNUd293YXksIHtpZFNtc1R3b3dheTogJHNjb3BlLm5vZGUuaWRTbXNUd293YXksIGZ1bmM6IGNvbnRhbnRTbXN0d293YXkuZnVuY05vZGUucGF1c30pO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgcmVzdW1lblNlbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KGNvbnRhbnRTbXN0d293YXkuc2NrdHMucmVzdW1lU21zVHdvd2F5LCB7aWRTbXNUd293YXk6ICRzY29wZS5ub2RlLmlkU21zVHdvd2F5LCBmdW5jOiBjb250YW50U21zdHdvd2F5LmZ1bmNOb2RlLnNjaGV9KTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGV4ZWN1dGVGdW5jdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gc3dpdGNoICgkc2NvcGUubm9kZS5zdGF0dXMpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgY2FzZSBjb250YW50U21zdHdvd2F5LmNhc2VzTm9kZS5jYW5jZWw6XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgJHNjb3BlLnNvY2tldHMuY2FuY2VsU2VudCgpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgLy8gICBjYXNlIGNvbnRhbnRTbXN0d293YXkuY2FzZXNOb2RlLnBhdTpcclxuICAgICAgICAgICAgICAgIC8vICAgICAkc2NvcGUuc29ja2V0cy5wYXVzZWRTZW50KCk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAvLyAgIGNhc2UgY29udGFudFNtc3R3b3dheS5jYXNlc05vZGUuY29udGluOlxyXG4gICAgICAgICAgICAgICAgLy8gICAgICRzY29wZS5zb2NrZXRzLnJlc3VtZW5TZW50KCk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICByZXN0c2VydmljZXMuY2hhbmdlc3RhdHVzKCRzY29wZS5ub2RlLmlkU21zVHdvd2F5LCAkc2NvcGUubm9kZS5zdGF0dXMpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZnVuY3Rpb25zLmNsc2VNb2RhbCgpO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZXMuZ2V0SW5pdGlhbCgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUudmFsaWRhdGVEYXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICByZXN0c2VydmljZXMudmFsaWRhdGVEYXRlKGRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge30pLmNhdGNoKGZ1bmN0aW9uICgpIHt9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogbGxhbWFkbyBhbCBzb2tlZCBxdWUgZXNjdWNoYSBsYXMgcmVzcHVlc3RhcyBkZSBub2QuanNcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHNvY2tldC5vbihjb250YW50U21zdHdvd2F5LnNja3RzLnJlZnJlc2hWaWV3U21zVHdvV2F5LCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgIGZvciAoaSBpbiAkc2NvcGUubWlzYy5zbXN0d293YXkuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubWlzYy5zbXN0d293YXkuaXRlbXNbaV0uaWRTbXNUd293YXkgPT0gZGF0YS5pZFNtcykge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5zbXN0d293YXkuaXRlbXNbaV0uc3RhdHVzID0gZGF0YS5zdGF0dXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHNvY2tldC5vbihjb250YW50U21zdHdvd2F5LnNja3RzLnByb2Nlc3NTbXNUd29XYXksIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5yZXNwb25zZU5vZGUoZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogYXJyYXkgZGUgZnVuY2lvbmVzIHF1ZSBzZSB1dGlsaXphbiBlbiBlbCBmcm9udCBuZXQgXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAkc2NvcGUuZnVuY3Rpb25zID0ge1xyXG4gICAgICAgICAgICAgIHNlYXJjaGNhdGVnb3J5OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmRhdGEuZmlsdGVyLmNhdGVnb3J5Lmxlbmd0aCA+PSBjb250YW50U21zdHdvd2F5LnZhbHVlcy5tZXNzYWdlcy5pbml0VmFsdWVPbmUpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VzLmdldEluaXRpYWwoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5zZXJ2aWNlcy5nZXRJbml0aWFsKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBnZXRDYXRlZ29yeTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLmdldENhdGVnb3J5KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc21zQ2F0ZWdvcnkgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBzZXRBbGw6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5zbXN0d293YXkgPSBkYXRhO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZm9yd2FyZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5taXNjLmluaXRpYWwgKz0gY29udGFudFNtc3R3b3dheS52YWx1ZXMubWVzc2FnZXMuaW5pdFZhbHVlT25lO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MucGFnZSArPSBjb250YW50U21zdHdvd2F5LnZhbHVlcy5tZXNzYWdlcy5pbml0VmFsdWVPbmU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZXMuZ2V0SW5pdGlhbCgpO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZmFzdGZvcndhcmQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5pbml0aWFsID0gKCRzY29wZS5taXNjLnNtc3R3b3dheS50b3RhbF9wYWdlcyAtIGNvbnRhbnRTbXN0d293YXkudmFsdWVzLm1lc3NhZ2VzLmluaXRWYWx1ZU9uZSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5wYWdlID0gJHNjb3BlLm1pc2Muc21zdHdvd2F5LnRvdGFsX3BhZ2VzO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VzLmdldEluaXRpYWwoKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGJhY2t3YXJkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MuaW5pdGlhbCAtPSBjb250YW50U21zdHdvd2F5LnZhbHVlcy5tZXNzYWdlcy5pbml0VmFsdWVPbmU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5wYWdlIC09IGNvbnRhbnRTbXN0d293YXkudmFsdWVzLm1lc3NhZ2VzLmluaXRWYWx1ZU9uZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zZXJ2aWNlcy5nZXRJbml0aWFsKCk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBmYXN0YmFja3dhcmQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5pbml0aWFsID0gY29udGFudFNtc3R3b3dheS52YWx1ZXMubWVzc2FnZXMuaW5pdFZhbHVlWmVybztcclxuICAgICAgICAgICAgICAgICRzY29wZS5taXNjLnBhZ2UgPSBjb250YW50U21zdHdvd2F5LnZhbHVlcy5tZXNzYWdlcy5pbml0VmFsdWVPbmU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZXMuZ2V0SW5pdGlhbCgpO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgc2VhcmNoOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZXMuZ2V0SW5pdGlhbCgpO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgaW5pdFZhcmlhYmxlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm5vZGUgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5taXNjID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5pbml0aWFsID0gMDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5taXNjLnBhZ2UgPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuZmlsdGVyID0ge2NhdGVnb3J5OiBbXX07XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBvcGVuTW9kYWw6IGZ1bmN0aW9uIChpZCwgc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZS5zdGF0dXMgPSBzdGF0dXM7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZS5pZFNtc1R3b3dheSA9IGlkO1xyXG4gICAgICAgICAgICAgICAgJCgnI2NhbmNlbERpYWxvZycpLmFkZENsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGNsc2VNb2RhbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJCgnI2NhbmNlbERpYWxvZycpLnJlbW92ZUNsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHJlc3BvbnNlTm9kZTogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMuY2xzZU1vZGFsKCk7XHJcbiAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZGF0YS50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBjb250YW50U21zdHdvd2F5LmNhc2VSZXNwb25zZU5vZGUuY2FzZU9uZTpcclxuICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2Uud2FybmluZyhkYXRhLnJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29udGFudFNtc3R3b3dheS5jYXNlUmVzcG9uc2VOb2RlLmNhc2VUd286XHJcbiAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmluZm8oZGF0YS5yZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnRhbnRTbXN0d293YXkuY2FzZVJlc3BvbnNlTm9kZS5jYXNlVGhyZWU6XHJcbiAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLnN1Y2Nlc3MoZGF0YS5yZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIGFycmF5IGRlIGZ1bmNpb25lcyBxdWUgaGFyYW4gcGV0aWNpb25lcyBhbCBzZXJ2aWNlc1xyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VzID0ge1xyXG4gICAgICAgICAgICAgIGdldEluaXRpYWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhcnJJbml0aWFsUGV0aWNpb24gPSBbcmVzdHNlcnZpY2VzLmdldEFsbFNtc1R3b3dheSgkc2NvcGUubWlzYy5pbml0aWFsLCAkc2NvcGUuZGF0YS5maWx0ZXIpXTtcclxuICAgICAgICAgICAgICAgICRxLmFsbChhcnJJbml0aWFsUGV0aWNpb24pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5zZXRBbGwoZGF0YVswXS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBvYnNlcnZhZG9yIHBhcmEgZmlsdHJvcyBkZSBmZWNoYVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgnW2RhdGEuZmlsdGVyLmRhdGVpbml0aWFsLGRhdGEuZmlsdGVyLmRhdGVlbmRdJywgZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoJHNjb3BlLmRhdGEuZmlsdGVyLmRhdGVpbml0aWFsKSAmIGFuZ3VsYXIuaXNEZWZpbmVkKCRzY29wZS5kYXRhLmZpbHRlci5kYXRlZW5kKSkge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygkc2NvcGUuZGF0YS5maWx0ZXIpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VzLmdldEluaXRpYWwoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL0VMSU1JTkFSIFNNUzJXQVlcclxuICAgICAgICAgICAgJHNjb3BlLmNhbmNlbFNtczJ3YXkgPSBmdW5jdGlvbiAoc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLmNoYW5nZXN0YXR1cygkc2NvcGUubm9kZS5pZFNtc1R3b3dheSwgc3RhdHVzKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMuY2xzZU1vZGFsKCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZXMuZ2V0SW5pdGlhbCgpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5pbml0VmFyaWFibGUoKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5nZXRDYXRlZ29yeSgpO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2VydmljZXMuZ2V0SW5pdGlhbCgpO1xyXG5cclxuXHJcbiAgICAgICAgICB9XSlcclxuICAgICAgICAuY29udHJvbGxlcignc3BlZWRzZW50JywgWyckc2NvcGUnLCAnJHN0YXRlJywgJ2NvbnRhbnRTbXN0d293YXknLCAncmVzdHNlcnZpY2VzJywgJ25vdGlmaWNhdGlvblNlcnZpY2UnLCAnJHEnLCAnJHdpbmRvdycsICckc3RhdGVQYXJhbXMnLCAnbWlzYycsIGZ1bmN0aW9uICgkc2NvcGUsICRzdGF0ZSwgY29udGFudFNtc3R3b3dheSwgcmVzdHNlcnZpY2VzLCBub3RpZmljYXRpb25TZXJ2aWNlLCAkcSwgJHdpbmRvdywgJHN0YXRlUGFyYW1zLCBtaXNjKSB7XHJcblxyXG4gICAgICAgICAgICAvL0NhcmdhIEpRdWVyeVxyXG4gICAgICAgICAgICAkKCcudG9nZ2xlLXNtcy10d28td2F5JykuYm9vdHN0cmFwVG9nZ2xlKHtcclxuICAgICAgICAgICAgICBvbjogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09uLFxyXG4gICAgICAgICAgICAgIG9mZjogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09mZixcclxuICAgICAgICAgICAgICBvbnN0eWxlOiBjb250YW50U21zdHdvd2F5LnRvZ2dsZVNtc1R3b3dheS50b2dnT25TdHlsZSxcclxuICAgICAgICAgICAgICBvZmZzdHlsZTogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09mZlN0eWxlLFxyXG4gICAgICAgICAgICAgIHNpemU6IGNvbnRhbnRTbXN0d293YXkudG9nZ2xlU21zVHdvd2F5LnRvZ2dTaXplXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkLmZuLmRhdGV0aW1lcGlja2VyLmRlZmF1bHRzID0ge1xyXG4gICAgICAgICAgICAgIG1hc2tJbnB1dDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgcGlja0RhdGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgcGlja1RpbWU6IHRydWUsXHJcbiAgICAgICAgICAgICAgc3RhcnREYXRlOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICQoJy5kYXRldGltZXBpY2tlcicpLmRhdGV0aW1lcGlja2VyKHtcclxuICAgICAgICAgICAgICBmb3JtYXQ6IGNvbnRhbnRTbXN0d293YXkuZFRQaWNrZXIuZnJtdCxcclxuICAgICAgICAgICAgICBsYW5ndWFnZTogY29udGFudFNtc3R3b3dheS5kVFBpY2tlci5sbmdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvL1VuaXZlcnNhbCBmdW5jdGlvbnNcclxuICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucyA9IHtcclxuICAgICAgICAgICAgICBhZGRSZXNwb25zZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEudHlwZVJlc3BvbnNlLnB1c2goe30pO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZGVsZXRlUmVzcG9uc2U6IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEudHlwZVJlc3BvbnNlLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5pZFNtc1R3b3dheSA9ICRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG1pc2MudmFsaWRhdGlvbkdlbmVyYWwoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgYnJlYWtzID0gKGFuZ3VsYXIuaXNEZWZpbmVkKCRzY29wZS5kYXRhLnJlY2VpdmVyKSkgPyAkc2NvcGUuZGF0YS5yZWNlaXZlci5zcGxpdCgnXFxuJykgOiBbXTtcclxuICAgICAgICAgICAgICAgICAgaWYgKCEkc2NvcGUuZGF0YS5yZWNlaXZlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlT25Ub3AoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dEZXN0aW5hdGFyaWVzLCBjb250YW50U21zdHdvd2F5Lm1pbGxpU2Vjb25kcy50aHJlZVRob3VzYW5kLCBjb250YW50U21zdHdvd2F5LnNsaWRlT25Ub3AuY2xhc3NTbGlkZSwgY29udGFudFNtc3R3b3dheS5jbGFzc1Rvb2dsZS5kYW5nZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUuZGF0YS5yZWNlaXZlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLnNtc0NvdW50ID0gYnJlYWtzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJyZWFrcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKCFicmVha3NbaV0uaW5jbHVkZXMoXCI7XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlT25Ub3AoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dWYWxpZGF0ZVB1bnRvWUNvbWEsIGNvbnRhbnRTbXN0d293YXkubWlsbGlTZWNvbmRzLnRocmVlVGhvdXNhbmQsIGNvbnRhbnRTbXN0d293YXkuc2xpZGVPblRvcC5jbGFzc1NsaWRlLCBjb250YW50U21zdHdvd2F5LmNsYXNzVG9vZ2xlLmRhbmdlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgIHZhciBzbXNjb250ZW50ID0gYnJlYWtzW2ldLnNwbGl0KFwiO1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmICghTnVtYmVyKHNtc2NvbnRlbnRbMF0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlT25Ub3AoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dJbmRpY2F0aXZlLCBjb250YW50U21zdHdvd2F5Lm1pbGxpU2Vjb25kcy50aHJlZVRob3VzYW5kLCBjb250YW50U21zdHdvd2F5LnNsaWRlT25Ub3AuY2xhc3NTbGlkZSwgY29udGFudFNtc3R3b3dheS5jbGFzc1Rvb2dsZS5kYW5nZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIoc21zY29udGVudFsxXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVPblRvcChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ1ZhbGlkYXRlUGhvbmUsIGNvbnRhbnRTbXN0d293YXkubWlsbGlTZWNvbmRzLnRocmVlVGhvdXNhbmQsIGNvbnRhbnRTbXN0d293YXkuc2xpZGVPblRvcC5jbGFzc1NsaWRlLCBjb250YW50U21zdHdvd2F5LmNsYXNzVG9vZ2xlLmRhbmdlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHNtc2NvbnRlbnRbMl0pIHx8IHNtc2NvbnRlbnRbMl0ubGVuZ3RoIDw9IDAgfHwgc21zY29udGVudFsyXS5sZW5ndGggPiBjb250YW50U21zdHdvd2F5LnZhbHVlcy5tZXNzYWdlcy5tc2dNYXhDaGFyYWN0ZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlT25Ub3AoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dNYXhDaGFyYWN0ZXJzLCBjb250YW50U21zdHdvd2F5Lm1pbGxpU2Vjb25kcy50aHJlZVRob3VzYW5kLCBjb250YW50U21zdHdvd2F5LnNsaWRlT25Ub3AuY2xhc3NTbGlkZSwgY29udGFudFNtc3R3b3dheS5jbGFzc1Rvb2dsZS5kYW5nZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuQWNjZW50cyA9IGNvbnRhbnRTbXN0d293YXkucGF0dGVybnMuYWNjZW50c01zZ0Rlc3RpbmF0YXJpZXM7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhdHRlcm5BY2NlbnRzLnRlc3Qoc21zY29udGVudFsyXSkpIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlT25Ub3AoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dWYWxpZGF0ZUludmFsaWRDaGFyYWN0ZXJzLCBjb250YW50U21zdHdvd2F5Lm1pbGxpU2Vjb25kcy5mb3VyVGhvdXNhbmQsIGNvbnRhbnRTbXN0d293YXkuc2xpZGVPblRvcC5jbGFzc1NsaWRlLCBjb250YW50U21zdHdvd2F5LmNsYXNzVG9vZ2xlLndhcm5pbmcpO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoYnJlYWtzLmxlbmd0aCA+IGNvbnRhbnRTbXN0d293YXkudmFsdWVzLm1lc3NhZ2VzLm1zZ01heERlc3RpbmF0YXJpZXNWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgc2xpZGVPblRvcChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ01heERlc3RpbmF0YXJpZXMsIGNvbnRhbnRTbXN0d293YXkubWlsbGlTZWNvbmRzLnRocmVlVGhvdXNhbmQsIGNvbnRhbnRTbXN0d293YXkuc2xpZGVPblRvcC5jbGFzc1NsaWRlLCBjb250YW50U21zdHdvd2F5LmNsYXNzVG9vZ2xlLmRhbmdlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIG9wZW5Nb2RhbCgpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgc2xpZGVPblRvcChtZXNzYWdlLCAzMDAwLCBjb250YW50U21zdHdvd2F5LnNsaWRlT25Ub3AuY2xhc3NTbGlkZSwgY29udGFudFNtc3R3b3dheS5jbGFzc1Rvb2dsZS5kYW5nZXIpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBpbml0VmFyaWFibGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIC8vVW5pdmVyc2FsIERhdGFcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICAvL3NldCBtaXNjXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgLy9zZXQgUmVzcG9uc2UgYXJyYXkgXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2UgPSBjb250YW50U21zdHdvd2F5Lm1pc2MudHlwZVJlc3BvbnNlSW5pdDtcclxuICAgICAgICAgICAgICAgIC8vc2V0IGRlZmF1bHQgZ210KGJvZ290YSlcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmdtdCA9IGNvbnRhbnRTbXN0d293YXkubWlzYy50aW1lWm47XHJcbiAgICAgICAgICAgICAgICAvL3NldCBhcnJheU51bWJlciBtaXNjXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5udW1iZXJTZW5kaW5nID0gbmV3IEFycmF5KDYwKTtcclxuICAgICAgICAgICAgICAgIC8vc2V0IExpbWl0IHR5cGVSZXNwb25zZVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MubGltaXRUeXBlUmVzcG9uc2UgPSBjb250YW50U21zdHdvd2F5Lm1pc2MubGltaXRUeXBlUmVzcG9uc2U7XHJcbiAgICAgICAgICAgICAgICAvL3NldCBtaW4gdHlwZVJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5taW5UeXBlUmVzcG9uc2UgPSBjb250YW50U21zdHdvd2F5Lm1pc2MubWluVHlwZVJlc3BvbnNlO1xyXG4gICAgICAgICAgICAgICAgLy9zZXQgdGltZUZvcm1hdHMgXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy50aW1lRm9ybWF0cyA9IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy5taW5WYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBjb250YW50U21zdHdvd2F5Lm1pc2MubWluTmFtZVxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy5ob3VyVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogY29udGFudFNtc3R3b3dheS5taXNjLmhvdXJOYW1lXHJcbiAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY29udGFudFNtc3R3b3dheS5taXNjLmRheVZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy5kYXlOYW1lXHJcbiAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY29udGFudFNtc3R3b3dheS5taXNjLndlZWtWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBjb250YW50U21zdHdvd2F5Lm1pc2Mud2Vla05hbWVcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBjb250YW50U21zdHdvd2F5Lm1pc2MubW9udGhWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBjb250YW50U21zdHdvd2F5Lm1pc2MubW9udGhOYW1lXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgICAgc2V0Q2F0ZWdvcnk6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IoaT0wOyBpPCBkYXRhLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICAgaWYoZGF0YVtpXVtcImlkU21zQ2F0ZWdvcnlcIl0gPT0gJHNjb3BlLmRhdGEuY2F0ZWdvcnkpe1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNhdGVnb3J5ID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MubGlzdENhdGVnb3J5ID0gZGF0YTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHNldFRpbWV6b25lOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgZm9yKGk9MDsgaTwgZGF0YS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICAgIGlmKGRhdGFbaV1bXCJnbXRcIl0gPT0gJHNjb3BlLmRhdGEuZ210KXtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5nbXQgPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5saXN0VGltZXpvbmUgPSBkYXRhO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vRnVuY3Rpb25zIFJlc3RTZXJ2aWNlc1xyXG4gICAgICAgICAgICAkc2NvcGUucmVzdFNlcnZpY2VzRnVuY3Rpb24gPSB7XHJcbiAgICAgICAgICAgICAgZ2V0QWxsU21zVHdvd2F5OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MubGlzdFNtc1R3b3dheSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBnZXRJbml0aWFsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZnVuY3Rpb25zLmluaXRWYXJpYWJsZSgpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlc3RTZXJ2aWNlc0Z1bmN0aW9uLmdldEFsbEVkaXQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBhcnJJbml0aWFsUGV0aWNpb24gPSBbcmVzdHNlcnZpY2VzLmdldENhdGVnb3J5KCksIHJlc3RzZXJ2aWNlcy5nZXRsaXN0dGltZXpvbmUoKV07XHJcbiAgICAgICAgICAgICAgICAkcS5hbGwoYXJySW5pdGlhbFBldGljaW9uKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMuc2V0Q2F0ZWdvcnkoZGF0YVswXSk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMuc2V0VGltZXpvbmUoZGF0YVsxXS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge30pXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBzZXRTbXNUd293YXk6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zbXN0d293YXkgPSBkYXRhO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgY3JlYXRlTG90ZVR3b3dheTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucmVzcG9uc2UgPSBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICAgIHR5cGVSZXNwb25zZTogJHNjb3BlLmRhdGEudHlwZVJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJlc3RzZXJ2aWNlcy5jcmVhdGUoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgY2xvc2VNb2RhbCgpO1xyXG4gICAgICAgICAgICAgICAgICB2YXIgcm91dGUgPSAkd2luZG93Lm15QmFzZVVSTCArIGNvbnRhbnRTbXN0d293YXkucm91dGluZy5zbXN0d293YXlSb3V0ZTtcclxuICAgICAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcm91dGU7XHJcbiAgICAgICAgICAgICAgICAgIHNsaWRlT25Ub3AoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dFbnZpb0V4aXRvc28sIGNvbnRhbnRTbXN0d293YXkubWlsbGlTZWNvbmRzLnRocmVlVGhvdXNhbmQsIGNvbnRhbnRTbXN0d293YXkuc2xpZGVPblRvcC5jbGFzc1NsaWRlLCBjb250YW50U21zdHdvd2F5LmNsYXNzVG9vZ2xlLnN1Y2Nlc3MpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICBzbGlkZU9uVG9wKHJlcy5tZXNzYWdlLCBjb250YW50U21zdHdvd2F5Lm1pbGxpU2Vjb25kcy50aHJlZVRob3VzYW5kLCBjb250YW50U21zdHdvd2F5LnNsaWRlT25Ub3AuY2xhc3NTbGlkZSwgY29udGFudFNtc3R3b3dheS5jbGFzc1Rvb2dsZS5kYW5nZXIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBnZXRBbGxFZGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLmlkU21zVHdvd2F5KSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlc3RzZXJ2aWNlcy5nZXREYXRhQWxsKCRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jYXRlZ29yeSA9IGRhdGFbXCJjYXRlZ29yeVwiXTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5nbXQgPSBkYXRhW1wiZ210XCJdO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnR5cGVSZXNwb25zZSA9IGRhdGEudHlwZVJlc3BvbnNlLnR5cGVSZXNwb25zZTtcclxuICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheSkge1xyXG4gICAgICAgICAgICAgICAgICByZXN0c2VydmljZXMuY2FuY2VsRWRpdCgkc3RhdGVQYXJhbXMuaWRTbXNUd293YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcm91dGUgPSAkd2luZG93Lm15QmFzZVVSTCArIGNvbnRhbnRTbXN0d293YXkucm91dGluZy5zbXN0d293YXlSb3V0ZTtcclxuICAgICAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLmhyZWYgPSByb3V0ZTtcclxuICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciByb3V0ZSA9ICR3aW5kb3cubXlCYXNlVVJMICsgY29udGFudFNtc3R3b3dheS5yb3V0aW5nLnNtc3R3b3dheVJvdXRlO1xyXG4gICAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLmhyZWYgPSByb3V0ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkc2NvcGUucmVzdFNlcnZpY2VzRnVuY3Rpb24uZ2V0SW5pdGlhbCgpO1xyXG4gICAgICAgICAgfV0pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ2NyZWF0ZWRjb250YWN0JywgWyckc2NvcGUnLCAnJHN0YXRlJywgJ2NvbnRhbnRTbXN0d293YXknLCAncmVzdHNlcnZpY2VzJywgJyRxJywgJyR3aW5kb3cnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24gKCRzY29wZSwgJHN0YXRlLCBjb250YW50U21zdHdvd2F5LCByZXN0c2VydmljZXMsICRxLCAkd2luZG93LCAkc3RhdGVQYXJhbXMpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb250YWN0XCIpO1xyXG4gICAgICAgICAgICAvL0NhcmdhIEpRdWVyeVxyXG4gICAgICAgICAgICAkKCcudG9nZ2xlLXNtcy10d28td2F5JykuYm9vdHN0cmFwVG9nZ2xlKHtcclxuICAgICAgICAgICAgICBvbjogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09uLFxyXG4gICAgICAgICAgICAgIG9mZjogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09mZixcclxuICAgICAgICAgICAgICBvbnN0eWxlOiBjb250YW50U21zdHdvd2F5LnRvZ2dsZVNtc1R3b3dheS50b2dnT25TdHlsZSxcclxuICAgICAgICAgICAgICBvZmZzdHlsZTogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09mZlN0eWxlLFxyXG4gICAgICAgICAgICAgIHNpemU6IGNvbnRhbnRTbXN0d293YXkudG9nZ2xlU21zVHdvd2F5LnRvZ2dTaXplXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkLmZuLmRhdGV0aW1lcGlja2VyLmRlZmF1bHRzID0ge1xyXG4gICAgICAgICAgICAgIG1hc2tJbnB1dDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgcGlja0RhdGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgcGlja1RpbWU6IHRydWUsXHJcbiAgICAgICAgICAgICAgc3RhcnREYXRlOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICQoJy5kYXRldGltZXBpY2tlcicpLmRhdGV0aW1lcGlja2VyKHtcclxuICAgICAgICAgICAgICBmb3JtYXQ6IGNvbnRhbnRTbXN0d293YXkuZFRQaWNrZXIuZnJtdCxcclxuICAgICAgICAgICAgICBsYW5ndWFnZTogY29udGFudFNtc3R3b3dheS5kVFBpY2tlci5sbmdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuY291bnRDb250YWN0c0FwcHJveGltYXRlID0ge307XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuZnVuY3Rpb25zID0ge1xyXG4gICAgICAgICAgICAgIGNvdW50Q29udGFjdHM6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5kYXRhLmxpc3RTZWxlY3RlZCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgIHR5cGUgPSBjb250YW50U21zdHdvd2F5LmNsVHlwZS50eXBlQ29udGFjdExpc3Q7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICB0eXBlID0gY29udGFudFNtc3R3b3dheS5jbFR5cGUudHlwZVNlZ21lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCgkc2NvcGUuZGF0YS5hcnJBZGRyZXNzZWUpIHx8ICRzY29wZS5kYXRhLmFyckFkZHJlc3NlZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5jb3VudENvbnRhY3RzQXBwcm94aW1hdGUuY291bnRzID0gMDtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgIHNlZ21lbnQ6ICRzY29wZS5kYXRhLmFyckFkZHJlc3NlZSxcclxuICAgICAgICAgICAgICAgICAgY29udGFjdGxpc3Q6ICRzY29wZS5kYXRhLmFyckFkZHJlc3NlZVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXN0U2VydmljZXNGdW5jdGlvbi5nZXRDb3VudENvbnRhYyhkYXRhKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGFkZFRhZzogZnVuY3Rpb24gKHRhZykge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0YW5ndWxhci5pc1VuZGVmaW5lZCgkc2NvcGUuZGF0YS5tZXNzYWdlKSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5tZXNzYWdlID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEubWVzc2FnZSArPSB0YWc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5tZXNzYWdlICs9IFwiIFwiICsgdGFnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMudmFsaWRhdGVJbkxpbmUoKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHNtc3RlbXBsYXRlOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlc3RTZXJ2aWNlc0Z1bmN0aW9uLmdldFNtc1RlbXBsYXRlKCk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICB0aW1lU2VuZGVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSA2MDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS50aW1lU2VuZGVyW2ldID0gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS50aW1lU2VuZGVyKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGFkZFJlc3BvbnNlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2UucHVzaCh7fSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBkZWxldGVSZXNwb25zZTogZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpbmRleCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2Uuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHZhbGlkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9yID0gMDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdWNjZXNzID0gMDtcclxuICAgICAgICAgICAgICAgIHZhciBmbGFnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hcnJFcnJvciA9IFt7fV07XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5kYXRhLnNlbnROb3cgfHwgJHNjb3BlLmRhdGEuc2VudE5vdyA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YS50aW1lem9uZSA9PSBcIlwiIHx8IGFuZ3VsYXIuaXNVbmRlZmluZWQoJHNjb3BlLmRhdGEudGltZXpvbmUpIHx8ICEkc2NvcGUuZGF0YS50aW1lem9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGhyb3coXCJEZWJlIHNlbGVjY2lvbmFyIHVuYSB6b25hIGhvcmFyaWEuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkYXRlc2VuZFwiKS52YWx1ZSA9PSBcInVuZGVmaW5lZFwiIHx8IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGF0ZXNlbmRcIikudmFsdWUgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGhyb3coXCJEZWJlIGFncmVnYXIgdW5hIGZlY2hhIHkgaG9yYSBkZSBlbnZpby5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YS5lbWFpbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbWFpbCA9ICRzY29wZS5kYXRhLmVtYWlsLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZW1haWwubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHRocm93KFwiTm8gc2UgZW5jb250cm8gbmluZ3VuIGNvcnJlbyBlbGVjdHJvbmljby5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbWFpbC5sZW5ndGggPiA4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0aHJvdyhcIlNvbG8gc2UgcHVlZGUgaW5ncmVzYXIgdW4gbcOheGltbyBkZSA4IGNvcnJlb3MgZWxlY3Ryw7NuaWNvc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbWFpbC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHJlID0gL14oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XHJcbiAgICAgICAgICAgICAgICAgICAgICBlbWFpbFtpXSA9IGVtYWlsW2ldLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmICghZW1haWxbaV0ubWF0Y2gocmUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93KFwiRWwgY29ycmVvIFwiICsgZW1haWxbaV0gKyBcIiBubyBlcyB2YWxpZG8uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5kYXRhLmlkU21zQ2F0ZWdvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyhcIkRlYmVzIHNlbGVjY2lvbmFyIHVuYSBjYXRlZ29yaWFcIik7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoJHNjb3BlLmRhdGEubGlzdFNlbGVjdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93KFwiRGViZSBzZWxlY2Npb25hciB1bmEgbGlzdGEgZGUgZGVzdGluYXRhcmlvc1wiKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCgkc2NvcGUuZGF0YS5hcnJBZGRyZXNzZWUpIHx8ICRzY29wZS5kYXRhLmFyckFkZHJlc3NlZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKFwiRGViZSBzZWxlY2Npb25hciBhbCBtZW5vcyB1biBzZWdtZW50byBvIGxpc3RhIGRlIGNvbnRhY3RvLlwiKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB2YXIgcmUgPSAvW8ODwrHDg+KAmMODwqHDg8Kpw4PCrcODwrPDg8K6w4PCgcOD4oCww4PCjcOD4oCcw4PFocOCwr/DgsKhw4LCtF0vO1xyXG4gICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCgkc2NvcGUuZGF0YS5tZXNzYWdlKSB8fCAkc2NvcGUuZGF0YS5tZXNzYWdlLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyAoXCJFbCBtZW5zYWplIGVzIG9ibGlnYXRvcmlvIHkgZGViZSBzZXIgbWF5b3IgYSBkb3MgY2FyYWN0ZXJlcy5cIik7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgaWYgKHJlLnRlc3QoJHNjb3BlLmRhdGEubWVzc2FnZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyAoXCJIYXkgY2FyYWN0ZXJlcyBubyB2w6FsaWRvcyBlbiBlbCBtZW5zYWplXCIpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2UubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyAoXCJEZWJlIGFncmVnYXIgbWluaW1vIHVuYSByZXNwdWVzdGEgY29uIHN1IHJlc3BlY3RpdmEgaG9tb2xvZ2FjaW9uLlwiKTtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gJHNjb3BlLmRhdGEudHlwZVJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoKCEkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2Vba2V5XS5ob21vbG9nYXRlIHx8ICRzY29wZS5kYXRhLnR5cGVSZXNwb25zZVtrZXldLmhvbW9sb2dhdGUgPT0gXCJcIikgfHwgKCEkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2Vba2V5XS5yZXNwb25zZSB8fCAkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2Vba2V5XS5yZXNwb25zZSA9PSBcIlwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAoXCJEZWJlIGFncmVnYXIgbWluaW1vIHVuYSByZXNwdWVzdGEgY29uIHN1IHJlc3BlY3RpdmEgaG9tb2xvZ2FjaW9uLlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZnVuY3Rpb25zLm9wZW5Nb2RhbCgpO1xyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoJGVycikge1xyXG4gICAgICAgICAgICAgICAgICBzbGlkZU9uVG9wKCRlcnIsIDMwMDAsIFwiZ2x5cGhpY29uIGdseXBoaWNvbi1pbmZvLXNpZ25cIiwgXCJkYW5nZXJcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBvcGVuUHJldmlldzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJChcIiNwcmV2aWV3XCIpLmFkZENsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGNsb3NlUHJldmlldzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJChcIiNwcmV2aWV3XCIpLnJlbW92ZUNsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHZhbGlkYXRlSW5MaW5lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5pbnZhbGlkQ2hhcmFjdGVycyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MuZXhpc3RUYWdzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy50YWdnZWRNZXNzYWdlID0gJHNjb3BlLmRhdGEubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5taXNjLm5ld01lc3NhZ2UgPSAkc2NvcGUuZGF0YS5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlID0gL1vDg8Kxw4PigJjDg8Khw4PCqcODwq3Dg8Kzw4PCusODwoHDg+KAsMODwo3Dg+KAnMODxaHDgsK/w4LCocOCwrRdLztcclxuICAgICAgICAgICAgICAgIHZhciB0YWdzID0gLyUlK1thLXpBLVowLTlfXSslJS87XHJcbiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlLnRlc3QoJHNjb3BlLmRhdGEubWVzc2FnZSkpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MuaW52YWxpZENoYXJhY3RlcnMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRhZ3MudGVzdCgkc2NvcGUuZGF0YS5tZXNzYWdlKSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5leGlzdFRhZ3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy50YWdnZWRNZXNzYWdlID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MubmV3TWVzc2FnZSA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSAkc2NvcGUuZGF0YS5tZXNzYWdlLnNwbGl0KFwiIFwiKTtcclxuICAgICAgICAgICAgICAgICAgZm9yICh2YXIgY29udCA9IDA7IGNvbnQgPCB3b3Jkcy5sZW5ndGg7IGNvbnQrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JkID0gd29yZHNbY29udF07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmQyID0gd29yZHNbY29udF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdvcmQuc3Vic3RyKDAsIDIpID09IFwiJSVcIiAmJiAod29yZC5zdWJzdHIoLTIpID09IFwiJSVcIiB8fCB3b3JkLnN1YnN0cigtMykgPT0gXCIlJSxcIiB8fCB3b3JkLnN1YnN0cigtMykgPT0gXCIlJS5cIiB8fCB3b3JkLnN1YnN0cigtMykgPT0gXCIlJTtcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHdvcmQgPSB3b3JkLnN1YnN0cigyKTtcclxuICAgICAgICAgICAgICAgICAgICAgIHdvcmQyID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgIHdvcmQgPSBcIjxiPjxpPlwiICsgd29yZDtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmICh3b3JkLnN1YnN0cigtMikgPT0gXCIlJVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmQgPSB3b3JkLnN1YnN0cigwLCB3b3JkLmxlbmd0aCAtIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3b3JkLnN1YnN0cigtMykgPT0gXCIlJSxcIiB8fCB3b3JkLnN1YnN0cigtMykgPT0gXCIlJS5cIiB8fCB3b3JkLnN1YnN0cigtMykgPT0gXCIlJTtcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JkID0gd29yZC5zdWJzdHIoMCwgd29yZC5sZW5ndGggLSAzKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgIHdvcmQgPSB3b3JkICsgXCI8L2k+PC9iPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgY291bnQgPSBjb3VudCArIHdvcmQubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy50YWdnZWRNZXNzYWdlICs9IHdvcmQgKyBcIiBcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5uZXdNZXNzYWdlICs9IHdvcmQyICsgXCIgXCI7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIG9wZW5Nb2RhbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJCgnLmRpYWxvZycpLmFkZENsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGNsb3NlTW9kYWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQoJy5kaWFsb2cnKS5yZW1vdmVDbGFzcygnZGlhbG9nLS1vcGVuJyk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBjcmVhdGVjb250YWN0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5vcmlnaW5hbERhdGUgPSBhbmd1bGFyLmNvcHkoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkYXRlc2VuZFwiKS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5pZFNtc1R3b3dheSA9ICRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheTtcclxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSB7fTtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YS5saXN0U2VsZWN0ZWQgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICB0YXJnZXQgPSB7dHlwZTogJ2NvbnRhY3RsaXN0JywgY29udGFjdGxpc3RzOiAkc2NvcGUuZGF0YS5hcnJBZGRyZXNzZWV9O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0ge3R5cGU6ICdzZWdtZW50Jywgc2VnbWVudDogJHNjb3BlLmRhdGEuYXJyQWRkcmVzc2VlfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnJlY2VpdmVyID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEudGFyZ2V0ID0gJHNjb3BlLmNvdW50Q29udGFjdHNBcHByb3hpbWF0ZS5jb3VudHM7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVzdFNlcnZpY2VzRnVuY3Rpb24uY3JlYXRlQ29udGFjdCgkc2NvcGUuZGF0YSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBzZXRFZGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLmlkU21zVHdvd2F5KSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5yZXN0U2VydmljZXNGdW5jdGlvbi5nZXRFZGl0KCRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICB1c2VUZW1wbGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5taXNjLmxpc3RmdWxsc21zdGVtcGxhdGUsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5pZFNtc1RlbXBsYXRlID09ICRzY29wZS5kYXRhLmlkU21zVGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZnVuY3Rpb25zLmFkZFRhZyh2YWx1ZS5jb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBpbml0aWFsaXplVmFyaWFibGVzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvL1VuaXZlcnNhbCBEYXRhXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuZ210ID0gXCItMDUwMFwiO1xyXG4gICAgICAgICAgICAgICAgLy9zZXQgbWlzY1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5taXNjLmxpc3RBZGRyZXNzZWUgPSBbe2lkOiAxLCBuYW1lOiBcIkxpc3RhIGRlIGNvbnRhY3Rvc1wifSwge2lkOiAyLCBuYW1lOiBcIlNlZ21lbnRvc1wifV07XHJcbiAgICAgICAgICAgICAgICAvL3NldCBSZXNwb25zZSBhcnJheSBcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnR5cGVSZXNwb25zZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MudGltZUZvcm1hdHMgPSBbXHJcbiAgICAgICAgICAgICAgICAgIHt2YWx1ZTogJ21pbnV0ZScsIG5hbWU6IFwiTWludXRvKHMpXCJ9LFxyXG4gICAgICAgICAgICAgICAgICB7dmFsdWU6ICdob3VyJywgbmFtZTogXCJIb3JhKHMpXCJ9LFxyXG4gICAgICAgICAgICAgICAgICB7dmFsdWU6ICdkYXknLCBuYW1lOiBcIkTDrWEocylcIn0sXHJcbiAgICAgICAgICAgICAgICAgIHt2YWx1ZTogJ3dlZWsnLCBuYW1lOiBcIlNlbWFuYShzKVwifSxcclxuICAgICAgICAgICAgICAgICAge3ZhbHVlOiAnbW9udGgnLCBuYW1lOiBcIk1lcyhlcylcIn1cclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5hcnJBZGRyZXNzZWUgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS52aWV3VGVtcGxhdGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS50aW1lU2VuZGVyID0gW107XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBjaGFuZ2VUaXRsZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy50aXRsZSA9IFwiRWRpdGFyIFNNUyBUV09XQVkgcG9yIGNvbnRhY3RvIG8gc2VnbWVudG9zLlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MudGl0bGUgPSBcIkNyZWFyIFNNUyBUV09XQVkgcG9yIGNvbnRhY3RvIG8gc2VnbWVudG9zLlwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJHNjb3BlLnJlc3RTZXJ2aWNlc0Z1bmN0aW9uID0ge1xyXG4gICAgICAgICAgICAgIGdldERldGluYXRhcnk6IGZ1bmN0aW9uIChsaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy50eXBlRGVzdGluID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0FkZHJlc3NlZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxpc3QgPT0gMSkge1xyXG4vLyAgICAgICAgICAgICAgICAgIGxldCBhcnJEZXN0aW5hdGFyeWxpc3QgPSByZXN0c2VydmljZXMuZ2V0Y29udGFjdGxpc3QoKTtcclxuICAgICAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLmdldGNvbnRhY3RsaXN0KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93QWRkcmVzc2VlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5saXN0QWxsQWRkcmVzc2VlID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7fSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgICAgICAgbGV0IGFyckRlc3RpbmF0YXJ5c2VnID0gcmVzdHNlcnZpY2VzLmdldHNlZ21lbnRzKCk7XHJcbiAgICAgICAgICAgICAgICAgIHJlc3RzZXJ2aWNlcy5nZXRzZWdtZW50cygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0FkZHJlc3NlZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MubGlzdEFsbEFkZHJlc3NlZSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge30pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBzZXRDYXRlZ29yeTogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5taXNjLmxpc3RDYXRlZ29yeSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBnZXRJbml0aWFsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJySW5pdGlhbFBldGljaW9uID0gW3Jlc3RzZXJ2aWNlcy5nZXRDYXRlZ29yeSgpLCByZXN0c2VydmljZXMuZ2V0bGlzdHRpbWV6b25lKCldO1xyXG4gICAgICAgICAgICAgICAgJHEuYWxsKGFyckluaXRpYWxQZXRpY2lvbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdFNlcnZpY2VzRnVuY3Rpb24uc2V0Q2F0ZWdvcnkoZGF0YVswXSk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5yZXN0U2VydmljZXNGdW5jdGlvbi5zZXRUaW1lem9uZShkYXRhWzFdLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7fSlcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHNldFRpbWV6b25lOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MubGlzdFRpbWV6b25lID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnRpbWV6b25lID0gXCItMDUwMFwiO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZ2V0Q291bnRDb250YWM6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXN0c2VydmljZXMuY291bnRDb250YWN0KGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50Q29udGFjdHNBcHByb3hpbWF0ZSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBnZXRTbXNUZW1wbGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLmxpc3RmdWxsc21zdGVtcGxhdGUoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLmxpc3RmdWxsc21zdGVtcGxhdGUgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGNyZWF0ZUNvbnRhY3Q6IGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLnNhdmVzbXN0d293YXljb250YWN0KGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5jbG9zZU1vZGFsKCk7XHJcbiAgICAgICAgICAgICAgICAgICR3aW5kb3cubG9jYXRpb24uaHJlZiA9IGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uaW5kZXhTbXNUd293YXk7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZ2V0RWRpdDogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJlc3RzZXJ2aWNlcy5nZXRFZGl0KGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlc3RTZXJ2aWNlc0Z1bmN0aW9uLmdldERldGluYXRhcnkoZGF0YS5saXN0U2VsZWN0ZWQpO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMuY291bnRDb250YWN0cygpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUucmVzdFNlcnZpY2VzRnVuY3Rpb24uZ2V0SW5pdGlhbCgpO1xyXG4gICAgICAgICAgICAkc2NvcGUuZnVuY3Rpb25zLnNldEVkaXQoKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5pbml0aWFsaXplVmFyaWFibGVzKCk7XHJcbiAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMuY2hhbmdlVGl0bGUoKTtcclxuICAgICAgICAgIH1dKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdjc3YnLCBbJyRzY29wZScsICckc3RhdGUnLCAnY29udGFudFNtc3R3b3dheScsICdyZXN0c2VydmljZXMnLCAnJHEnLCAnc29ja2V0JywgJyRzdGF0ZVBhcmFtcycsICdub3RpZmljYXRpb25TZXJ2aWNlJywgJ21pc2MnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGUsIGNvbnRhbnRTbXN0d293YXksIHJlc3RzZXJ2aWNlcywgJHEsIHNvY2tldCwgJHN0YXRlUGFyYW1zLCBub3RpZmljYXRpb25TZXJ2aWNlLCBtaXNjKSB7XHJcbiAgICAgICAgICAgICRzY29wZS52YWxpZGF0ZUNoZWNrSW50ZXJuYXRpb25hbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL0NhcmdhIEpRdWVyeVxyXG4gICAgICAgICAgICAkKCcudG9nZ2xlLXNtcy10d28td2F5JykuYm9vdHN0cmFwVG9nZ2xlKHtcclxuICAgICAgICAgICAgICBvbjogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09uLFxyXG4gICAgICAgICAgICAgIG9mZjogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09mZixcclxuICAgICAgICAgICAgICBvbnN0eWxlOiBjb250YW50U21zdHdvd2F5LnRvZ2dsZVNtc1R3b3dheS50b2dnT25TdHlsZSxcclxuICAgICAgICAgICAgICBvZmZzdHlsZTogY29udGFudFNtc3R3b3dheS50b2dnbGVTbXNUd293YXkudG9nZ09mZlN0eWxlLFxyXG4gICAgICAgICAgICAgIHNpemU6IGNvbnRhbnRTbXN0d293YXkudG9nZ2xlU21zVHdvd2F5LnRvZ2dTaXplXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJC5mbi5kYXRldGltZXBpY2tlci5kZWZhdWx0cyA9IHtcclxuICAgICAgICAgICAgICBtYXNrSW5wdXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgIHBpY2tEYXRlOiB0cnVlLFxyXG4gICAgICAgICAgICAgIHBpY2tUaW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgIHN0YXJ0RGF0ZTogbmV3IERhdGUoKVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgJCgnLmRhdGV0aW1lcGlja2VyJykuZGF0ZXRpbWVwaWNrZXIoe1xyXG4gICAgICAgICAgICAgIGZvcm1hdDogY29udGFudFNtc3R3b3dheS5kVFBpY2tlci5mcm10LFxyXG4gICAgICAgICAgICAgIGxhbmd1YWdlOiBjb250YW50U21zdHdvd2F5LmRUUGlja2VyLmxuZ1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vVW5pdmVyc2FsIERhdGFcclxuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgLy9zZXQgbWlzY1xyXG4gICAgICAgICAgICAkc2NvcGUubWlzYyA9IHt9O1xyXG4gICAgICAgICAgICAkc2NvcGUubWlzYy5Qcm9jY2Vzc0NzdiA9IHt9O1xyXG5cclxuXHJcbiAgICAgICAgICAgIC8vc2V0IFNlbnROb3dcclxuICAgICAgICAgICAgJHNjb3BlLmRhdGEuZGF0ZU5vdyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgLy9zZXQgb3B0aW9uc0F2YW5jZWRcclxuICAgICAgICAgICAgJHNjb3BlLmRhdGEuYWR2YW5jZWRvcHRpb25zID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAvL3NldCBzZW5kTm90aWZpY2F0aW9uXHJcbiAgICAgICAgICAgICRzY29wZS5kYXRhLm5vdGlmaWNhdGlvbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgLy9zZXQgZGl2aWRlU2VuZGlnblxyXG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5kaXZpZGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIC8vc2V0IFJlc3BvbnNlIGFycmF5IFxyXG4gICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2UgPSBjb250YW50U21zdHdvd2F5Lm1pc2MudHlwZVJlc3BvbnNlSW5pdDtcclxuICAgICAgICAgICAgLy9zZXQgZGVmYXVsdCBnbXQoYm9nb3RhKVxyXG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5nbXQgPSBjb250YW50U21zdHdvd2F5Lm1pc2MudGltZVpuO1xyXG4gICAgICAgICAgICAvL3NldCBMaW1pdCB0eXBlUmVzcG9uc2VcclxuICAgICAgICAgICAgJHNjb3BlLm1pc2MubGltaXRUeXBlUmVzcG9uc2UgPSBjb250YW50U21zdHdvd2F5Lm1pc2MubGltaXRUeXBlUmVzcG9uc2U7XHJcbiAgICAgICAgICAgIC8vc2V0IG1pbiB0eXBlUmVzcG9uc2VcclxuICAgICAgICAgICAgJHNjb3BlLm1pc2MubWluVHlwZVJlc3BvbnNlID0gY29udGFudFNtc3R3b3dheS5taXNjLm1pblR5cGVSZXNwb25zZTtcclxuXHJcbiAgICAgICAgICAgIC8vc2V0IGFycmF5TnVtYmVyIG1pc2NcclxuICAgICAgICAgICAgJHNjb3BlLm1pc2MubnVtYmVyU2VuZGluZyA9IG5ldyBBcnJheSg2MCk7XHJcblxyXG4gICAgICAgICAgICAvL3NldCB0aW1lRm9ybWF0cyBcclxuICAgICAgICAgICAgJHNjb3BlLm1pc2MudGltZUZvcm1hdHMgPSBbXHJcbiAgICAgICAgICAgICAge3ZhbHVlOiBjb250YW50U21zdHdvd2F5Lm1pc2MubWluVmFsdWUsIG5hbWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy5taW5OYW1lfSxcclxuICAgICAgICAgICAgICB7dmFsdWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy5ob3VyVmFsdWUsIG5hbWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy5ob3VyTmFtZX0sXHJcbiAgICAgICAgICAgICAge3ZhbHVlOiBjb250YW50U21zdHdvd2F5Lm1pc2MuZGF5VmFsdWUsIG5hbWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy5kYXlOYW1lfSxcclxuICAgICAgICAgICAgICB7dmFsdWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy53ZWVrVmFsdWUsIG5hbWU6IGNvbnRhbnRTbXN0d293YXkubWlzYy53ZWVrTmFtZX0sXHJcbiAgICAgICAgICAgICAge3ZhbHVlOiBjb250YW50U21zdHdvd2F5Lm1pc2MubW9udGhWYWx1ZSwgbmFtZTogY29udGFudFNtc3R3b3dheS5taXNjLm1vbnRoTmFtZX1cclxuICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICRzY29wZS5WYWxpZGF0ZUNoZWNrSW50ZXIgPSBmdW5jdGlvbiAoKXtcclxuICAgICAgICAgICAgICAgIGlmKCRzY29wZS52YWxpZGF0ZUNoZWNrSW50ZXJuYXRpb25hbCA9PSB0cnVlKXtcclxuICAgICAgICAgICAgICAgICAgICBzbGlkZU9uVG9wKFwiTG8gc2VudGltb3MsIGxhIGN1ZW50YSBubyB0aWVuZSBoYWJpbGl0YWRvIGVudmlvcyBpbnRlcm5hY2lvbmFsZXMsIHNpIGRlc2VhcyBoYWJpbGl0YXJsbyBjb211bmljYXRlIGNvbiBzb3BvcnRlXCIsIDMwMDAsIFwiZ2x5cGhpY29uIGdseXBoaWNvbi1pbmZvLXNpZ25cIiwgXCJkYW5nZXJcIik7ICAgIFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuaW50ZXJuYXRpb25hbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9Vbml2ZXJzYWwgZnVuY3Rpb25zXHJcbiAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMgPSB7XHJcblxyXG4gICAgICAgICAgICAgIG9wdGlvbnNBdmFuY2VkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5kYXRhLmFkdmFuY2Vkb3B0aW9ucyB8fCBhbmd1bGFyLmlzVW5kZWZpbmVkKCRzY29wZS5kYXRhLmFkdmFuY2Vkb3B0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuYWR2YW5jZWRvcHRpb25zID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmFkdmFuY2Vkb3B0aW9ucyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgc2VudE5vdzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEkc2NvcGUuZGF0YS5kYXRlTm93IHx8IGFuZ3VsYXIuaXNVbmRlZmluZWQoJHNjb3BlLmRhdGEuZGF0ZU5vdykpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuZGF0ZU5vdyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5kYXRlTm93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBzZW5kTm90aWZpY2F0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5kYXRhLm5vdGlmaWNhdGlvbiB8fCBhbmd1bGFyLmlzVW5kZWZpbmVkKCRzY29wZS5kYXRhLm5vdGlmaWNhdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEubm90aWZpY2F0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLm5vdGlmaWNhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZGl2aWRlU2VuZGluZzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEkc2NvcGUuZGF0YS5kaXZpZGUgfHwgYW5ndWxhci5pc1VuZGVmaW5lZCgkc2NvcGUuZGF0YS5kaXZpZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmRpdmlkZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5kaXZpZGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGFkZFJlc3BvbnNlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2UucHVzaCh7fSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBkZWxldGVSZXNwb25zZTogZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuZGF0YS50eXBlUmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEudHlwZVJlc3BvbnNlLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbWlzYy52YWxpZGF0aW9uR2VuZXJhbCgkc2NvcGUuZGF0YSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCgkc2NvcGUuZGF0YS5jc3YpICYmIGFuZ3VsYXIuaXNVbmRlZmluZWQoJHNjb3BlLmRhdGEuaWRTbXNUd293YXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVPblRvcChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ0NzdiwgY29udGFudFNtc3R3b3dheS5taWxsaVNlY29uZHMudGhyZWVUaG91c2FuZCwgY29udGFudFNtc3R3b3dheS5zbGlkZU9uVG9wLmNsYXNzU2xpZGUsIGNvbnRhbnRTbXN0d293YXkuY2xhc3NUb29nbGUuZGFuZ2VyKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgaWYoJHNjb3BlLmRhdGEuaW50ZXJuYXRpb25hbCA9PSB0cnVlICYmIGFuZ3VsYXIuaXNVbmRlZmluZWQoJHNjb3BlLmRhdGEuaWRjb3VudHJ5KSl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVPblRvcChcIlNlbGVjY2lvbmUgdW4gcGFpcyBwYXJhIGVsIGVudmlvIGludGVybmFjaW9uYWxcIiwgY29udGFudFNtc3R3b3dheS5taWxsaVNlY29uZHMudGhyZWVUaG91c2FuZCwgY29udGFudFNtc3R3b3dheS5zbGlkZU9uVG9wLmNsYXNzU2xpZGUsIGNvbnRhbnRTbXN0d293YXkuY2xhc3NUb29nbGUuZGFuZ2VyKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5vcGVuTW9kYWwoKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgIHNsaWRlT25Ub3AobWVzc2FnZSwgY29udGFudFNtc3R3b3dheS5taWxsaVNlY29uZHMudGhyZWVUaG91c2FuZCwgY29udGFudFNtc3R3b3dheS5zbGlkZU9uVG9wLmNsYXNzU2xpZGUsIGNvbnRhbnRTbXN0d293YXkuY2xhc3NUb29nbGUuZGFuZ2VyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgb3Blbk1vZGFsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcjUHJvY2Vzc0NzdicpLmFkZENsYXNzKCdkaWFsb2ctLW9wZW4nKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIG9wZW5Nb2RhbEVkaXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQoJyNlZGl0Q3N2JykuYWRkQ2xhc3MoJ2RpYWxvZy0tb3BlbicpO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgY2xvc2VNb2RhbEVkaXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQoJyNlZGl0Q3N2JykucmVtb3ZlQ2xhc3MoJ2RpYWxvZy0tb3BlbicpO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgc2V0RGF0YUVkaXQ6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5lZGl0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNhdGVnb3J5ID0gZGF0YVtcImlkU21zQ2F0ZWdvcnlcIl07XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5nbXQgPSBkYXRhW1wiZ210XCJdO1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT0gJ3R5cGVSZXNwb25zZScpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZVJlc3BvbnNlID0gSlNPTi5wYXJzZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGFba2V5XSA9IHR5cGVSZXNwb25zZS50eXBlUmVzcG9uc2U7XHJcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGFba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHNlbml0aXplOiBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoY29udGFudFNtc3R3b3dheS5taXNjLmFyckJvb2xlYW4uaW5kZXhPZih2YWx1ZSkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFba2V5XSA9ICh2YWx1ZSA9PSBjb250YW50U21zdHdvd2F5LnZhbHVlU2VuaXRpemVDc3YudmFsdVNDKSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vRnVuY3Rpb25zIFJlc3RTZXJ2aWNlc1xyXG4gICAgICAgICAgICAkc2NvcGUucmVzdFNlcnZpY2VzRnVuY3Rpb24gPSB7XHJcbiAgICAgICAgICAgICAgZ2V0QWxsU21zVHdvd2F5OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MubGlzdFNtc1R3b3dheSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBnZXRJbml0aWFsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJySW5pdGlhbFBldGljaW9uID0gW3Jlc3RzZXJ2aWNlcy5nZXRDYXRlZ29yeSgpLCByZXN0c2VydmljZXMuZ2V0bGlzdHRpbWV6b25lKCldO1xyXG4gICAgICAgICAgICAgICAgJHEuYWxsKGFyckluaXRpYWxQZXRpY2lvbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdFNlcnZpY2VzRnVuY3Rpb24uc2V0Q2F0ZWdvcnkoZGF0YVswXSk7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5yZXN0U2VydmljZXNGdW5jdGlvbi5zZXRUaW1lem9uZShkYXRhWzFdLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7fSlcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHNldENhdGVnb3J5OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgZm9yKGk9MDsgaTwgZGF0YS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICAgIGlmKGRhdGFbaV1bXCJpZFNtc0NhdGVnb3J5XCJdID09ICRzY29wZS5kYXRhLmNhdGVnb3J5KXtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jYXRlZ29yeSA9IGRhdGFbaV07XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5taXNjLmxpc3RDYXRlZ29yeSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBzZXRUaW1lem9uZTogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGZvcihpPTA7IGk8IGRhdGEubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgICBpZihkYXRhW2ldW1wiZ210XCJdID09ICRzY29wZS5kYXRhLmdtdCl7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuZ210ID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MubGlzdFRpbWV6b25lID0gZGF0YTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHNldEF2YWxhaWJsZUNvdW50cnk6IGZ1bmN0aW9uICgpe1xyXG4gICAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLmdldEF2YWxhaWJsZUNvdW50cnkoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7ICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICBpZihkYXRhLnJlc3VsdCAhPSBmYWxzZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmludGVybmF0aW9uYWxjb3VudHJpZXMgPSBkYXRhLnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnZhbGlkYXRlQ2hlY2tJbnRlcm5hdGlvbmFsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgc2V0U21zVHdvd2F5OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc21zdHdvd2F5ID0gZGF0YTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGNyZWF0ZUxvdGVUd293YXk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghJHN0YXRlUGFyYW1zLmlkU21zVHdvd2F5KSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLmluaXRQcm9jZXNzVXBsb2FkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MuUHJvY2Nlc3NDc3YucG9yYyA9IGNvbnRhbnRTbXN0d293YXkuY3N2UHJvY2Vzcy5jc3ZQb3JjO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5yZXNwb25zZSA9IEpTT04uc3RyaW5naWZ5KHt0eXBlUmVzcG9uc2U6ICRzY29wZS5kYXRhLnR5cGVSZXNwb25zZX0pO1xyXG4gICAgICAgICAgICAgICAgICBpZihhbmd1bGFyLmlzVW5kZWZpbmVkKCRzY29wZS5kYXRhLmludGVybmF0aW9uYWwpKXtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5pbnRlcm5hdGlvbmFsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgLy9pZigkc2NvcGUuZGF0YS5pZGNvdW50cnkgIT0gJycgfHwgIWFuZ3VsYXIuaXNVbmRlZmluZWQoJHNjb3BlLmRhdGEuaWRjb3VudHJ5KSl7XHJcbi8vICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gJHNjb3BlLmRhdGEuaWRjb3VudHJ5O1xyXG4vLyAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUuZGF0YS5pZGNvdW50cnkgPSBudWxsO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUuZGF0YS5pZGNvdW50cnk7ID0gdG1wLmlkY291bnRyeTtcclxuLy8gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUEFTRSBQT1IgQVFVSVwiLCRzY29wZS5kYXRhKTsgICBcclxuICAgICAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLmNyZWF0ZWNzdigkc2NvcGUuZGF0YSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLmluaXRQcm9jZXNzVXBsb2FkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VNb2RhbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlT25Ub3AocmVzLm1lc3NhZ2UsIGNvbnRhbnRTbXN0d293YXkubWlsbGlTZWNvbmRzLnRocmVlVGhvdXNhbmQsIGNvbnRhbnRTbXN0d293YXkuc2xpZGVPblRvcC5jbGFzc1NsaWRlLCBjb250YW50U21zdHdvd2F5LmNsYXNzVG9vZ2xlLmRhbmdlcik7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucmVzcG9uc2UgPSBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICAgIHR5cGVSZXNwb25zZTogJHNjb3BlLmRhdGEudHlwZVJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLmVkaXRjc3YoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgICAgICAgIGNsb3NlTW9kYWwoKTtcclxuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKGNvbnRhbnRTbXN0d293YXkucm91dGluZy5nb1N0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgICAgc2xpZGVPblRvcChyZXMubWVzc2FnZSwgY29udGFudFNtc3R3b3dheS5taWxsaVNlY29uZHMudGhyZWVUaG91c2FuZCwgY29udGFudFNtc3R3b3dheS5zbGlkZU9uVG9wLmNsYXNzU2xpZGUsIGNvbnRhbnRTbXN0d293YXkuY2xhc3NUb29nbGUuZGFuZ2VyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGNoYW5nZVN0YXR1c0NzdjogZnVuY3Rpb24gKHN0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkU21zID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoJHNjb3BlLmRhdGEuaWRTbXNUd293YXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlkU21zID0gJHNjb3BlLmRhdGEuaWRTbXNUd293YXk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBpZFNtcyA9ICRzY29wZS5taXNjLmlkU21zO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzdHNlcnZpY2VzLmNoYW5nZXN0YXR1cyhpZFNtcywgc3RhdHVzKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKCRzY29wZS5kYXRhLmlkU21zVHdvd2F5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5mdW5jdGlvbnMuY2xvc2VNb2RhbEVkaXQoKTtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oY29udGFudFNtc3R3b3dheS5yb3V0aW5nLmdvU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBnZXRPbmVTbXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJlc3RzZXJ2aWNlcy5nZXRPbmUoJHNjb3BlLmRhdGEuaWRTbXNUd293YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5zZW5pdGl6ZShkYXRhLCAkc2NvcGUuZnVuY3Rpb25zLnNldERhdGFFZGl0KTtcclxuLy8gICAgICAgICAgICAgICAgICAkc2NvcGUuZnVuY3Rpb25zLnNldERhdGFFZGl0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IoZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbyhjb250YW50U21zdHdvd2F5LnJvdXRpbmcuZ29TdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheSkge1xyXG4gICAgICAgICAgICAgICAgICByZXN0c2VydmljZXMuY2FuY2VsRWRpdCgkc3RhdGVQYXJhbXMuaWRTbXNUd293YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcm91dGUgPSAkd2luZG93Lm15QmFzZVVSTCArIGNvbnRhbnRTbXN0d293YXkucm91dGluZy5zbXN0d293YXlSb3V0ZTtcclxuICAgICAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLmhyZWYgPSByb3V0ZTtcclxuICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgcm91dGUgPSAkd2luZG93Lm15QmFzZVVSTCArIGNvbnRhbnRTbXN0d293YXkucm91dGluZy5zbXN0d293YXlSb3V0ZTtcclxuICAgICAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcm91dGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRzY29wZS5zb2NrZXQgPSB7XHJcbiAgICAgICAgICAgICAgc2VhcmNoUHJvY2VzczogZnVuY3Rpb24gKGlkU21zVHdvd2F5KSB7XHJcbiAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdCgnc2VhcmNoLXNtcy10d293YXknLCBpZFNtc1R3b3dheSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZCgkc3RhdGVQYXJhbXMuaWRTbXNUd293YXkpICYmICRzdGF0ZVBhcmFtcy5pZFNtc1R3b3dheSAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuaWRTbXNUd293YXkgPSAkc3RhdGVQYXJhbXMuaWRTbXNUd293YXk7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmZ1bmN0aW9ucy5vcGVuTW9kYWxFZGl0KCk7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnJlc3RTZXJ2aWNlc0Z1bmN0aW9uLmdldE9uZVNtcygpO1xyXG4gICAgICAgICAgICAgICRzY29wZS5yZXN0U2VydmljZXNGdW5jdGlvbi5nZXRJbml0aWFsKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnJlc3RTZXJ2aWNlc0Z1bmN0aW9uLmdldEluaXRpYWwoKTtcclxuICAgICAgICAgICAgICAkc2NvcGUucmVzdFNlcnZpY2VzRnVuY3Rpb24uc2V0QXZhbGFpYmxlQ291bnRyeSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzb2NrZXQub24oJ2xvYWRpbmctY3N2LXR3b3dheScsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGRhdGEuaWRTdWJhY2NvdW50ID09IGNvbnRhbnRTbXN0d293YXkubWlzYy5pZFN1YmFjY291bnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBjb250YW50U21zdHdvd2F5LnN0YXR1c0xvYWRpbmdDc3YucHJlbG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5Qcm9jY2Vzc0Nzdi5wcmVsb2FkID0ge307XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLlByb2NjZXNzQ3N2LnBvcmMgKz0gY29udGFudFNtc3R3b3dheS5jc3ZQcm9jZXNzLmNzdlBvcmM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gY29udGFudFNtc3R3b3dheS5zdGF0dXNMb2FkaW5nQ3N2LnZhbGlkYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLlByb2NjZXNzQ3N2LnBvcmMgKz0gY29udGFudFNtc3R3b3dheS5jc3ZQcm9jZXNzLmNzdlBvcmM7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLlByb2NjZXNzQ3N2LnByZWxvYWQuZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLm1pc2MuUHJvY2Nlc3NDc3YudmFsaWRhdGlvbnMgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBjb250YW50U21zdHdvd2F5LnN0YXR1c0xvYWRpbmdDc3YubG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5Qcm9jY2Vzc0Nzdi5wb3JjICs9IGNvbnRhbnRTbXN0d293YXkuY3N2UHJvY2Vzcy5jc3ZQb3JjO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5Qcm9jY2Vzc0Nzdi52YWxpZGF0aW9ucy5kYXRhID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5Qcm9jY2Vzc0Nzdi5sb2FkID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gY29udGFudFNtc3R3b3dheS5zdGF0dXNMb2FkaW5nQ3N2LmZpbmlzaCkge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5Qcm9jY2Vzc0Nzdi5wb3JjICs9IGNvbnRhbnRTbXN0d293YXkuY3N2UHJvY2Vzcy5jc3ZQb3JjO1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5Qcm9jY2Vzc0Nzdi5sb2FkLmRhdGEgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLlByb2NjZXNzQ3N2LmZpbmlzaCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubWlzYy5pZFNtcyA9IGRhdGEuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICRzY29wZS5taXNjLlByb2NjZXNzQ3N2LmZpbmlzaC5tZXNzYWdlID0gZGF0YS5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBzb2NrZXQub24oJ3Byb2Nlc3Mtc21zLXR3b3dheScsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLm1pc2MuaGlkZVNwaW5uZXIgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICRzY29wZS5taXNjLmlzUHJvY2VzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICB9XSk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vanMvYW5ndWxhci9zbXN0d293YXkvY29udHJvbGxlcnMuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/***/ (function(module, exports) {

eval("angular.module('smstwoway.services', [])\r\n        .service('restservices', ['$http', '$q', 'contantSmstwoway', 'notificationService', function ($http, $q, contantSmstwoway, notificationService) {\r\n            //Trae el total de registros de smstwoway para mostrarlas en el index de smstwoway\r\n            this.getAllSmsTwoway = function (page, filter) {\r\n              var deferred = $q.defer();\r\n\r\n              var url = contantSmstwoway.urlPeticion.indexLoteTwoway + page;\r\n              $http.post(url, filter)\r\n                      .then(function (data) {\r\n                        deferred.resolve(data);\r\n                      })\r\n                      .catch(function (data) {\r\n                        deferred.reject(data.data);\r\n                      });\r\n              return deferred.promise;\r\n            }\r\n            //Retorna listado de las categorias de SMS para filtrar por las mismas\r\n            this.getCategory = function () {\r\n              var defer = $q.defer();\r\n              var promise = defer.promise;\r\n\r\n              $http.get(contantSmstwoway.urlPeticion.getCategory)\r\n                      .then(function (data) {\r\n                        defer.resolve(data.data);\r\n                      })\r\n                      .catch(function (data) {\r\n                        defer.reject(data.data);\r\n                      });\r\n\r\n              return promise;\r\n            }\r\n            //Trae en el select de envio rapido y csv el listado de timezones\r\n            this.getlisttimezone = function () {\r\n              var defer = $q.defer();\r\n              var promise = defer.promise;\r\n\r\n              $http.get(contantSmstwoway.urlPeticion.getTimezone)\r\n                      .then(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .catch(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return promise;\r\n            }\r\n            this.create = function (data) {\r\n              var defer = $q.defer();\r\n              $http.post(contantSmstwoway.urlPeticion.createLoteTwoway, data)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return defer.promise;\r\n            };\r\n            this.edit = function (data) {\r\n              var defer = $q.defer();\r\n              $http.put(contantSmstwoway.urlPeticion.editLoteTwoway, data)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data.message);\r\n                      });\r\n\r\n              return defer.promise;\r\n            };\r\n\r\n            this.getcontactlist = function () {\r\n              var defer = $q.defer();\r\n              $http.get(contantSmstwoway.urlPeticion.getcontactlist)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return defer.promise;\r\n            };\r\n            this.getsegments = function () {\r\n              var defer = $q.defer();\r\n              $http.get(contantSmstwoway.urlPeticion.getsegments)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return defer.promise;\r\n            };\r\n            this.createcsv = function (data) {\r\n              var defer = $q.defer();\r\n              var config = {};\r\n              config.headers = {};\r\n              config.transformRequest = angular.identity;\r\n              config.headers['Content-Type'] = undefined;\r\n              var formData = new FormData();\r\n              for (var key in data) {\r\n                if (!(data[key] instanceof File)) {\r\n                  if (typeof data[key] == \"object\") {\r\n                    formData.append(key, JSON.stringify(data[key]));\r\n                  } else {\r\n                    formData.append(key, data[key]);\r\n                  }\r\n\r\n                } else {\r\n                  formData.append(key, data[key]);\r\n                }\r\n              }\r\n              $http.post(contantSmstwoway.urlPeticion.createCsvTwoway, formData, config)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return defer.promise;\r\n            };\r\n            this.countContact = function (data) {\r\n              var defer = $q.defer();\r\n\r\n              $http.post(contantSmstwoway.urlPeticion.countContact, data)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return defer.promise;\r\n            };\r\n            this.listfullsmstemplate = function () {\r\n              var defer = $q.defer();\r\n              $http.get(contantSmstwoway.urlPeticion.listSmsTemplate)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      });\r\n              return defer.promise;\r\n            }\r\n\r\n            this.savesmstwowaycontact = function (data) {\r\n              var defer = $q.defer();\r\n              $http.post(contantSmstwoway.urlPeticion.saveSmstowwayContact, data)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n              return defer.promise;\r\n            };\r\n            this.changestatus = function (id, status) {\r\n              var defer = $q.defer();\r\n              $http.post(contantSmstwoway.urlPeticion.changeStatusTwoway + id, {status: status})\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return defer.promise;\r\n            };\r\n            //Funcion que trae los datos al editar en el envio rapido\r\n            this.getDataAll = function (id) {\r\n              var defer = $q.defer();\r\n              $http.post(contantSmstwoway.urlPeticion.changeDataEditAll, id)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n              return defer.promise;\r\n            };\r\n            this.getOne = function (id) {\r\n              var defer = $q.defer();\r\n              $http.post(contantSmstwoway.urlPeticion.changeDataEditAll, id)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n              return defer.promise;\r\n            };\r\n\r\n            this.validateDate = function (id) {\r\n              var defer = $q.defer();\r\n              $http.post(contantSmstwoway.urlPeticion.getValidationDate, id)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n              return defer.promise;\r\n            };\r\n\r\n            this.getEdit = function (id) {\r\n              var defer = $q.defer();\r\n\r\n              $http.post(contantSmstwoway.urlPeticion.getInforEdit, id)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n              return defer.promise;\r\n            };\r\n\r\n            this.cancelEdit = function (id) {\r\n              var defer = $q.defer();\r\n\r\n              $http.post(contantSmstwoway.urlPeticion.calcelEdit, id)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n              return defer.promise;\r\n            };\r\n            this.editcsv = function (data) {\r\n              var defer = $q.defer();\r\n              $http.post(contantSmstwoway.urlPeticion.editcsv, data)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return defer.promise;\r\n\r\n            };\r\n            this.getAvalaibleCountry = function () {\r\n              var defer = $q.defer();\r\n              $http.post(contantSmstwoway.urlPeticion.getavalaiblecountry)\r\n                      .success(function (data) {\r\n                        defer.resolve(data);\r\n                      })\r\n                      .error(function (data) {\r\n                        defer.reject(data);\r\n                      });\r\n\r\n              return defer.promise;\r\n            };\r\n          }\r\n        ])\r\n        .factory('notificationService', function (contantSmstwoway) {\r\n          function error(message) {\r\n            slideOnTop(message, contantSmstwoway.milliSeconds.fourThousand, contantSmstwoway.slideOnTop.classSlideRemoveCircle, contantSmstwoway.classToogle.danger);\r\n          }\r\n\r\n          function success(message) {\r\n            slideOnTop(message, contantSmstwoway.milliSeconds.fourThousand, contantSmstwoway.slideOnTop.classSlideOkCircle, contantSmstwoway.classToogle.success);\r\n          }\r\n\r\n          function warning(message) {\r\n            slideOnTop(message, contantSmstwoway.milliSeconds.fourThousand, contantSmstwoway.slideOnTop.classSlideExclamationSign, contantSmstwoway.classToogle.warning);\r\n          }\r\n\r\n          function notice(message) {\r\n            slideOnTop(message, contantSmstwoway.milliSeconds.fourThousand, contantSmstwoway.slideOnTop.classSlideExclamationSign, contantSmstwoway.classToogle.notice);\r\n          }\r\n\r\n          function info(message) {\r\n            slideOnTop(message, contantSmstwoway.milliSeconds.fourThousand, contantSmstwoway.slideOnTop.classSlideExclamationSign, contantSmstwoway.classToogle.info);\r\n          }\r\n\r\n          return {\r\n            error: error,\r\n            success: success,\r\n            warning: warning,\r\n            notice: notice,\r\n            info: info\r\n          };\r\n        })\r\n        .factory('misc', function ($q, contantSmstwoway) {\r\n          return {\r\n            validationGeneral: function (data) {\r\n              var defer = $q.defer();\r\n              var promise = defer.promise;\r\n              var name = data.name;\r\n              var cat = (data.category) ? data.category : data.idSmsCategory;\r\n              var gmt = data.gmt;\r\n              var dtp = data.dtpicker = $('#dtpicker').val();\r\n              var sentNow = (data.sentNow) ? data.sentNow : data.dateNow;\r\n              var optionsAvanced = (data.optionsAvanced) ? data.optionsAvanced : data.advancedoptions;\r\n              var sendNotification = (data.sendNotification) ? data.sendNotification : data.notification;\r\n              var emailNotification = (data.emailNotification) ? data.emailNotification : data.email;\r\n\r\n              if (angular.isUndefined(name) || !name) {\r\n                defer.reject(contantSmstwoway.error.messages.msgNameSent);\r\n              }\r\n              if (angular.isUndefined(cat) || !cat) {\r\n                defer.reject(contantSmstwoway.error.messages.msgCategory);\r\n              }\r\n              if (!sentNow || sentNow != true) {\r\n                if (angular.isUndefined(gmt) || !gmt) {\r\n                  defer.reject(contantSmstwoway.error.messages.msgTimezone);\r\n                }\r\n                if (angular.isUndefined(dtp) || !dtp) {\r\n                  defer.reject(contantSmstwoway.error.messages.msgDateTime);\r\n                }\r\n              }\r\n              if (data.typeResponse.length == 0) {\r\n                defer.reject(contantSmstwoway.error.messages.msgTypeResponseNotClicked);\r\n              } else {\r\n                for (var key in data.typeResponse) {\r\n                  if ((!data.typeResponse[key].homologate || data.typeResponse[key].homologate == \"\") || (!data.typeResponse[key].response || data.typeResponse[key].response == \"\")) {\r\n                    defer.reject(contantSmstwoway.error.messages.msgTypeResponseEmpty);\r\n                  } else if (data.typeResponse.length < contantSmstwoway.values.messages.msgMinTypeResponseValue) {\r\n                    defer.reject(contantSmstwoway.error.messages.msgTypeResponseMinLength);\r\n                  } else if (data.typeResponse[key].response || data.typeResponse[key].homologate) {\r\n                    var homologatecontent = data.typeResponse[key].homologate.split(\",\");\r\n                    var patternBlankSpaces = contantSmstwoway.patterns.blankSpacesResponseAndHomologate;\r\n                    var patternAccents = contantSmstwoway.patterns.accentsResponseAndHomologate;\r\n                    if (patternAccents.test(data.typeResponse[key].response) || patternBlankSpaces.test(homologatecontent) || patternAccents.test(homologatecontent)) {\r\n                      defer.reject(contantSmstwoway.error.messages.msgBlankSpaces);\r\n                    }\r\n                    if (homologatecontent.length > contantSmstwoway.values.messages.msgMaxHomologateContentValue) {\r\n                      defer.reject(contantSmstwoway.error.messages.msgTypeResponseHomologateMinLength);\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n              if (optionsAvanced == true) {\r\n                if (sendNotification == true) {\r\n                  if (!emailNotification) {\r\n                    defer.reject(contantSmstwoway.error.messages.msgEmailEmpty);\r\n                  } else if (emailNotification) {\r\n                    var email = emailNotification.split(\",\");\r\n                    if (email.length == 0) {\r\n                      defer.reject(contantSmstwoway.error.messages.msgEmailEmpty2);\r\n                    }\r\n                    if (email.length > contantSmstwoway.values.messages.msgMaxEmailValue) {\r\n                      defer.reject(contantSmstwoway.error.messages.msgMaxEmail);\r\n                    }\r\n                    for (var i = 0; i < email.length; i++) {\r\n                      var re = contantSmstwoway.patterns.verifyCorrectEmail;\r\n                      email[i] = email[i].trim();\r\n                      if (!email[i].match(re)) {\r\n                        defer.reject(contantSmstwoway.error.messages.msgInvalidMail1 + email[i] + contantSmstwoway.error.messages.msgInvalidMail2);\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n                if (data.divideSending == true) {\r\n                  if (!data.quantity) {\r\n                    defer.reject(contantSmstwoway.error.messages.msgIntervalos);\r\n                  } else if (!data.sendingTime) {\r\n                    defer.reject(contantSmstwoway.error.messages.msgSentTime);\r\n                  } else if (!data.timeFormat) {\r\n                    defer.reject(contantSmstwoway.error.messages.msgTimeFormat);\r\n                  }\r\n                }\r\n              }\r\n              defer.resolve();\r\n              return promise;\r\n            }\r\n          }\r\n        });\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9hbmd1bGFyL3Ntc3R3b3dheS9zZXJ2aWNlcy5qcz80Zjg4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSx1QkFBdUI7O0FBRXZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLHVCQUF1Qjs7QUFFdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLHVCQUF1Qjs7QUFFdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLHVCQUF1Qjs7QUFFdkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSx1QkFBdUI7O0FBRXZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSx1QkFBdUI7O0FBRXZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7O0FBRUEsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsdUJBQXVCOztBQUV2QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLHVCQUF1Qjs7QUFFdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0YsZUFBZTtBQUMvRjtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSx1QkFBdUI7O0FBRXZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLHVCQUF1Qjs7QUFFdkI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSx1QkFBdUI7O0FBRXZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxrQkFBa0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyIsImZpbGUiOiIzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ3Ntc3R3b3dheS5zZXJ2aWNlcycsIFtdKVxyXG4gICAgICAgIC5zZXJ2aWNlKCdyZXN0c2VydmljZXMnLCBbJyRodHRwJywgJyRxJywgJ2NvbnRhbnRTbXN0d293YXknLCAnbm90aWZpY2F0aW9uU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgJHEsIGNvbnRhbnRTbXN0d293YXksIG5vdGlmaWNhdGlvblNlcnZpY2UpIHtcclxuICAgICAgICAgICAgLy9UcmFlIGVsIHRvdGFsIGRlIHJlZ2lzdHJvcyBkZSBzbXN0d293YXkgcGFyYSBtb3N0cmFybGFzIGVuIGVsIGluZGV4IGRlIHNtc3R3b3dheVxyXG4gICAgICAgICAgICB0aGlzLmdldEFsbFNtc1R3b3dheSA9IGZ1bmN0aW9uIChwYWdlLCBmaWx0ZXIpIHtcclxuICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG5cclxuICAgICAgICAgICAgICB2YXIgdXJsID0gY29udGFudFNtc3R3b3dheS51cmxQZXRpY2lvbi5pbmRleExvdGVUd293YXkgKyBwYWdlO1xyXG4gICAgICAgICAgICAgICRodHRwLnBvc3QodXJsLCBmaWx0ZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vUmV0b3JuYSBsaXN0YWRvIGRlIGxhcyBjYXRlZ29yaWFzIGRlIFNNUyBwYXJhIGZpbHRyYXIgcG9yIGxhcyBtaXNtYXNcclxuICAgICAgICAgICAgdGhpcy5nZXRDYXRlZ29yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXIucHJvbWlzZTtcclxuXHJcbiAgICAgICAgICAgICAgJGh0dHAuZ2V0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uZ2V0Q2F0ZWdvcnkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vVHJhZSBlbiBlbCBzZWxlY3QgZGUgZW52aW8gcmFwaWRvIHkgY3N2IGVsIGxpc3RhZG8gZGUgdGltZXpvbmVzXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0bGlzdHRpbWV6b25lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlci5wcm9taXNlO1xyXG5cclxuICAgICAgICAgICAgICAkaHR0cC5nZXQoY29udGFudFNtc3R3b3dheS51cmxQZXRpY2lvbi5nZXRUaW1lem9uZSlcclxuICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAkaHR0cC5wb3N0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uY3JlYXRlTG90ZVR3b3dheSwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0ID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICRodHRwLnB1dChjb250YW50U21zdHdvd2F5LnVybFBldGljaW9uLmVkaXRMb3RlVHdvd2F5LCBkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB0aGlzLmdldGNvbnRhY3RsaXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgJGh0dHAuZ2V0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uZ2V0Y29udGFjdGxpc3QpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0c2VnbWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAkaHR0cC5nZXQoY29udGFudFNtc3R3b3dheS51cmxQZXRpY2lvbi5nZXRzZWdtZW50cylcclxuICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVjc3YgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHt9O1xyXG4gICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0ge307XHJcbiAgICAgICAgICAgICAgY29uZmlnLnRyYW5zZm9ybVJlcXVlc3QgPSBhbmd1bGFyLmlkZW50aXR5O1xyXG4gICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEoZGF0YVtrZXldIGluc3RhbmNlb2YgRmlsZSkpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhW2tleV0gPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZChrZXksIEpTT04uc3RyaW5naWZ5KGRhdGFba2V5XSkpO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZChrZXksIGRhdGFba2V5XSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCBkYXRhW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAkaHR0cC5wb3N0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uY3JlYXRlQ3N2VHdvd2F5LCBmb3JtRGF0YSwgY29uZmlnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmNvdW50Q29udGFjdCA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgJGh0dHAucG9zdChjb250YW50U21zdHdvd2F5LnVybFBldGljaW9uLmNvdW50Q29udGFjdCwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZnVsbHNtc3RlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgJGh0dHAuZ2V0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24ubGlzdFNtc1RlbXBsYXRlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNhdmVzbXN0d293YXljb250YWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICRodHRwLnBvc3QoY29udGFudFNtc3R3b3dheS51cmxQZXRpY2lvbi5zYXZlU21zdG93d2F5Q29udGFjdCwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZXN0YXR1cyA9IGZ1bmN0aW9uIChpZCwgc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAkaHR0cC5wb3N0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uY2hhbmdlU3RhdHVzVHdvd2F5ICsgaWQsIHtzdGF0dXM6IHN0YXR1c30pXHJcbiAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vRnVuY2lvbiBxdWUgdHJhZSBsb3MgZGF0b3MgYWwgZWRpdGFyIGVuIGVsIGVudmlvIHJhcGlkb1xyXG4gICAgICAgICAgICB0aGlzLmdldERhdGFBbGwgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICRodHRwLnBvc3QoY29udGFudFNtc3R3b3dheS51cmxQZXRpY2lvbi5jaGFuZ2VEYXRhRWRpdEFsbCwgaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5nZXRPbmUgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICRodHRwLnBvc3QoY29udGFudFNtc3R3b3dheS51cmxQZXRpY2lvbi5jaGFuZ2VEYXRhRWRpdEFsbCwgaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVEYXRlID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAkaHR0cC5wb3N0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uZ2V0VmFsaWRhdGlvbkRhdGUsIGlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB0aGlzLmdldEVkaXQgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG5cclxuICAgICAgICAgICAgICAkaHR0cC5wb3N0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uZ2V0SW5mb3JFZGl0LCBpZClcclxuICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jYW5jZWxFZGl0ID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgJGh0dHAucG9zdChjb250YW50U21zdHdvd2F5LnVybFBldGljaW9uLmNhbGNlbEVkaXQsIGlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdGNzdiA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAkaHR0cC5wb3N0KGNvbnRhbnRTbXN0d293YXkudXJsUGV0aWNpb24uZWRpdGNzdiwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0QXZhbGFpYmxlQ291bnRyeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICRodHRwLnBvc3QoY29udGFudFNtc3R3b3dheS51cmxQZXRpY2lvbi5nZXRhdmFsYWlibGVjb3VudHJ5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIF0pXHJcbiAgICAgICAgLmZhY3RvcnkoJ25vdGlmaWNhdGlvblNlcnZpY2UnLCBmdW5jdGlvbiAoY29udGFudFNtc3R3b3dheSkge1xyXG4gICAgICAgICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkge1xyXG4gICAgICAgICAgICBzbGlkZU9uVG9wKG1lc3NhZ2UsIGNvbnRhbnRTbXN0d293YXkubWlsbGlTZWNvbmRzLmZvdXJUaG91c2FuZCwgY29udGFudFNtc3R3b3dheS5zbGlkZU9uVG9wLmNsYXNzU2xpZGVSZW1vdmVDaXJjbGUsIGNvbnRhbnRTbXN0d293YXkuY2xhc3NUb29nbGUuZGFuZ2VyKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgc2xpZGVPblRvcChtZXNzYWdlLCBjb250YW50U21zdHdvd2F5Lm1pbGxpU2Vjb25kcy5mb3VyVGhvdXNhbmQsIGNvbnRhbnRTbXN0d293YXkuc2xpZGVPblRvcC5jbGFzc1NsaWRlT2tDaXJjbGUsIGNvbnRhbnRTbXN0d293YXkuY2xhc3NUb29nbGUuc3VjY2Vzcyk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgIHNsaWRlT25Ub3AobWVzc2FnZSwgY29udGFudFNtc3R3b3dheS5taWxsaVNlY29uZHMuZm91clRob3VzYW5kLCBjb250YW50U21zdHdvd2F5LnNsaWRlT25Ub3AuY2xhc3NTbGlkZUV4Y2xhbWF0aW9uU2lnbiwgY29udGFudFNtc3R3b3dheS5jbGFzc1Rvb2dsZS53YXJuaW5nKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBub3RpY2UobWVzc2FnZSkge1xyXG4gICAgICAgICAgICBzbGlkZU9uVG9wKG1lc3NhZ2UsIGNvbnRhbnRTbXN0d293YXkubWlsbGlTZWNvbmRzLmZvdXJUaG91c2FuZCwgY29udGFudFNtc3R3b3dheS5zbGlkZU9uVG9wLmNsYXNzU2xpZGVFeGNsYW1hdGlvblNpZ24sIGNvbnRhbnRTbXN0d293YXkuY2xhc3NUb29nbGUubm90aWNlKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgc2xpZGVPblRvcChtZXNzYWdlLCBjb250YW50U21zdHdvd2F5Lm1pbGxpU2Vjb25kcy5mb3VyVGhvdXNhbmQsIGNvbnRhbnRTbXN0d293YXkuc2xpZGVPblRvcC5jbGFzc1NsaWRlRXhjbGFtYXRpb25TaWduLCBjb250YW50U21zdHdvd2F5LmNsYXNzVG9vZ2xlLmluZm8pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGVycm9yOiBlcnJvcixcclxuICAgICAgICAgICAgc3VjY2Vzczogc3VjY2VzcyxcclxuICAgICAgICAgICAgd2FybmluZzogd2FybmluZyxcclxuICAgICAgICAgICAgbm90aWNlOiBub3RpY2UsXHJcbiAgICAgICAgICAgIGluZm86IGluZm9cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmFjdG9yeSgnbWlzYycsIGZ1bmN0aW9uICgkcSwgY29udGFudFNtc3R3b3dheSkge1xyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsaWRhdGlvbkdlbmVyYWw6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgdmFyIG5hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgICAgICAgdmFyIGNhdCA9IChkYXRhLmNhdGVnb3J5KSA/IGRhdGEuY2F0ZWdvcnkgOiBkYXRhLmlkU21zQ2F0ZWdvcnk7XHJcbiAgICAgICAgICAgICAgdmFyIGdtdCA9IGRhdGEuZ210O1xyXG4gICAgICAgICAgICAgIHZhciBkdHAgPSBkYXRhLmR0cGlja2VyID0gJCgnI2R0cGlja2VyJykudmFsKCk7XHJcbiAgICAgICAgICAgICAgdmFyIHNlbnROb3cgPSAoZGF0YS5zZW50Tm93KSA/IGRhdGEuc2VudE5vdyA6IGRhdGEuZGF0ZU5vdztcclxuICAgICAgICAgICAgICB2YXIgb3B0aW9uc0F2YW5jZWQgPSAoZGF0YS5vcHRpb25zQXZhbmNlZCkgPyBkYXRhLm9wdGlvbnNBdmFuY2VkIDogZGF0YS5hZHZhbmNlZG9wdGlvbnM7XHJcbiAgICAgICAgICAgICAgdmFyIHNlbmROb3RpZmljYXRpb24gPSAoZGF0YS5zZW5kTm90aWZpY2F0aW9uKSA/IGRhdGEuc2VuZE5vdGlmaWNhdGlvbiA6IGRhdGEubm90aWZpY2F0aW9uO1xyXG4gICAgICAgICAgICAgIHZhciBlbWFpbE5vdGlmaWNhdGlvbiA9IChkYXRhLmVtYWlsTm90aWZpY2F0aW9uKSA/IGRhdGEuZW1haWxOb3RpZmljYXRpb24gOiBkYXRhLmVtYWlsO1xyXG5cclxuICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChuYW1lKSB8fCAhbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGNvbnRhbnRTbXN0d293YXkuZXJyb3IubWVzc2FnZXMubXNnTmFtZVNlbnQpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjYXQpIHx8ICFjYXQpIHtcclxuICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ0NhdGVnb3J5KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaWYgKCFzZW50Tm93IHx8IHNlbnROb3cgIT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoZ210KSB8fCAhZ210KSB7XHJcbiAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ1RpbWV6b25lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGR0cCkgfHwgIWR0cCkge1xyXG4gICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dEYXRlVGltZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChkYXRhLnR5cGVSZXNwb25zZS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGNvbnRhbnRTbXN0d293YXkuZXJyb3IubWVzc2FnZXMubXNnVHlwZVJlc3BvbnNlTm90Q2xpY2tlZCk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhLnR5cGVSZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoKCFkYXRhLnR5cGVSZXNwb25zZVtrZXldLmhvbW9sb2dhdGUgfHwgZGF0YS50eXBlUmVzcG9uc2Vba2V5XS5ob21vbG9nYXRlID09IFwiXCIpIHx8ICghZGF0YS50eXBlUmVzcG9uc2Vba2V5XS5yZXNwb25zZSB8fCBkYXRhLnR5cGVSZXNwb25zZVtrZXldLnJlc3BvbnNlID09IFwiXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGNvbnRhbnRTbXN0d293YXkuZXJyb3IubWVzc2FnZXMubXNnVHlwZVJlc3BvbnNlRW1wdHkpO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEudHlwZVJlc3BvbnNlLmxlbmd0aCA8IGNvbnRhbnRTbXN0d293YXkudmFsdWVzLm1lc3NhZ2VzLm1zZ01pblR5cGVSZXNwb25zZVZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGNvbnRhbnRTbXN0d293YXkuZXJyb3IubWVzc2FnZXMubXNnVHlwZVJlc3BvbnNlTWluTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGVSZXNwb25zZVtrZXldLnJlc3BvbnNlIHx8IGRhdGEudHlwZVJlc3BvbnNlW2tleV0uaG9tb2xvZ2F0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBob21vbG9nYXRlY29udGVudCA9IGRhdGEudHlwZVJlc3BvbnNlW2tleV0uaG9tb2xvZ2F0ZS5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm5CbGFua1NwYWNlcyA9IGNvbnRhbnRTbXN0d293YXkucGF0dGVybnMuYmxhbmtTcGFjZXNSZXNwb25zZUFuZEhvbW9sb2dhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm5BY2NlbnRzID0gY29udGFudFNtc3R3b3dheS5wYXR0ZXJucy5hY2NlbnRzUmVzcG9uc2VBbmRIb21vbG9nYXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXR0ZXJuQWNjZW50cy50ZXN0KGRhdGEudHlwZVJlc3BvbnNlW2tleV0ucmVzcG9uc2UpIHx8IHBhdHRlcm5CbGFua1NwYWNlcy50ZXN0KGhvbW9sb2dhdGVjb250ZW50KSB8fCBwYXR0ZXJuQWNjZW50cy50ZXN0KGhvbW9sb2dhdGVjb250ZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGNvbnRhbnRTbXN0d293YXkuZXJyb3IubWVzc2FnZXMubXNnQmxhbmtTcGFjZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaG9tb2xvZ2F0ZWNvbnRlbnQubGVuZ3RoID4gY29udGFudFNtc3R3b3dheS52YWx1ZXMubWVzc2FnZXMubXNnTWF4SG9tb2xvZ2F0ZUNvbnRlbnRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGNvbnRhbnRTbXN0d293YXkuZXJyb3IubWVzc2FnZXMubXNnVHlwZVJlc3BvbnNlSG9tb2xvZ2F0ZU1pbkxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChvcHRpb25zQXZhbmNlZCA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VuZE5vdGlmaWNhdGlvbiA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmICghZW1haWxOb3RpZmljYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dFbWFpbEVtcHR5KTtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbWFpbE5vdGlmaWNhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbWFpbCA9IGVtYWlsTm90aWZpY2F0aW9uLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZW1haWwubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ0VtYWlsRW1wdHkyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVtYWlsLmxlbmd0aCA+IGNvbnRhbnRTbXN0d293YXkudmFsdWVzLm1lc3NhZ2VzLm1zZ01heEVtYWlsVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ01heEVtYWlsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbWFpbC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHJlID0gY29udGFudFNtc3R3b3dheS5wYXR0ZXJucy52ZXJpZnlDb3JyZWN0RW1haWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICBlbWFpbFtpXSA9IGVtYWlsW2ldLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmICghZW1haWxbaV0ubWF0Y2gocmUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ0ludmFsaWRNYWlsMSArIGVtYWlsW2ldICsgY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dJbnZhbGlkTWFpbDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuZGl2aWRlU2VuZGluZyA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmICghZGF0YS5xdWFudGl0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChjb250YW50U21zdHdvd2F5LmVycm9yLm1lc3NhZ2VzLm1zZ0ludGVydmFsb3MpO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFkYXRhLnNlbmRpbmdUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGNvbnRhbnRTbXN0d293YXkuZXJyb3IubWVzc2FnZXMubXNnU2VudFRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFkYXRhLnRpbWVGb3JtYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoY29udGFudFNtc3R3b3dheS5lcnJvci5tZXNzYWdlcy5tc2dUaW1lRm9ybWF0KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9qcy9hbmd1bGFyL3Ntc3R3b3dheS9zZXJ2aWNlcy5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///3\n");

/***/ })
/******/ ]);